import{F as $I,f as Yy}from"./ffmpeg-utils.B1ncfXmI.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();var jf={exports:{}},Al={},Lf={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zy;function qI(){if(Zy)return qe;Zy=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function T(j){return j===null||typeof j!="object"?null:(j=v&&j[v]||j["@@iterator"],typeof j=="function"?j:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function V(j,Q,ve){this.props=j,this.context=Q,this.refs=D,this.updater=ve||S}V.prototype.isReactComponent={},V.prototype.setState=function(j,Q){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,Q,"setState")},V.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function q(){}q.prototype=V.prototype;function L(j,Q,ve){this.props=j,this.context=Q,this.refs=D,this.updater=ve||S}var U=L.prototype=new q;U.constructor=L,C(U,V.prototype),U.isPureReactComponent=!0;var X=Array.isArray,O=Object.prototype.hasOwnProperty,B={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function I(j,Q,ve){var De,ge={},Fe=null,Le=null;if(Q!=null)for(De in Q.ref!==void 0&&(Le=Q.ref),Q.key!==void 0&&(Fe=""+Q.key),Q)O.call(Q,De)&&!A.hasOwnProperty(De)&&(ge[De]=Q[De]);var fe=arguments.length-2;if(fe===1)ge.children=ve;else if(1<fe){for(var Xe=Array(fe),dt=0;dt<fe;dt++)Xe[dt]=arguments[dt+2];ge.children=Xe}if(j&&j.defaultProps)for(De in fe=j.defaultProps,fe)ge[De]===void 0&&(ge[De]=fe[De]);return{$$typeof:r,type:j,key:Fe,ref:Le,props:ge,_owner:B.current}}function N(j,Q){return{$$typeof:r,type:j.type,key:Q,ref:j.ref,props:j.props,_owner:j._owner}}function P(j){return typeof j=="object"&&j!==null&&j.$$typeof===r}function b(j){var Q={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(ve){return Q[ve]})}var M=/\/+/g;function R(j,Q){return typeof j=="object"&&j!==null&&j.key!=null?b(""+j.key):Q.toString(36)}function ue(j,Q,ve,De,ge){var Fe=typeof j;(Fe==="undefined"||Fe==="boolean")&&(j=null);var Le=!1;if(j===null)Le=!0;else switch(Fe){case"string":case"number":Le=!0;break;case"object":switch(j.$$typeof){case r:case e:Le=!0}}if(Le)return Le=j,ge=ge(Le),j=De===""?"."+R(Le,0):De,X(ge)?(ve="",j!=null&&(ve=j.replace(M,"$&/")+"/"),ue(ge,Q,ve,"",function(dt){return dt})):ge!=null&&(P(ge)&&(ge=N(ge,ve+(!ge.key||Le&&Le.key===ge.key?"":(""+ge.key).replace(M,"$&/")+"/")+j)),Q.push(ge)),1;if(Le=0,De=De===""?".":De+":",X(j))for(var fe=0;fe<j.length;fe++){Fe=j[fe];var Xe=De+R(Fe,fe);Le+=ue(Fe,Q,ve,Xe,ge)}else if(Xe=T(j),typeof Xe=="function")for(j=Xe.call(j),fe=0;!(Fe=j.next()).done;)Fe=Fe.value,Xe=De+R(Fe,fe++),Le+=ue(Fe,Q,ve,Xe,ge);else if(Fe==="object")throw Q=String(j),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return Le}function ye(j,Q,ve){if(j==null)return j;var De=[],ge=0;return ue(j,De,"","",function(Fe){return Q.call(ve,Fe,ge++)}),De}function pe(j){if(j._status===-1){var Q=j._result;Q=Q(),Q.then(function(ve){(j._status===0||j._status===-1)&&(j._status=1,j._result=ve)},function(ve){(j._status===0||j._status===-1)&&(j._status=2,j._result=ve)}),j._status===-1&&(j._status=0,j._result=Q)}if(j._status===1)return j._result.default;throw j._result}var ce={current:null},Z={transition:null},ee={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:Z,ReactCurrentOwner:B};function K(){throw Error("act(...) is not supported in production builds of React.")}return qe.Children={map:ye,forEach:function(j,Q,ve){ye(j,function(){Q.apply(this,arguments)},ve)},count:function(j){var Q=0;return ye(j,function(){Q++}),Q},toArray:function(j){return ye(j,function(Q){return Q})||[]},only:function(j){if(!P(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},qe.Component=V,qe.Fragment=t,qe.Profiler=o,qe.PureComponent=L,qe.StrictMode=n,qe.Suspense=d,qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,qe.act=K,qe.cloneElement=function(j,Q,ve){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var De=C({},j.props),ge=j.key,Fe=j.ref,Le=j._owner;if(Q!=null){if(Q.ref!==void 0&&(Fe=Q.ref,Le=B.current),Q.key!==void 0&&(ge=""+Q.key),j.type&&j.type.defaultProps)var fe=j.type.defaultProps;for(Xe in Q)O.call(Q,Xe)&&!A.hasOwnProperty(Xe)&&(De[Xe]=Q[Xe]===void 0&&fe!==void 0?fe[Xe]:Q[Xe])}var Xe=arguments.length-2;if(Xe===1)De.children=ve;else if(1<Xe){fe=Array(Xe);for(var dt=0;dt<Xe;dt++)fe[dt]=arguments[dt+2];De.children=fe}return{$$typeof:r,type:j.type,key:ge,ref:Fe,props:De,_owner:Le}},qe.createContext=function(j){return j={$$typeof:l,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:a,_context:j},j.Consumer=j},qe.createElement=I,qe.createFactory=function(j){var Q=I.bind(null,j);return Q.type=j,Q},qe.createRef=function(){return{current:null}},qe.forwardRef=function(j){return{$$typeof:u,render:j}},qe.isValidElement=P,qe.lazy=function(j){return{$$typeof:g,_payload:{_status:-1,_result:j},_init:pe}},qe.memo=function(j,Q){return{$$typeof:p,type:j,compare:Q===void 0?null:Q}},qe.startTransition=function(j){var Q=Z.transition;Z.transition={};try{j()}finally{Z.transition=Q}},qe.unstable_act=K,qe.useCallback=function(j,Q){return ce.current.useCallback(j,Q)},qe.useContext=function(j){return ce.current.useContext(j)},qe.useDebugValue=function(){},qe.useDeferredValue=function(j){return ce.current.useDeferredValue(j)},qe.useEffect=function(j,Q){return ce.current.useEffect(j,Q)},qe.useId=function(){return ce.current.useId()},qe.useImperativeHandle=function(j,Q,ve){return ce.current.useImperativeHandle(j,Q,ve)},qe.useInsertionEffect=function(j,Q){return ce.current.useInsertionEffect(j,Q)},qe.useLayoutEffect=function(j,Q){return ce.current.useLayoutEffect(j,Q)},qe.useMemo=function(j,Q){return ce.current.useMemo(j,Q)},qe.useReducer=function(j,Q,ve){return ce.current.useReducer(j,Q,ve)},qe.useRef=function(j){return ce.current.useRef(j)},qe.useState=function(j){return ce.current.useState(j)},qe.useSyncExternalStore=function(j,Q,ve){return ce.current.useSyncExternalStore(j,Q,ve)},qe.useTransition=function(){return ce.current.useTransition()},qe.version="18.3.1",qe}var Jy;function Wp(){return Jy||(Jy=1,Lf.exports=qI()),Lf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev;function WI(){if(ev)return Al;ev=1;var r=Wp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,p){var g,v={},T=null,S=null;p!==void 0&&(T=""+p),d.key!==void 0&&(T=""+d.key),d.ref!==void 0&&(S=d.ref);for(g in d)n.call(d,g)&&!a.hasOwnProperty(g)&&(v[g]=d[g]);if(u&&u.defaultProps)for(g in d=u.defaultProps,d)v[g]===void 0&&(v[g]=d[g]);return{$$typeof:e,type:u,key:T,ref:S,props:v,_owner:o.current}}return Al.Fragment=t,Al.jsx=l,Al.jsxs=l,Al}var tv;function GI(){return tv||(tv=1,jf.exports=WI()),jf.exports}var w=GI(),ne=Wp(),Lu={},Bf={exports:{}},Yn={},zf={exports:{}},Uf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nv;function HI(){return nv||(nv=1,function(r){function e(Z,ee){var K=Z.length;Z.push(ee);e:for(;0<K;){var j=K-1>>>1,Q=Z[j];if(0<o(Q,ee))Z[j]=ee,Z[K]=Q,K=j;else break e}}function t(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var ee=Z[0],K=Z.pop();if(K!==ee){Z[0]=K;e:for(var j=0,Q=Z.length,ve=Q>>>1;j<ve;){var De=2*(j+1)-1,ge=Z[De],Fe=De+1,Le=Z[Fe];if(0>o(ge,K))Fe<Q&&0>o(Le,ge)?(Z[j]=Le,Z[Fe]=K,j=Fe):(Z[j]=ge,Z[De]=K,j=De);else if(Fe<Q&&0>o(Le,K))Z[j]=Le,Z[Fe]=K,j=Fe;else break e}}return ee}function o(Z,ee){var K=Z.sortIndex-ee.sortIndex;return K!==0?K:Z.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();r.unstable_now=function(){return l.now()-u}}var d=[],p=[],g=1,v=null,T=3,S=!1,C=!1,D=!1,V=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Z){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=Z)n(p),ee.sortIndex=ee.expirationTime,e(d,ee);else break;ee=t(p)}}function X(Z){if(D=!1,U(Z),!C)if(t(d)!==null)C=!0,pe(O);else{var ee=t(p);ee!==null&&ce(X,ee.startTime-Z)}}function O(Z,ee){C=!1,D&&(D=!1,q(I),I=-1),S=!0;var K=T;try{for(U(ee),v=t(d);v!==null&&(!(v.expirationTime>ee)||Z&&!b());){var j=v.callback;if(typeof j=="function"){v.callback=null,T=v.priorityLevel;var Q=j(v.expirationTime<=ee);ee=r.unstable_now(),typeof Q=="function"?v.callback=Q:v===t(d)&&n(d),U(ee)}else n(d);v=t(d)}if(v!==null)var ve=!0;else{var De=t(p);De!==null&&ce(X,De.startTime-ee),ve=!1}return ve}finally{v=null,T=K,S=!1}}var B=!1,A=null,I=-1,N=5,P=-1;function b(){return!(r.unstable_now()-P<N)}function M(){if(A!==null){var Z=r.unstable_now();P=Z;var ee=!0;try{ee=A(!0,Z)}finally{ee?R():(B=!1,A=null)}}else B=!1}var R;if(typeof L=="function")R=function(){L(M)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,ye=ue.port2;ue.port1.onmessage=M,R=function(){ye.postMessage(null)}}else R=function(){V(M,0)};function pe(Z){A=Z,B||(B=!0,R())}function ce(Z,ee){I=V(function(){Z(r.unstable_now())},ee)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Z){Z.callback=null},r.unstable_continueExecution=function(){C||S||(C=!0,pe(O))},r.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<Z?Math.floor(1e3/Z):5},r.unstable_getCurrentPriorityLevel=function(){return T},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(Z){switch(T){case 1:case 2:case 3:var ee=3;break;default:ee=T}var K=T;T=ee;try{return Z()}finally{T=K}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Z,ee){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var K=T;T=Z;try{return ee()}finally{T=K}},r.unstable_scheduleCallback=function(Z,ee,K){var j=r.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?j+K:j):K=j,Z){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=K+Q,Z={id:g++,callback:ee,priorityLevel:Z,startTime:K,expirationTime:Q,sortIndex:-1},K>j?(Z.sortIndex=K,e(p,Z),t(d)===null&&Z===t(p)&&(D?(q(I),I=-1):D=!0,ce(X,K-j))):(Z.sortIndex=Q,e(d,Z),C||S||(C=!0,pe(O))),Z},r.unstable_shouldYield=b,r.unstable_wrapCallback=function(Z){var ee=T;return function(){var K=T;T=ee;try{return Z.apply(this,arguments)}finally{T=K}}}}(Uf)),Uf}var rv;function KI(){return rv||(rv=1,zf.exports=HI()),zf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv;function QI(){if(sv)return Yn;sv=1;var r=Wp(),e=KI();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,o={};function a(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(o[s]=i,s=0;s<i.length;s++)n.add(i[s])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},v={};function T(s){return d.call(v,s)?!0:d.call(g,s)?!1:p.test(s)?v[s]=!0:(g[s]=!0,!1)}function S(s,i,c,f){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return f?!1:c!==null?!c.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function C(s,i,c,f){if(i===null||typeof i>"u"||S(s,i,c,f))return!0;if(f)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function D(s,i,c,f,m,_,x){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=f,this.attributeNamespace=m,this.mustUseProperty=c,this.propertyName=s,this.type=i,this.sanitizeURL=_,this.removeEmptyString=x}var V={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){V[s]=new D(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];V[i]=new D(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){V[s]=new D(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){V[s]=new D(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){V[s]=new D(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){V[s]=new D(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){V[s]=new D(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){V[s]=new D(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){V[s]=new D(s,5,!1,s.toLowerCase(),null,!1,!1)});var q=/[\-:]([a-z])/g;function L(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(q,L);V[i]=new D(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(q,L);V[i]=new D(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(q,L);V[i]=new D(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){V[s]=new D(s,1,!1,s.toLowerCase(),null,!1,!1)}),V.xlinkHref=new D("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){V[s]=new D(s,1,!1,s.toLowerCase(),null,!0,!0)});function U(s,i,c,f){var m=V.hasOwnProperty(i)?V[i]:null;(m!==null?m.type!==0:f||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(C(i,c,m,f)&&(c=null),f||m===null?T(i)&&(c===null?s.removeAttribute(i):s.setAttribute(i,""+c)):m.mustUseProperty?s[m.propertyName]=c===null?m.type===3?!1:"":c:(i=m.attributeName,f=m.attributeNamespace,c===null?s.removeAttribute(i):(m=m.type,c=m===3||m===4&&c===!0?"":""+c,f?s.setAttributeNS(f,i,c):s.setAttribute(i,c))))}var X=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),B=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),b=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),ye=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),Z=Symbol.iterator;function ee(s){return s===null||typeof s!="object"?null:(s=Z&&s[Z]||s["@@iterator"],typeof s=="function"?s:null)}var K=Object.assign,j;function Q(s){if(j===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);j=i&&i[1]||""}return`
`+j+s}var ve=!1;function De(s,i){if(!s||ve)return"";ve=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(J){var f=J}Reflect.construct(s,[],i)}else{try{i.call()}catch(J){f=J}s.call(i.prototype)}else{try{throw Error()}catch(J){f=J}s()}}catch(J){if(J&&f&&typeof J.stack=="string"){for(var m=J.stack.split(`
`),_=f.stack.split(`
`),x=m.length-1,F=_.length-1;1<=x&&0<=F&&m[x]!==_[F];)F--;for(;1<=x&&0<=F;x--,F--)if(m[x]!==_[F]){if(x!==1||F!==1)do if(x--,F--,0>F||m[x]!==_[F]){var z=`
`+m[x].replace(" at new "," at ");return s.displayName&&z.includes("<anonymous>")&&(z=z.replace("<anonymous>",s.displayName)),z}while(1<=x&&0<=F);break}}}finally{ve=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?Q(s):""}function ge(s){switch(s.tag){case 5:return Q(s.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return s=De(s.type,!1),s;case 11:return s=De(s.type.render,!1),s;case 1:return s=De(s.type,!0),s;default:return""}}function Fe(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case B:return"Portal";case N:return"Profiler";case I:return"StrictMode";case R:return"Suspense";case ue:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case b:return(s.displayName||"Context")+".Consumer";case P:return(s._context.displayName||"Context")+".Provider";case M:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ye:return i=s.displayName||null,i!==null?i:Fe(s.type)||"Memo";case pe:i=s._payload,s=s._init;try{return Fe(s(i))}catch{}}return null}function Le(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fe(i);case 8:return i===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function fe(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Xe(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function dt(s){var i=Xe(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),f=""+s[i];if(!s.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,_=c.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(x){f=""+x,_.call(this,x)}}),Object.defineProperty(s,i,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(x){f=""+x},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Wt(s){s._valueTracker||(s._valueTracker=dt(s))}function bn(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),f="";return s&&(f=Xe(s)?s.checked?"true":"false":s.value),s=f,s!==c?(i.setValue(s),!0):!1}function _n(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function re(s,i){var c=i.checked;return K({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??s._wrapperState.initialChecked})}function se(s,i){var c=i.defaultValue==null?"":i.defaultValue,f=i.checked!=null?i.checked:i.defaultChecked;c=fe(i.value!=null?i.value:c),s._wrapperState={initialChecked:f,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function we(s,i){i=i.checked,i!=null&&U(s,"checked",i,!1)}function Ie(s,i){we(s,i);var c=fe(i.value),f=i.type;if(c!=null)f==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+c):s.value!==""+c&&(s.value=""+c);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?$e(s,i.type,c):i.hasOwnProperty("defaultValue")&&$e(s,i.type,fe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Be(s,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var f=i.type;if(!(f!=="submit"&&f!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,c||i===s.value||(s.value=i),s.defaultValue=i}c=s.name,c!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,c!==""&&(s.name=c)}function $e(s,i,c){(i!=="number"||_n(s.ownerDocument)!==s)&&(c==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+c&&(s.defaultValue=""+c))}var nt=Array.isArray;function ot(s,i,c,f){if(s=s.options,i){i={};for(var m=0;m<c.length;m++)i["$"+c[m]]=!0;for(c=0;c<s.length;c++)m=i.hasOwnProperty("$"+s[c].value),s[c].selected!==m&&(s[c].selected=m),m&&f&&(s[c].defaultSelected=!0)}else{for(c=""+fe(c),i=null,m=0;m<s.length;m++){if(s[m].value===c){s[m].selected=!0,f&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function Mt(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return K({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Dn(s,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(t(92));if(nt(c)){if(1<c.length)throw Error(t(93));c=c[0]}i=c}i==null&&(i=""),c=i}s._wrapperState={initialValue:fe(c)}}function Gt(s,i){var c=fe(i.value),f=fe(i.defaultValue);c!=null&&(c=""+c,c!==s.value&&(s.value=c),i.defaultValue==null&&s.defaultValue!==c&&(s.defaultValue=c)),f!=null&&(s.defaultValue=""+f)}function Ht(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Ye(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ft(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Ye(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Vn,ps=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,f,m){MSApp.execUnsafeLocalFunction(function(){return s(i,c,f,m)})}:s}(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Vn=Vn||document.createElement("div"),Vn.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Vn.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function Kt(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var it={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},en=["Webkit","ms","Moz","O"];Object.keys(it).forEach(function(s){en.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),it[i]=it[s]})});function wn(s,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||it.hasOwnProperty(s)&&it[s]?(""+i).trim():i+"px"}function Un(s,i){s=s.style;for(var c in i)if(i.hasOwnProperty(c)){var f=c.indexOf("--")===0,m=wn(c,i[c],f);c==="float"&&(c="cssFloat"),f?s.setProperty(c,m):s[c]=m}}var Hr=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ms(s,i){if(i){if(Hr[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Kr(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fr=null;function pr(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Rr=null,hn=null,$n=null;function Te(s){if(s=dl(s)){if(typeof Rr!="function")throw Error(t(280));var i=s.stateNode;i&&(i=eu(i),Rr(s.stateNode,s.type,i))}}function Ne(s){hn?$n?$n.push(s):$n=[s]:hn=s}function Ue(){if(hn){var s=hn,i=$n;if($n=hn=null,Te(s),i)for(s=0;s<i.length;s++)Te(i[s])}}function Ze(s,i){return s(i)}function pt(){}var ct=!1;function tn(s,i,c){if(ct)return s(i,c);ct=!0;try{return Ze(s,i,c)}finally{ct=!1,(hn!==null||$n!==null)&&(pt(),Ue())}}function ut(s,i){var c=s.stateNode;if(c===null)return null;var f=eu(c);if(f===null)return null;c=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(t(231,i,typeof c));return c}var kr=!1;if(u)try{var Qt={};Object.defineProperty(Qt,"passive",{get:function(){kr=!0}}),window.addEventListener("test",Qt,Qt),window.removeEventListener("test",Qt,Qt)}catch{kr=!1}function At(s,i,c,f,m,_,x,F,z){var J=Array.prototype.slice.call(arguments,3);try{i.apply(c,J)}catch(le){this.onError(le)}}var nn=!1,mr=null,En=!1,We=null,Tt={onError:function(s){nn=!0,mr=s}};function zt(s,i,c,f,m,_,x,F,z){nn=!1,mr=null,At.apply(Tt,arguments)}function Qr(s,i,c,f,m,_,x,F,z){if(zt.apply(this,arguments),nn){if(nn){var J=mr;nn=!1,mr=null}else throw Error(t(198));En||(En=!0,We=J)}}function Mn(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function gs(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function dn(s){if(Mn(s)!==s)throw Error(t(188))}function Cc(s){var i=s.alternate;if(!i){if(i=Mn(s),i===null)throw Error(t(188));return i!==s?null:s}for(var c=s,f=i;;){var m=c.return;if(m===null)break;var _=m.alternate;if(_===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===_.child){for(_=m.child;_;){if(_===c)return dn(m),s;if(_===f)return dn(m),i;_=_.sibling}throw Error(t(188))}if(c.return!==f.return)c=m,f=_;else{for(var x=!1,F=m.child;F;){if(F===c){x=!0,c=m,f=_;break}if(F===f){x=!0,f=m,c=_;break}F=F.sibling}if(!x){for(F=_.child;F;){if(F===c){x=!0,c=_,f=m;break}if(F===f){x=!0,f=_,c=m;break}F=F.sibling}if(!x)throw Error(t(189))}}if(c.alternate!==f)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?s:i}function Ha(s){return s=Cc(s),s!==null?Ci(s):null}function Ci(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=Ci(s);if(i!==null)return i;s=s.sibling}return null}var Ai=e.unstable_scheduleCallback,Ka=e.unstable_cancelCallback,Ac=e.unstable_shouldYield,dd=e.unstable_requestPaint,yt=e.unstable_now,Nc=e.unstable_getCurrentPriorityLevel,Do=e.unstable_ImmediatePriority,zs=e.unstable_UserBlockingPriority,gr=e.unstable_NormalPriority,Qa=e.unstable_LowPriority,Rc=e.unstable_IdlePriority,Vo=null,tr=null;function kc(s){if(tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(Vo,s,void 0,(s.current.flags&128)===128)}catch{}}var On=Math.clz32?Math.clz32:bc,Xa=Math.log,Pc=Math.LN2;function bc(s){return s>>>=0,s===0?32:31-(Xa(s)/Pc|0)|0}var Ni=64,Ri=4194304;function Us(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Mo(s,i){var c=s.pendingLanes;if(c===0)return 0;var f=0,m=s.suspendedLanes,_=s.pingedLanes,x=c&268435455;if(x!==0){var F=x&~m;F!==0?f=Us(F):(_&=x,_!==0&&(f=Us(_)))}else x=c&~m,x!==0?f=Us(x):_!==0&&(f=Us(_));if(f===0)return 0;if(i!==0&&i!==f&&(i&m)===0&&(m=f&-f,_=i&-i,m>=_||m===16&&(_&4194240)!==0))return i;if((f&4)!==0&&(f|=c&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=f;0<i;)c=31-On(i),m=1<<c,f|=s[c],i&=~m;return f}function fd(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ys(s,i){for(var c=s.suspendedLanes,f=s.pingedLanes,m=s.expirationTimes,_=s.pendingLanes;0<_;){var x=31-On(_),F=1<<x,z=m[x];z===-1?((F&c)===0||(F&f)!==0)&&(m[x]=fd(F,i)):z<=i&&(s.expiredLanes|=F),_&=~F}}function nr(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Oo(){var s=Ni;return Ni<<=1,(Ni&4194240)===0&&(Ni=64),s}function $s(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function qs(s,i,c){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-On(i),s[i]=c}function mt(s,i){var c=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<c;){var m=31-On(c),_=1<<m;i[m]=0,f[m]=-1,s[m]=-1,c&=~_}}function Ws(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var f=31-On(c),m=1<<f;m&i|s[f]&i&&(s[f]|=i),c&=~m}}var He=0;function Gs(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Dc,ki,Vc,Mc,Oc,Ya=!1,Xr=[],fn=null,Pr=null,br=null,Hs=new Map,yr=new Map,Yr=[],pd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fc(s,i){switch(s){case"focusin":case"focusout":fn=null;break;case"dragenter":case"dragleave":Pr=null;break;case"mouseover":case"mouseout":br=null;break;case"pointerover":case"pointerout":Hs.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":yr.delete(i.pointerId)}}function qn(s,i,c,f,m,_){return s===null||s.nativeEvent!==_?(s={blockedOn:i,domEventName:c,eventSystemFlags:f,nativeEvent:_,targetContainers:[m]},i!==null&&(i=dl(i),i!==null&&ki(i)),s):(s.eventSystemFlags|=f,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function md(s,i,c,f,m){switch(i){case"focusin":return fn=qn(fn,s,i,c,f,m),!0;case"dragenter":return Pr=qn(Pr,s,i,c,f,m),!0;case"mouseover":return br=qn(br,s,i,c,f,m),!0;case"pointerover":var _=m.pointerId;return Hs.set(_,qn(Hs.get(_)||null,s,i,c,f,m)),!0;case"gotpointercapture":return _=m.pointerId,yr.set(_,qn(yr.get(_)||null,s,i,c,f,m)),!0}return!1}function jc(s){var i=zo(s.target);if(i!==null){var c=Mn(i);if(c!==null){if(i=c.tag,i===13){if(i=gs(c),i!==null){s.blockedOn=i,Oc(s.priority,function(){Vc(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function vs(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=Pi(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);fr=f,c.target.dispatchEvent(f),fr=null}else return i=dl(c),i!==null&&ki(i),s.blockedOn=c,!1;i.shift()}return!0}function Fo(s,i,c){vs(s)&&c.delete(i)}function Lc(){Ya=!1,fn!==null&&vs(fn)&&(fn=null),Pr!==null&&vs(Pr)&&(Pr=null),br!==null&&vs(br)&&(br=null),Hs.forEach(Fo),yr.forEach(Fo)}function Dr(s,i){s.blockedOn===i&&(s.blockedOn=null,Ya||(Ya=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Lc)))}function Vr(s){function i(m){return Dr(m,s)}if(0<Xr.length){Dr(Xr[0],s);for(var c=1;c<Xr.length;c++){var f=Xr[c];f.blockedOn===s&&(f.blockedOn=null)}}for(fn!==null&&Dr(fn,s),Pr!==null&&Dr(Pr,s),br!==null&&Dr(br,s),Hs.forEach(i),yr.forEach(i),c=0;c<Yr.length;c++)f=Yr[c],f.blockedOn===s&&(f.blockedOn=null);for(;0<Yr.length&&(c=Yr[0],c.blockedOn===null);)jc(c),c.blockedOn===null&&Yr.shift()}var _s=X.ReactCurrentBatchConfig,Ks=!0;function It(s,i,c,f){var m=He,_=_s.transition;_s.transition=null;try{He=1,Za(s,i,c,f)}finally{He=m,_s.transition=_}}function gd(s,i,c,f){var m=He,_=_s.transition;_s.transition=null;try{He=4,Za(s,i,c,f)}finally{He=m,_s.transition=_}}function Za(s,i,c,f){if(Ks){var m=Pi(s,i,c,f);if(m===null)Ad(s,i,f,jo,c),Fc(s,f);else if(md(m,s,i,c,f))f.stopPropagation();else if(Fc(s,f),i&4&&-1<pd.indexOf(s)){for(;m!==null;){var _=dl(m);if(_!==null&&Dc(_),_=Pi(s,i,c,f),_===null&&Ad(s,i,f,jo,c),_===m)break;m=_}m!==null&&f.stopPropagation()}else Ad(s,i,f,null,c)}}var jo=null;function Pi(s,i,c,f){if(jo=null,s=pr(f),s=zo(s),s!==null)if(i=Mn(s),i===null)s=null;else if(c=i.tag,c===13){if(s=gs(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return jo=s,null}function Ja(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Nc()){case Do:return 1;case zs:return 4;case gr:case Qa:return 16;case Rc:return 536870912;default:return 16}default:return 16}}var rr=null,bi=null,Wn=null;function el(){if(Wn)return Wn;var s,i=bi,c=i.length,f,m="value"in rr?rr.value:rr.textContent,_=m.length;for(s=0;s<c&&i[s]===m[s];s++);var x=c-s;for(f=1;f<=x&&i[c-f]===m[_-f];f++);return Wn=m.slice(s,1<f?1-f:void 0)}function Di(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Zr(){return!0}function tl(){return!1}function pn(s){function i(c,f,m,_,x){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=_,this.target=x,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(c=s[F],this[F]=c?c(_):_[F]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Zr:tl,this.isPropagationStopped=tl,this}return K(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Zr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Zr)},persist:function(){},isPersistent:Zr}),i}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vi=pn(Mr),Jr=K({},Mr,{view:0,detail:0}),yd=pn(Jr),Mi,ws,Qs,Lo=K({},Jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:es,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Qs&&(Qs&&s.type==="mousemove"?(Mi=s.screenX-Qs.screenX,ws=s.screenY-Qs.screenY):ws=Mi=0,Qs=s),Mi)},movementY:function(s){return"movementY"in s?s.movementY:ws}}),Oi=pn(Lo),nl=K({},Lo,{dataTransfer:0}),Bc=pn(nl),Fi=K({},Jr,{relatedTarget:0}),ji=pn(Fi),zc=K({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),Es=pn(zc),Uc=K({},Mr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),$c=pn(Uc),qc=K({},Mr,{data:0}),rl=pn(qc),Li={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gc(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Wc[s])?!!i[s]:!1}function es(){return Gc}var h=K({},Jr,{key:function(s){if(s.key){var i=Li[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Di(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Fn[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:es,charCode:function(s){return s.type==="keypress"?Di(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Di(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),y=pn(h),E=K({},Lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),k=pn(E),G=K({},Jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:es}),te=pn(G),me=K({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),at=pn(me),Xt=K({},Lo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Je=pn(Xt),rn=[9,13,27,32],Ut=u&&"CompositionEvent"in window,vr=null;u&&"documentMode"in document&&(vr=document.documentMode);var sr=u&&"TextEvent"in window&&!vr,Bo=u&&(!Ut||vr&&8<vr&&11>=vr),Bi=" ",Wm=!1;function Gm(s,i){switch(s){case"keyup":return rn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hm(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var zi=!1;function BT(s,i){switch(s){case"compositionend":return Hm(i);case"keypress":return i.which!==32?null:(Wm=!0,Bi);case"textInput":return s=i.data,s===Bi&&Wm?null:s;default:return null}}function zT(s,i){if(zi)return s==="compositionend"||!Ut&&Gm(s,i)?(s=el(),Wn=bi=rr=null,zi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Bo&&i.locale!=="ko"?null:i.data;default:return null}}var UT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Km(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!UT[s.type]:i==="textarea"}function Qm(s,i,c,f){Ne(f),i=Yc(i,"onChange"),0<i.length&&(c=new Vi("onChange","change",null,c,f),s.push({event:c,listeners:i}))}var sl=null,ol=null;function $T(s){fg(s,0)}function Hc(s){var i=Gi(s);if(bn(i))return s}function qT(s,i){if(s==="change")return i}var Xm=!1;if(u){var vd;if(u){var _d="oninput"in document;if(!_d){var Ym=document.createElement("div");Ym.setAttribute("oninput","return;"),_d=typeof Ym.oninput=="function"}vd=_d}else vd=!1;Xm=vd&&(!document.documentMode||9<document.documentMode)}function Zm(){sl&&(sl.detachEvent("onpropertychange",Jm),ol=sl=null)}function Jm(s){if(s.propertyName==="value"&&Hc(ol)){var i=[];Qm(i,ol,s,pr(s)),tn($T,i)}}function WT(s,i,c){s==="focusin"?(Zm(),sl=i,ol=c,sl.attachEvent("onpropertychange",Jm)):s==="focusout"&&Zm()}function GT(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Hc(ol)}function HT(s,i){if(s==="click")return Hc(i)}function KT(s,i){if(s==="input"||s==="change")return Hc(i)}function QT(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Or=typeof Object.is=="function"?Object.is:QT;function il(s,i){if(Or(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),f=Object.keys(i);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!d.call(i,m)||!Or(s[m],i[m]))return!1}return!0}function eg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function tg(s,i){var c=eg(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=i&&f>=i)return{node:c,offset:i-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=eg(c)}}function ng(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?ng(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function rg(){for(var s=window,i=_n();i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=_n(s.document)}return i}function wd(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function XT(s){var i=rg(),c=s.focusedElem,f=s.selectionRange;if(i!==c&&c&&c.ownerDocument&&ng(c.ownerDocument.documentElement,c)){if(f!==null&&wd(c)){if(i=f.start,s=f.end,s===void 0&&(s=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(s,c.value.length);else if(s=(i=c.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var m=c.textContent.length,_=Math.min(f.start,m);f=f.end===void 0?_:Math.min(f.end,m),!s.extend&&_>f&&(m=f,f=_,_=m),m=tg(c,_);var x=tg(c,f);m&&x&&(s.rangeCount!==1||s.anchorNode!==m.node||s.anchorOffset!==m.offset||s.focusNode!==x.node||s.focusOffset!==x.offset)&&(i=i.createRange(),i.setStart(m.node,m.offset),s.removeAllRanges(),_>f?(s.addRange(i),s.extend(x.node,x.offset)):(i.setEnd(x.node,x.offset),s.addRange(i)))}}for(i=[],s=c;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)s=i[c],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var YT=u&&"documentMode"in document&&11>=document.documentMode,Ui=null,Ed=null,al=null,Td=!1;function sg(s,i,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Td||Ui==null||Ui!==_n(f)||(f=Ui,"selectionStart"in f&&wd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),al&&il(al,f)||(al=f,f=Yc(Ed,"onSelect"),0<f.length&&(i=new Vi("onSelect","select",null,i,c),s.push({event:i,listeners:f}),i.target=Ui)))}function Kc(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var $i={animationend:Kc("Animation","AnimationEnd"),animationiteration:Kc("Animation","AnimationIteration"),animationstart:Kc("Animation","AnimationStart"),transitionend:Kc("Transition","TransitionEnd")},Id={},og={};u&&(og=document.createElement("div").style,"AnimationEvent"in window||(delete $i.animationend.animation,delete $i.animationiteration.animation,delete $i.animationstart.animation),"TransitionEvent"in window||delete $i.transitionend.transition);function Qc(s){if(Id[s])return Id[s];if(!$i[s])return s;var i=$i[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in og)return Id[s]=i[c];return s}var ig=Qc("animationend"),ag=Qc("animationiteration"),lg=Qc("animationstart"),cg=Qc("transitionend"),ug=new Map,hg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xs(s,i){ug.set(s,i),a(i,[s])}for(var Sd=0;Sd<hg.length;Sd++){var xd=hg[Sd],ZT=xd.toLowerCase(),JT=xd[0].toUpperCase()+xd.slice(1);Xs(ZT,"on"+JT)}Xs(ig,"onAnimationEnd"),Xs(ag,"onAnimationIteration"),Xs(lg,"onAnimationStart"),Xs("dblclick","onDoubleClick"),Xs("focusin","onFocus"),Xs("focusout","onBlur"),Xs(cg,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eI=new Set("cancel close invalid load scroll toggle".split(" ").concat(ll));function dg(s,i,c){var f=s.type||"unknown-event";s.currentTarget=c,Qr(f,i,void 0,s),s.currentTarget=null}function fg(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],m=f.event;f=f.listeners;e:{var _=void 0;if(i)for(var x=f.length-1;0<=x;x--){var F=f[x],z=F.instance,J=F.currentTarget;if(F=F.listener,z!==_&&m.isPropagationStopped())break e;dg(m,F,J),_=z}else for(x=0;x<f.length;x++){if(F=f[x],z=F.instance,J=F.currentTarget,F=F.listener,z!==_&&m.isPropagationStopped())break e;dg(m,F,J),_=z}}}if(En)throw s=We,En=!1,We=null,s}function _t(s,i){var c=i[Dd];c===void 0&&(c=i[Dd]=new Set);var f=s+"__bubble";c.has(f)||(pg(i,s,2,!1),c.add(f))}function Cd(s,i,c){var f=0;i&&(f|=4),pg(c,s,f,i)}var Xc="_reactListening"+Math.random().toString(36).slice(2);function cl(s){if(!s[Xc]){s[Xc]=!0,n.forEach(function(c){c!=="selectionchange"&&(eI.has(c)||Cd(c,!1,s),Cd(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Xc]||(i[Xc]=!0,Cd("selectionchange",!1,i))}}function pg(s,i,c,f){switch(Ja(i)){case 1:var m=It;break;case 4:m=gd;break;default:m=Za}c=m.bind(null,i,c,s),m=void 0,!kr||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),f?m!==void 0?s.addEventListener(i,c,{capture:!0,passive:m}):s.addEventListener(i,c,!0):m!==void 0?s.addEventListener(i,c,{passive:m}):s.addEventListener(i,c,!1)}function Ad(s,i,c,f,m){var _=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var x=f.tag;if(x===3||x===4){var F=f.stateNode.containerInfo;if(F===m||F.nodeType===8&&F.parentNode===m)break;if(x===4)for(x=f.return;x!==null;){var z=x.tag;if((z===3||z===4)&&(z=x.stateNode.containerInfo,z===m||z.nodeType===8&&z.parentNode===m))return;x=x.return}for(;F!==null;){if(x=zo(F),x===null)return;if(z=x.tag,z===5||z===6){f=_=x;continue e}F=F.parentNode}}f=f.return}tn(function(){var J=_,le=pr(c),he=[];e:{var ie=ug.get(s);if(ie!==void 0){var Ee=Vi,xe=s;switch(s){case"keypress":if(Di(c)===0)break e;case"keydown":case"keyup":Ee=y;break;case"focusin":xe="focus",Ee=ji;break;case"focusout":xe="blur",Ee=ji;break;case"beforeblur":case"afterblur":Ee=ji;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Oi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=Bc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=te;break;case ig:case ag:case lg:Ee=Es;break;case cg:Ee=at;break;case"scroll":Ee=yd;break;case"wheel":Ee=Je;break;case"copy":case"cut":case"paste":Ee=$c;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=k}var Re=(i&4)!==0,Ot=!Re&&s==="scroll",H=Re?ie!==null?ie+"Capture":null:ie;Re=[];for(var $=J,Y;$!==null;){Y=$;var de=Y.stateNode;if(Y.tag===5&&de!==null&&(Y=de,H!==null&&(de=ut($,H),de!=null&&Re.push(ul($,de,Y)))),Ot)break;$=$.return}0<Re.length&&(ie=new Ee(ie,xe,null,c,le),he.push({event:ie,listeners:Re}))}}if((i&7)===0){e:{if(ie=s==="mouseover"||s==="pointerover",Ee=s==="mouseout"||s==="pointerout",ie&&c!==fr&&(xe=c.relatedTarget||c.fromElement)&&(zo(xe)||xe[Ts]))break e;if((Ee||ie)&&(ie=le.window===le?le:(ie=le.ownerDocument)?ie.defaultView||ie.parentWindow:window,Ee?(xe=c.relatedTarget||c.toElement,Ee=J,xe=xe?zo(xe):null,xe!==null&&(Ot=Mn(xe),xe!==Ot||xe.tag!==5&&xe.tag!==6)&&(xe=null)):(Ee=null,xe=J),Ee!==xe)){if(Re=Oi,de="onMouseLeave",H="onMouseEnter",$="mouse",(s==="pointerout"||s==="pointerover")&&(Re=k,de="onPointerLeave",H="onPointerEnter",$="pointer"),Ot=Ee==null?ie:Gi(Ee),Y=xe==null?ie:Gi(xe),ie=new Re(de,$+"leave",Ee,c,le),ie.target=Ot,ie.relatedTarget=Y,de=null,zo(le)===J&&(Re=new Re(H,$+"enter",xe,c,le),Re.target=Y,Re.relatedTarget=Ot,de=Re),Ot=de,Ee&&xe)t:{for(Re=Ee,H=xe,$=0,Y=Re;Y;Y=qi(Y))$++;for(Y=0,de=H;de;de=qi(de))Y++;for(;0<$-Y;)Re=qi(Re),$--;for(;0<Y-$;)H=qi(H),Y--;for(;$--;){if(Re===H||H!==null&&Re===H.alternate)break t;Re=qi(Re),H=qi(H)}Re=null}else Re=null;Ee!==null&&mg(he,ie,Ee,Re,!1),xe!==null&&Ot!==null&&mg(he,Ot,xe,Re,!0)}}e:{if(ie=J?Gi(J):window,Ee=ie.nodeName&&ie.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&ie.type==="file")var Pe=qT;else if(Km(ie))if(Xm)Pe=KT;else{Pe=GT;var Me=WT}else(Ee=ie.nodeName)&&Ee.toLowerCase()==="input"&&(ie.type==="checkbox"||ie.type==="radio")&&(Pe=HT);if(Pe&&(Pe=Pe(s,J))){Qm(he,Pe,c,le);break e}Me&&Me(s,ie,J),s==="focusout"&&(Me=ie._wrapperState)&&Me.controlled&&ie.type==="number"&&$e(ie,"number",ie.value)}switch(Me=J?Gi(J):window,s){case"focusin":(Km(Me)||Me.contentEditable==="true")&&(Ui=Me,Ed=J,al=null);break;case"focusout":al=Ed=Ui=null;break;case"mousedown":Td=!0;break;case"contextmenu":case"mouseup":case"dragend":Td=!1,sg(he,c,le);break;case"selectionchange":if(YT)break;case"keydown":case"keyup":sg(he,c,le)}var Oe;if(Ut)e:{switch(s){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else zi?Gm(s,c)&&(je="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(je="onCompositionStart");je&&(Bo&&c.locale!=="ko"&&(zi||je!=="onCompositionStart"?je==="onCompositionEnd"&&zi&&(Oe=el()):(rr=le,bi="value"in rr?rr.value:rr.textContent,zi=!0)),Me=Yc(J,je),0<Me.length&&(je=new rl(je,s,null,c,le),he.push({event:je,listeners:Me}),Oe?je.data=Oe:(Oe=Hm(c),Oe!==null&&(je.data=Oe)))),(Oe=sr?BT(s,c):zT(s,c))&&(J=Yc(J,"onBeforeInput"),0<J.length&&(le=new rl("onBeforeInput","beforeinput",null,c,le),he.push({event:le,listeners:J}),le.data=Oe))}fg(he,i)})}function ul(s,i,c){return{instance:s,listener:i,currentTarget:c}}function Yc(s,i){for(var c=i+"Capture",f=[];s!==null;){var m=s,_=m.stateNode;m.tag===5&&_!==null&&(m=_,_=ut(s,c),_!=null&&f.unshift(ul(s,_,m)),_=ut(s,i),_!=null&&f.push(ul(s,_,m))),s=s.return}return f}function qi(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function mg(s,i,c,f,m){for(var _=i._reactName,x=[];c!==null&&c!==f;){var F=c,z=F.alternate,J=F.stateNode;if(z!==null&&z===f)break;F.tag===5&&J!==null&&(F=J,m?(z=ut(c,_),z!=null&&x.unshift(ul(c,z,F))):m||(z=ut(c,_),z!=null&&x.push(ul(c,z,F)))),c=c.return}x.length!==0&&s.push({event:i,listeners:x})}var tI=/\r\n?/g,nI=/\u0000|\uFFFD/g;function gg(s){return(typeof s=="string"?s:""+s).replace(tI,`
`).replace(nI,"")}function Zc(s,i,c){if(i=gg(i),gg(s)!==i&&c)throw Error(t(425))}function Jc(){}var Nd=null,Rd=null;function kd(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Pd=typeof setTimeout=="function"?setTimeout:void 0,rI=typeof clearTimeout=="function"?clearTimeout:void 0,yg=typeof Promise=="function"?Promise:void 0,sI=typeof queueMicrotask=="function"?queueMicrotask:typeof yg<"u"?function(s){return yg.resolve(null).then(s).catch(oI)}:Pd;function oI(s){setTimeout(function(){throw s})}function bd(s,i){var c=i,f=0;do{var m=c.nextSibling;if(s.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(f===0){s.removeChild(m),Vr(i);return}f--}else c!=="$"&&c!=="$?"&&c!=="$!"||f++;c=m}while(c);Vr(i)}function Ys(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function vg(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return s;i--}else c==="/$"&&i++}s=s.previousSibling}return null}var Wi=Math.random().toString(36).slice(2),ts="__reactFiber$"+Wi,hl="__reactProps$"+Wi,Ts="__reactContainer$"+Wi,Dd="__reactEvents$"+Wi,iI="__reactListeners$"+Wi,aI="__reactHandles$"+Wi;function zo(s){var i=s[ts];if(i)return i;for(var c=s.parentNode;c;){if(i=c[Ts]||c[ts]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=vg(s);s!==null;){if(c=s[ts])return c;s=vg(s)}return i}s=c,c=s.parentNode}return null}function dl(s){return s=s[ts]||s[Ts],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Gi(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function eu(s){return s[hl]||null}var Vd=[],Hi=-1;function Zs(s){return{current:s}}function wt(s){0>Hi||(s.current=Vd[Hi],Vd[Hi]=null,Hi--)}function vt(s,i){Hi++,Vd[Hi]=s.current,s.current=i}var Js={},Tn=Zs(Js),Gn=Zs(!1),Uo=Js;function Ki(s,i){var c=s.type.contextTypes;if(!c)return Js;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===i)return f.__reactInternalMemoizedMaskedChildContext;var m={},_;for(_ in c)m[_]=i[_];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=m),m}function Hn(s){return s=s.childContextTypes,s!=null}function tu(){wt(Gn),wt(Tn)}function _g(s,i,c){if(Tn.current!==Js)throw Error(t(168));vt(Tn,i),vt(Gn,c)}function wg(s,i,c){var f=s.stateNode;if(i=i.childContextTypes,typeof f.getChildContext!="function")return c;f=f.getChildContext();for(var m in f)if(!(m in i))throw Error(t(108,Le(s)||"Unknown",m));return K({},c,f)}function nu(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Js,Uo=Tn.current,vt(Tn,s),vt(Gn,Gn.current),!0}function Eg(s,i,c){var f=s.stateNode;if(!f)throw Error(t(169));c?(s=wg(s,i,Uo),f.__reactInternalMemoizedMergedChildContext=s,wt(Gn),wt(Tn),vt(Tn,s)):wt(Gn),vt(Gn,c)}var Is=null,ru=!1,Md=!1;function Tg(s){Is===null?Is=[s]:Is.push(s)}function lI(s){ru=!0,Tg(s)}function eo(){if(!Md&&Is!==null){Md=!0;var s=0,i=He;try{var c=Is;for(He=1;s<c.length;s++){var f=c[s];do f=f(!0);while(f!==null)}Is=null,ru=!1}catch(m){throw Is!==null&&(Is=Is.slice(s+1)),Ai(Do,eo),m}finally{He=i,Md=!1}}return null}var Qi=[],Xi=0,su=null,ou=0,_r=[],wr=0,$o=null,Ss=1,xs="";function qo(s,i){Qi[Xi++]=ou,Qi[Xi++]=su,su=s,ou=i}function Ig(s,i,c){_r[wr++]=Ss,_r[wr++]=xs,_r[wr++]=$o,$o=s;var f=Ss;s=xs;var m=32-On(f)-1;f&=~(1<<m),c+=1;var _=32-On(i)+m;if(30<_){var x=m-m%5;_=(f&(1<<x)-1).toString(32),f>>=x,m-=x,Ss=1<<32-On(i)+m|c<<m|f,xs=_+s}else Ss=1<<_|c<<m|f,xs=s}function Od(s){s.return!==null&&(qo(s,1),Ig(s,1,0))}function Fd(s){for(;s===su;)su=Qi[--Xi],Qi[Xi]=null,ou=Qi[--Xi],Qi[Xi]=null;for(;s===$o;)$o=_r[--wr],_r[wr]=null,xs=_r[--wr],_r[wr]=null,Ss=_r[--wr],_r[wr]=null}var or=null,ir=null,St=!1,Fr=null;function Sg(s,i){var c=Sr(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=s,i=s.deletions,i===null?(s.deletions=[c],s.flags|=16):i.push(c)}function xg(s,i){switch(s.tag){case 5:var c=s.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,or=s,ir=Ys(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,or=s,ir=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=$o!==null?{id:Ss,overflow:xs}:null,s.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=Sr(18,null,null,0),c.stateNode=i,c.return=s,s.child=c,or=s,ir=null,!0):!1;default:return!1}}function jd(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Ld(s){if(St){var i=ir;if(i){var c=i;if(!xg(s,i)){if(jd(s))throw Error(t(418));i=Ys(c.nextSibling);var f=or;i&&xg(s,i)?Sg(f,c):(s.flags=s.flags&-4097|2,St=!1,or=s)}}else{if(jd(s))throw Error(t(418));s.flags=s.flags&-4097|2,St=!1,or=s}}}function Cg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;or=s}function iu(s){if(s!==or)return!1;if(!St)return Cg(s),St=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!kd(s.type,s.memoizedProps)),i&&(i=ir)){if(jd(s))throw Ag(),Error(t(418));for(;i;)Sg(s,i),i=Ys(i.nextSibling)}if(Cg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"){if(i===0){ir=Ys(s.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}s=s.nextSibling}ir=null}}else ir=or?Ys(s.stateNode.nextSibling):null;return!0}function Ag(){for(var s=ir;s;)s=Ys(s.nextSibling)}function Yi(){ir=or=null,St=!1}function Bd(s){Fr===null?Fr=[s]:Fr.push(s)}var cI=X.ReactCurrentBatchConfig;function fl(s,i,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var f=c.stateNode}if(!f)throw Error(t(147,s));var m=f,_=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===_?i.ref:(i=function(x){var F=m.refs;x===null?delete F[_]:F[_]=x},i._stringRef=_,i)}if(typeof s!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,s))}return s}function au(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Ng(s){var i=s._init;return i(s._payload)}function Rg(s){function i(H,$){if(s){var Y=H.deletions;Y===null?(H.deletions=[$],H.flags|=16):Y.push($)}}function c(H,$){if(!s)return null;for(;$!==null;)i(H,$),$=$.sibling;return null}function f(H,$){for(H=new Map;$!==null;)$.key!==null?H.set($.key,$):H.set($.index,$),$=$.sibling;return H}function m(H,$){return H=lo(H,$),H.index=0,H.sibling=null,H}function _(H,$,Y){return H.index=Y,s?(Y=H.alternate,Y!==null?(Y=Y.index,Y<$?(H.flags|=2,$):Y):(H.flags|=2,$)):(H.flags|=1048576,$)}function x(H){return s&&H.alternate===null&&(H.flags|=2),H}function F(H,$,Y,de){return $===null||$.tag!==6?($=bf(Y,H.mode,de),$.return=H,$):($=m($,Y),$.return=H,$)}function z(H,$,Y,de){var Pe=Y.type;return Pe===A?le(H,$,Y.props.children,de,Y.key):$!==null&&($.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===pe&&Ng(Pe)===$.type)?(de=m($,Y.props),de.ref=fl(H,$,Y),de.return=H,de):(de=Pu(Y.type,Y.key,Y.props,null,H.mode,de),de.ref=fl(H,$,Y),de.return=H,de)}function J(H,$,Y,de){return $===null||$.tag!==4||$.stateNode.containerInfo!==Y.containerInfo||$.stateNode.implementation!==Y.implementation?($=Df(Y,H.mode,de),$.return=H,$):($=m($,Y.children||[]),$.return=H,$)}function le(H,$,Y,de,Pe){return $===null||$.tag!==7?($=Zo(Y,H.mode,de,Pe),$.return=H,$):($=m($,Y),$.return=H,$)}function he(H,$,Y){if(typeof $=="string"&&$!==""||typeof $=="number")return $=bf(""+$,H.mode,Y),$.return=H,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case O:return Y=Pu($.type,$.key,$.props,null,H.mode,Y),Y.ref=fl(H,null,$),Y.return=H,Y;case B:return $=Df($,H.mode,Y),$.return=H,$;case pe:var de=$._init;return he(H,de($._payload),Y)}if(nt($)||ee($))return $=Zo($,H.mode,Y,null),$.return=H,$;au(H,$)}return null}function ie(H,$,Y,de){var Pe=$!==null?$.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Pe!==null?null:F(H,$,""+Y,de);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case O:return Y.key===Pe?z(H,$,Y,de):null;case B:return Y.key===Pe?J(H,$,Y,de):null;case pe:return Pe=Y._init,ie(H,$,Pe(Y._payload),de)}if(nt(Y)||ee(Y))return Pe!==null?null:le(H,$,Y,de,null);au(H,Y)}return null}function Ee(H,$,Y,de,Pe){if(typeof de=="string"&&de!==""||typeof de=="number")return H=H.get(Y)||null,F($,H,""+de,Pe);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case O:return H=H.get(de.key===null?Y:de.key)||null,z($,H,de,Pe);case B:return H=H.get(de.key===null?Y:de.key)||null,J($,H,de,Pe);case pe:var Me=de._init;return Ee(H,$,Y,Me(de._payload),Pe)}if(nt(de)||ee(de))return H=H.get(Y)||null,le($,H,de,Pe,null);au($,de)}return null}function xe(H,$,Y,de){for(var Pe=null,Me=null,Oe=$,je=$=0,an=null;Oe!==null&&je<Y.length;je++){Oe.index>je?(an=Oe,Oe=null):an=Oe.sibling;var st=ie(H,Oe,Y[je],de);if(st===null){Oe===null&&(Oe=an);break}s&&Oe&&st.alternate===null&&i(H,Oe),$=_(st,$,je),Me===null?Pe=st:Me.sibling=st,Me=st,Oe=an}if(je===Y.length)return c(H,Oe),St&&qo(H,je),Pe;if(Oe===null){for(;je<Y.length;je++)Oe=he(H,Y[je],de),Oe!==null&&($=_(Oe,$,je),Me===null?Pe=Oe:Me.sibling=Oe,Me=Oe);return St&&qo(H,je),Pe}for(Oe=f(H,Oe);je<Y.length;je++)an=Ee(Oe,H,je,Y[je],de),an!==null&&(s&&an.alternate!==null&&Oe.delete(an.key===null?je:an.key),$=_(an,$,je),Me===null?Pe=an:Me.sibling=an,Me=an);return s&&Oe.forEach(function(co){return i(H,co)}),St&&qo(H,je),Pe}function Re(H,$,Y,de){var Pe=ee(Y);if(typeof Pe!="function")throw Error(t(150));if(Y=Pe.call(Y),Y==null)throw Error(t(151));for(var Me=Pe=null,Oe=$,je=$=0,an=null,st=Y.next();Oe!==null&&!st.done;je++,st=Y.next()){Oe.index>je?(an=Oe,Oe=null):an=Oe.sibling;var co=ie(H,Oe,st.value,de);if(co===null){Oe===null&&(Oe=an);break}s&&Oe&&co.alternate===null&&i(H,Oe),$=_(co,$,je),Me===null?Pe=co:Me.sibling=co,Me=co,Oe=an}if(st.done)return c(H,Oe),St&&qo(H,je),Pe;if(Oe===null){for(;!st.done;je++,st=Y.next())st=he(H,st.value,de),st!==null&&($=_(st,$,je),Me===null?Pe=st:Me.sibling=st,Me=st);return St&&qo(H,je),Pe}for(Oe=f(H,Oe);!st.done;je++,st=Y.next())st=Ee(Oe,H,je,st.value,de),st!==null&&(s&&st.alternate!==null&&Oe.delete(st.key===null?je:st.key),$=_(st,$,je),Me===null?Pe=st:Me.sibling=st,Me=st);return s&&Oe.forEach(function(UI){return i(H,UI)}),St&&qo(H,je),Pe}function Ot(H,$,Y,de){if(typeof Y=="object"&&Y!==null&&Y.type===A&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case O:e:{for(var Pe=Y.key,Me=$;Me!==null;){if(Me.key===Pe){if(Pe=Y.type,Pe===A){if(Me.tag===7){c(H,Me.sibling),$=m(Me,Y.props.children),$.return=H,H=$;break e}}else if(Me.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===pe&&Ng(Pe)===Me.type){c(H,Me.sibling),$=m(Me,Y.props),$.ref=fl(H,Me,Y),$.return=H,H=$;break e}c(H,Me);break}else i(H,Me);Me=Me.sibling}Y.type===A?($=Zo(Y.props.children,H.mode,de,Y.key),$.return=H,H=$):(de=Pu(Y.type,Y.key,Y.props,null,H.mode,de),de.ref=fl(H,$,Y),de.return=H,H=de)}return x(H);case B:e:{for(Me=Y.key;$!==null;){if($.key===Me)if($.tag===4&&$.stateNode.containerInfo===Y.containerInfo&&$.stateNode.implementation===Y.implementation){c(H,$.sibling),$=m($,Y.children||[]),$.return=H,H=$;break e}else{c(H,$);break}else i(H,$);$=$.sibling}$=Df(Y,H.mode,de),$.return=H,H=$}return x(H);case pe:return Me=Y._init,Ot(H,$,Me(Y._payload),de)}if(nt(Y))return xe(H,$,Y,de);if(ee(Y))return Re(H,$,Y,de);au(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,$!==null&&$.tag===6?(c(H,$.sibling),$=m($,Y),$.return=H,H=$):(c(H,$),$=bf(Y,H.mode,de),$.return=H,H=$),x(H)):c(H,$)}return Ot}var Zi=Rg(!0),kg=Rg(!1),lu=Zs(null),cu=null,Ji=null,zd=null;function Ud(){zd=Ji=cu=null}function $d(s){var i=lu.current;wt(lu),s._currentValue=i}function qd(s,i,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),s===c)break;s=s.return}}function ea(s,i){cu=s,zd=Ji=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(Kn=!0),s.firstContext=null)}function Er(s){var i=s._currentValue;if(zd!==s)if(s={context:s,memoizedValue:i,next:null},Ji===null){if(cu===null)throw Error(t(308));Ji=s,cu.dependencies={lanes:0,firstContext:s}}else Ji=Ji.next=s;return i}var Wo=null;function Wd(s){Wo===null?Wo=[s]:Wo.push(s)}function Pg(s,i,c,f){var m=i.interleaved;return m===null?(c.next=c,Wd(i)):(c.next=m.next,m.next=c),i.interleaved=c,Cs(s,f)}function Cs(s,i){s.lanes|=i;var c=s.alternate;for(c!==null&&(c.lanes|=i),c=s,s=s.return;s!==null;)s.childLanes|=i,c=s.alternate,c!==null&&(c.childLanes|=i),c=s,s=s.return;return c.tag===3?c.stateNode:null}var to=!1;function Gd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bg(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function As(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function no(s,i,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(rt&2)!==0){var m=f.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),f.pending=i,Cs(s,c)}return m=f.interleaved,m===null?(i.next=i,Wd(f)):(i.next=m.next,m.next=i),f.interleaved=i,Cs(s,c)}function uu(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var f=i.lanes;f&=s.pendingLanes,c|=f,i.lanes=c,Ws(s,c)}}function Dg(s,i){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var x={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};_===null?m=_=x:_=_.next=x,c=c.next}while(c!==null);_===null?m=_=i:_=_.next=i}else m=_=i;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:_,shared:f.shared,effects:f.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}function hu(s,i,c,f){var m=s.updateQueue;to=!1;var _=m.firstBaseUpdate,x=m.lastBaseUpdate,F=m.shared.pending;if(F!==null){m.shared.pending=null;var z=F,J=z.next;z.next=null,x===null?_=J:x.next=J,x=z;var le=s.alternate;le!==null&&(le=le.updateQueue,F=le.lastBaseUpdate,F!==x&&(F===null?le.firstBaseUpdate=J:F.next=J,le.lastBaseUpdate=z))}if(_!==null){var he=m.baseState;x=0,le=J=z=null,F=_;do{var ie=F.lane,Ee=F.eventTime;if((f&ie)===ie){le!==null&&(le=le.next={eventTime:Ee,lane:0,tag:F.tag,payload:F.payload,callback:F.callback,next:null});e:{var xe=s,Re=F;switch(ie=i,Ee=c,Re.tag){case 1:if(xe=Re.payload,typeof xe=="function"){he=xe.call(Ee,he,ie);break e}he=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=Re.payload,ie=typeof xe=="function"?xe.call(Ee,he,ie):xe,ie==null)break e;he=K({},he,ie);break e;case 2:to=!0}}F.callback!==null&&F.lane!==0&&(s.flags|=64,ie=m.effects,ie===null?m.effects=[F]:ie.push(F))}else Ee={eventTime:Ee,lane:ie,tag:F.tag,payload:F.payload,callback:F.callback,next:null},le===null?(J=le=Ee,z=he):le=le.next=Ee,x|=ie;if(F=F.next,F===null){if(F=m.shared.pending,F===null)break;ie=F,F=ie.next,ie.next=null,m.lastBaseUpdate=ie,m.shared.pending=null}}while(!0);if(le===null&&(z=he),m.baseState=z,m.firstBaseUpdate=J,m.lastBaseUpdate=le,i=m.shared.interleaved,i!==null){m=i;do x|=m.lane,m=m.next;while(m!==i)}else _===null&&(m.shared.lanes=0);Ko|=x,s.lanes=x,s.memoizedState=he}}function Vg(s,i,c){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var f=s[i],m=f.callback;if(m!==null){if(f.callback=null,f=c,typeof m!="function")throw Error(t(191,m));m.call(f)}}}var pl={},ns=Zs(pl),ml=Zs(pl),gl=Zs(pl);function Go(s){if(s===pl)throw Error(t(174));return s}function Hd(s,i){switch(vt(gl,i),vt(ml,s),vt(ns,pl),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:ft(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=ft(i,s)}wt(ns),vt(ns,i)}function ta(){wt(ns),wt(ml),wt(gl)}function Mg(s){Go(gl.current);var i=Go(ns.current),c=ft(i,s.type);i!==c&&(vt(ml,s),vt(ns,c))}function Kd(s){ml.current===s&&(wt(ns),wt(ml))}var Nt=Zs(0);function du(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Qd=[];function Xd(){for(var s=0;s<Qd.length;s++)Qd[s]._workInProgressVersionPrimary=null;Qd.length=0}var fu=X.ReactCurrentDispatcher,Yd=X.ReactCurrentBatchConfig,Ho=0,Rt=null,Yt=null,sn=null,pu=!1,yl=!1,vl=0,uI=0;function In(){throw Error(t(321))}function Zd(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!Or(s[c],i[c]))return!1;return!0}function Jd(s,i,c,f,m,_){if(Ho=_,Rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,fu.current=s===null||s.memoizedState===null?pI:mI,s=c(f,m),yl){_=0;do{if(yl=!1,vl=0,25<=_)throw Error(t(301));_+=1,sn=Yt=null,i.updateQueue=null,fu.current=gI,s=c(f,m)}while(yl)}if(fu.current=yu,i=Yt!==null&&Yt.next!==null,Ho=0,sn=Yt=Rt=null,pu=!1,i)throw Error(t(300));return s}function ef(){var s=vl!==0;return vl=0,s}function rs(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Rt.memoizedState=sn=s:sn=sn.next=s,sn}function Tr(){if(Yt===null){var s=Rt.alternate;s=s!==null?s.memoizedState:null}else s=Yt.next;var i=sn===null?Rt.memoizedState:sn.next;if(i!==null)sn=i,Yt=s;else{if(s===null)throw Error(t(310));Yt=s,s={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},sn===null?Rt.memoizedState=sn=s:sn=sn.next=s}return sn}function _l(s,i){return typeof i=="function"?i(s):i}function tf(s){var i=Tr(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=s;var f=Yt,m=f.baseQueue,_=c.pending;if(_!==null){if(m!==null){var x=m.next;m.next=_.next,_.next=x}f.baseQueue=m=_,c.pending=null}if(m!==null){_=m.next,f=f.baseState;var F=x=null,z=null,J=_;do{var le=J.lane;if((Ho&le)===le)z!==null&&(z=z.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),f=J.hasEagerState?J.eagerState:s(f,J.action);else{var he={lane:le,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};z===null?(F=z=he,x=f):z=z.next=he,Rt.lanes|=le,Ko|=le}J=J.next}while(J!==null&&J!==_);z===null?x=f:z.next=F,Or(f,i.memoizedState)||(Kn=!0),i.memoizedState=f,i.baseState=x,i.baseQueue=z,c.lastRenderedState=f}if(s=c.interleaved,s!==null){m=s;do _=m.lane,Rt.lanes|=_,Ko|=_,m=m.next;while(m!==s)}else m===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function nf(s){var i=Tr(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=s;var f=c.dispatch,m=c.pending,_=i.memoizedState;if(m!==null){c.pending=null;var x=m=m.next;do _=s(_,x.action),x=x.next;while(x!==m);Or(_,i.memoizedState)||(Kn=!0),i.memoizedState=_,i.baseQueue===null&&(i.baseState=_),c.lastRenderedState=_}return[_,f]}function Og(){}function Fg(s,i){var c=Rt,f=Tr(),m=i(),_=!Or(f.memoizedState,m);if(_&&(f.memoizedState=m,Kn=!0),f=f.queue,rf(Bg.bind(null,c,f,s),[s]),f.getSnapshot!==i||_||sn!==null&&sn.memoizedState.tag&1){if(c.flags|=2048,wl(9,Lg.bind(null,c,f,m,i),void 0,null),on===null)throw Error(t(349));(Ho&30)!==0||jg(c,i,m)}return m}function jg(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=Rt.updateQueue,i===null?(i={lastEffect:null,stores:null},Rt.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function Lg(s,i,c,f){i.value=c,i.getSnapshot=f,zg(i)&&Ug(s)}function Bg(s,i,c){return c(function(){zg(i)&&Ug(s)})}function zg(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!Or(s,c)}catch{return!0}}function Ug(s){var i=Cs(s,1);i!==null&&zr(i,s,1,-1)}function $g(s){var i=rs();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_l,lastRenderedState:s},i.queue=s,s=s.dispatch=fI.bind(null,Rt,s),[i.memoizedState,s]}function wl(s,i,c,f){return s={tag:s,create:i,destroy:c,deps:f,next:null},i=Rt.updateQueue,i===null?(i={lastEffect:null,stores:null},Rt.updateQueue=i,i.lastEffect=s.next=s):(c=i.lastEffect,c===null?i.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,i.lastEffect=s)),s}function qg(){return Tr().memoizedState}function mu(s,i,c,f){var m=rs();Rt.flags|=s,m.memoizedState=wl(1|i,c,void 0,f===void 0?null:f)}function gu(s,i,c,f){var m=Tr();f=f===void 0?null:f;var _=void 0;if(Yt!==null){var x=Yt.memoizedState;if(_=x.destroy,f!==null&&Zd(f,x.deps)){m.memoizedState=wl(i,c,_,f);return}}Rt.flags|=s,m.memoizedState=wl(1|i,c,_,f)}function Wg(s,i){return mu(8390656,8,s,i)}function rf(s,i){return gu(2048,8,s,i)}function Gg(s,i){return gu(4,2,s,i)}function Hg(s,i){return gu(4,4,s,i)}function Kg(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Qg(s,i,c){return c=c!=null?c.concat([s]):null,gu(4,4,Kg.bind(null,i,s),c)}function sf(){}function Xg(s,i){var c=Tr();i=i===void 0?null:i;var f=c.memoizedState;return f!==null&&i!==null&&Zd(i,f[1])?f[0]:(c.memoizedState=[s,i],s)}function Yg(s,i){var c=Tr();i=i===void 0?null:i;var f=c.memoizedState;return f!==null&&i!==null&&Zd(i,f[1])?f[0]:(s=s(),c.memoizedState=[s,i],s)}function Zg(s,i,c){return(Ho&21)===0?(s.baseState&&(s.baseState=!1,Kn=!0),s.memoizedState=c):(Or(c,i)||(c=Oo(),Rt.lanes|=c,Ko|=c,s.baseState=!0),i)}function hI(s,i){var c=He;He=c!==0&&4>c?c:4,s(!0);var f=Yd.transition;Yd.transition={};try{s(!1),i()}finally{He=c,Yd.transition=f}}function Jg(){return Tr().memoizedState}function dI(s,i,c){var f=io(s);if(c={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null},ey(s))ty(i,c);else if(c=Pg(s,i,c,f),c!==null){var m=Ln();zr(c,s,f,m),ny(c,i,f)}}function fI(s,i,c){var f=io(s),m={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null};if(ey(s))ty(i,m);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=i.lastRenderedReducer,_!==null))try{var x=i.lastRenderedState,F=_(x,c);if(m.hasEagerState=!0,m.eagerState=F,Or(F,x)){var z=i.interleaved;z===null?(m.next=m,Wd(i)):(m.next=z.next,z.next=m),i.interleaved=m;return}}catch{}finally{}c=Pg(s,i,m,f),c!==null&&(m=Ln(),zr(c,s,f,m),ny(c,i,f))}}function ey(s){var i=s.alternate;return s===Rt||i!==null&&i===Rt}function ty(s,i){yl=pu=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function ny(s,i,c){if((c&4194240)!==0){var f=i.lanes;f&=s.pendingLanes,c|=f,i.lanes=c,Ws(s,c)}}var yu={readContext:Er,useCallback:In,useContext:In,useEffect:In,useImperativeHandle:In,useInsertionEffect:In,useLayoutEffect:In,useMemo:In,useReducer:In,useRef:In,useState:In,useDebugValue:In,useDeferredValue:In,useTransition:In,useMutableSource:In,useSyncExternalStore:In,useId:In,unstable_isNewReconciler:!1},pI={readContext:Er,useCallback:function(s,i){return rs().memoizedState=[s,i===void 0?null:i],s},useContext:Er,useEffect:Wg,useImperativeHandle:function(s,i,c){return c=c!=null?c.concat([s]):null,mu(4194308,4,Kg.bind(null,i,s),c)},useLayoutEffect:function(s,i){return mu(4194308,4,s,i)},useInsertionEffect:function(s,i){return mu(4,2,s,i)},useMemo:function(s,i){var c=rs();return i=i===void 0?null:i,s=s(),c.memoizedState=[s,i],s},useReducer:function(s,i,c){var f=rs();return i=c!==void 0?c(i):i,f.memoizedState=f.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},f.queue=s,s=s.dispatch=dI.bind(null,Rt,s),[f.memoizedState,s]},useRef:function(s){var i=rs();return s={current:s},i.memoizedState=s},useState:$g,useDebugValue:sf,useDeferredValue:function(s){return rs().memoizedState=s},useTransition:function(){var s=$g(!1),i=s[0];return s=hI.bind(null,s[1]),rs().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,c){var f=Rt,m=rs();if(St){if(c===void 0)throw Error(t(407));c=c()}else{if(c=i(),on===null)throw Error(t(349));(Ho&30)!==0||jg(f,i,c)}m.memoizedState=c;var _={value:c,getSnapshot:i};return m.queue=_,Wg(Bg.bind(null,f,_,s),[s]),f.flags|=2048,wl(9,Lg.bind(null,f,_,c,i),void 0,null),c},useId:function(){var s=rs(),i=on.identifierPrefix;if(St){var c=xs,f=Ss;c=(f&~(1<<32-On(f)-1)).toString(32)+c,i=":"+i+"R"+c,c=vl++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=uI++,i=":"+i+"r"+c.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},mI={readContext:Er,useCallback:Xg,useContext:Er,useEffect:rf,useImperativeHandle:Qg,useInsertionEffect:Gg,useLayoutEffect:Hg,useMemo:Yg,useReducer:tf,useRef:qg,useState:function(){return tf(_l)},useDebugValue:sf,useDeferredValue:function(s){var i=Tr();return Zg(i,Yt.memoizedState,s)},useTransition:function(){var s=tf(_l)[0],i=Tr().memoizedState;return[s,i]},useMutableSource:Og,useSyncExternalStore:Fg,useId:Jg,unstable_isNewReconciler:!1},gI={readContext:Er,useCallback:Xg,useContext:Er,useEffect:rf,useImperativeHandle:Qg,useInsertionEffect:Gg,useLayoutEffect:Hg,useMemo:Yg,useReducer:nf,useRef:qg,useState:function(){return nf(_l)},useDebugValue:sf,useDeferredValue:function(s){var i=Tr();return Yt===null?i.memoizedState=s:Zg(i,Yt.memoizedState,s)},useTransition:function(){var s=nf(_l)[0],i=Tr().memoizedState;return[s,i]},useMutableSource:Og,useSyncExternalStore:Fg,useId:Jg,unstable_isNewReconciler:!1};function jr(s,i){if(s&&s.defaultProps){i=K({},i),s=s.defaultProps;for(var c in s)i[c]===void 0&&(i[c]=s[c]);return i}return i}function of(s,i,c,f){i=s.memoizedState,c=c(f,i),c=c==null?i:K({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var vu={isMounted:function(s){return(s=s._reactInternals)?Mn(s)===s:!1},enqueueSetState:function(s,i,c){s=s._reactInternals;var f=Ln(),m=io(s),_=As(f,m);_.payload=i,c!=null&&(_.callback=c),i=no(s,_,m),i!==null&&(zr(i,s,m,f),uu(i,s,m))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var f=Ln(),m=io(s),_=As(f,m);_.tag=1,_.payload=i,c!=null&&(_.callback=c),i=no(s,_,m),i!==null&&(zr(i,s,m,f),uu(i,s,m))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=Ln(),f=io(s),m=As(c,f);m.tag=2,i!=null&&(m.callback=i),i=no(s,m,f),i!==null&&(zr(i,s,f,c),uu(i,s,f))}};function ry(s,i,c,f,m,_,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,_,x):i.prototype&&i.prototype.isPureReactComponent?!il(c,f)||!il(m,_):!0}function sy(s,i,c){var f=!1,m=Js,_=i.contextType;return typeof _=="object"&&_!==null?_=Er(_):(m=Hn(i)?Uo:Tn.current,f=i.contextTypes,_=(f=f!=null)?Ki(s,m):Js),i=new i(c,_),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=vu,s.stateNode=i,i._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=_),i}function oy(s,i,c,f){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,f),i.state!==s&&vu.enqueueReplaceState(i,i.state,null)}function af(s,i,c,f){var m=s.stateNode;m.props=c,m.state=s.memoizedState,m.refs={},Gd(s);var _=i.contextType;typeof _=="object"&&_!==null?m.context=Er(_):(_=Hn(i)?Uo:Tn.current,m.context=Ki(s,_)),m.state=s.memoizedState,_=i.getDerivedStateFromProps,typeof _=="function"&&(of(s,i,_,c),m.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(i=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),i!==m.state&&vu.enqueueReplaceState(m,m.state,null),hu(s,c,m,f),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function na(s,i){try{var c="",f=i;do c+=ge(f),f=f.return;while(f);var m=c}catch(_){m=`
Error generating stack: `+_.message+`
`+_.stack}return{value:s,source:i,stack:m,digest:null}}function lf(s,i,c){return{value:s,source:null,stack:c??null,digest:i??null}}function cf(s,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var yI=typeof WeakMap=="function"?WeakMap:Map;function iy(s,i,c){c=As(-1,c),c.tag=3,c.payload={element:null};var f=i.value;return c.callback=function(){xu||(xu=!0,Sf=f),cf(s,i)},c}function ay(s,i,c){c=As(-1,c),c.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var m=i.value;c.payload=function(){return f(m)},c.callback=function(){cf(s,i)}}var _=s.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(c.callback=function(){cf(s,i),typeof f!="function"&&(so===null?so=new Set([this]):so.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})}),c}function ly(s,i,c){var f=s.pingCache;if(f===null){f=s.pingCache=new yI;var m=new Set;f.set(i,m)}else m=f.get(i),m===void 0&&(m=new Set,f.set(i,m));m.has(c)||(m.add(c),s=PI.bind(null,s,i,c),i.then(s,s))}function cy(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function uy(s,i,c,f,m){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=As(-1,1),i.tag=2,no(c,i,1))),c.lanes|=1),s):(s.flags|=65536,s.lanes=m,s)}var vI=X.ReactCurrentOwner,Kn=!1;function jn(s,i,c,f){i.child=s===null?kg(i,null,c,f):Zi(i,s.child,c,f)}function hy(s,i,c,f,m){c=c.render;var _=i.ref;return ea(i,m),f=Jd(s,i,c,f,_,m),c=ef(),s!==null&&!Kn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~m,Ns(s,i,m)):(St&&c&&Od(i),i.flags|=1,jn(s,i,f,m),i.child)}function dy(s,i,c,f,m){if(s===null){var _=c.type;return typeof _=="function"&&!Pf(_)&&_.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=_,fy(s,i,_,f,m)):(s=Pu(c.type,null,f,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(_=s.child,(s.lanes&m)===0){var x=_.memoizedProps;if(c=c.compare,c=c!==null?c:il,c(x,f)&&s.ref===i.ref)return Ns(s,i,m)}return i.flags|=1,s=lo(_,f),s.ref=i.ref,s.return=i,i.child=s}function fy(s,i,c,f,m){if(s!==null){var _=s.memoizedProps;if(il(_,f)&&s.ref===i.ref)if(Kn=!1,i.pendingProps=f=_,(s.lanes&m)!==0)(s.flags&131072)!==0&&(Kn=!0);else return i.lanes=s.lanes,Ns(s,i,m)}return uf(s,i,c,f,m)}function py(s,i,c){var f=i.pendingProps,m=f.children,_=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(sa,ar),ar|=c;else{if((c&1073741824)===0)return s=_!==null?_.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,vt(sa,ar),ar|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=_!==null?_.baseLanes:c,vt(sa,ar),ar|=f}else _!==null?(f=_.baseLanes|c,i.memoizedState=null):f=c,vt(sa,ar),ar|=f;return jn(s,i,m,c),i.child}function my(s,i){var c=i.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function uf(s,i,c,f,m){var _=Hn(c)?Uo:Tn.current;return _=Ki(i,_),ea(i,m),c=Jd(s,i,c,f,_,m),f=ef(),s!==null&&!Kn?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~m,Ns(s,i,m)):(St&&f&&Od(i),i.flags|=1,jn(s,i,c,m),i.child)}function gy(s,i,c,f,m){if(Hn(c)){var _=!0;nu(i)}else _=!1;if(ea(i,m),i.stateNode===null)wu(s,i),sy(i,c,f),af(i,c,f,m),f=!0;else if(s===null){var x=i.stateNode,F=i.memoizedProps;x.props=F;var z=x.context,J=c.contextType;typeof J=="object"&&J!==null?J=Er(J):(J=Hn(c)?Uo:Tn.current,J=Ki(i,J));var le=c.getDerivedStateFromProps,he=typeof le=="function"||typeof x.getSnapshotBeforeUpdate=="function";he||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(F!==f||z!==J)&&oy(i,x,f,J),to=!1;var ie=i.memoizedState;x.state=ie,hu(i,f,x,m),z=i.memoizedState,F!==f||ie!==z||Gn.current||to?(typeof le=="function"&&(of(i,c,le,f),z=i.memoizedState),(F=to||ry(i,c,F,f,ie,z,J))?(he||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=z),x.props=f,x.state=z,x.context=J,f=F):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{x=i.stateNode,bg(s,i),F=i.memoizedProps,J=i.type===i.elementType?F:jr(i.type,F),x.props=J,he=i.pendingProps,ie=x.context,z=c.contextType,typeof z=="object"&&z!==null?z=Er(z):(z=Hn(c)?Uo:Tn.current,z=Ki(i,z));var Ee=c.getDerivedStateFromProps;(le=typeof Ee=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(F!==he||ie!==z)&&oy(i,x,f,z),to=!1,ie=i.memoizedState,x.state=ie,hu(i,f,x,m);var xe=i.memoizedState;F!==he||ie!==xe||Gn.current||to?(typeof Ee=="function"&&(of(i,c,Ee,f),xe=i.memoizedState),(J=to||ry(i,c,J,f,ie,xe,z)||!1)?(le||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,xe,z),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,xe,z)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||F===s.memoizedProps&&ie===s.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||F===s.memoizedProps&&ie===s.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=xe),x.props=f,x.state=xe,x.context=z,f=J):(typeof x.componentDidUpdate!="function"||F===s.memoizedProps&&ie===s.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||F===s.memoizedProps&&ie===s.memoizedState||(i.flags|=1024),f=!1)}return hf(s,i,c,f,_,m)}function hf(s,i,c,f,m,_){my(s,i);var x=(i.flags&128)!==0;if(!f&&!x)return m&&Eg(i,c,!1),Ns(s,i,_);f=i.stateNode,vI.current=i;var F=x&&typeof c.getDerivedStateFromError!="function"?null:f.render();return i.flags|=1,s!==null&&x?(i.child=Zi(i,s.child,null,_),i.child=Zi(i,null,F,_)):jn(s,i,F,_),i.memoizedState=f.state,m&&Eg(i,c,!0),i.child}function yy(s){var i=s.stateNode;i.pendingContext?_g(s,i.pendingContext,i.pendingContext!==i.context):i.context&&_g(s,i.context,!1),Hd(s,i.containerInfo)}function vy(s,i,c,f,m){return Yi(),Bd(m),i.flags|=256,jn(s,i,c,f),i.child}var df={dehydrated:null,treeContext:null,retryLane:0};function ff(s){return{baseLanes:s,cachePool:null,transitions:null}}function _y(s,i,c){var f=i.pendingProps,m=Nt.current,_=!1,x=(i.flags&128)!==0,F;if((F=x)||(F=s!==null&&s.memoizedState===null?!1:(m&2)!==0),F?(_=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),vt(Nt,m&1),s===null)return Ld(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(x=f.children,s=f.fallback,_?(f=i.mode,_=i.child,x={mode:"hidden",children:x},(f&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=x):_=bu(x,f,0,null),s=Zo(s,f,c,null),_.return=i,s.return=i,_.sibling=s,i.child=_,i.child.memoizedState=ff(c),i.memoizedState=df,s):pf(i,x));if(m=s.memoizedState,m!==null&&(F=m.dehydrated,F!==null))return _I(s,i,x,f,F,m,c);if(_){_=f.fallback,x=i.mode,m=s.child,F=m.sibling;var z={mode:"hidden",children:f.children};return(x&1)===0&&i.child!==m?(f=i.child,f.childLanes=0,f.pendingProps=z,i.deletions=null):(f=lo(m,z),f.subtreeFlags=m.subtreeFlags&14680064),F!==null?_=lo(F,_):(_=Zo(_,x,c,null),_.flags|=2),_.return=i,f.return=i,f.sibling=_,i.child=f,f=_,_=i.child,x=s.child.memoizedState,x=x===null?ff(c):{baseLanes:x.baseLanes|c,cachePool:null,transitions:x.transitions},_.memoizedState=x,_.childLanes=s.childLanes&~c,i.memoizedState=df,f}return _=s.child,s=_.sibling,f=lo(_,{mode:"visible",children:f.children}),(i.mode&1)===0&&(f.lanes=c),f.return=i,f.sibling=null,s!==null&&(c=i.deletions,c===null?(i.deletions=[s],i.flags|=16):c.push(s)),i.child=f,i.memoizedState=null,f}function pf(s,i){return i=bu({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function _u(s,i,c,f){return f!==null&&Bd(f),Zi(i,s.child,null,c),s=pf(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function _I(s,i,c,f,m,_,x){if(c)return i.flags&256?(i.flags&=-257,f=lf(Error(t(422))),_u(s,i,x,f)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(_=f.fallback,m=i.mode,f=bu({mode:"visible",children:f.children},m,0,null),_=Zo(_,m,x,null),_.flags|=2,f.return=i,_.return=i,f.sibling=_,i.child=f,(i.mode&1)!==0&&Zi(i,s.child,null,x),i.child.memoizedState=ff(x),i.memoizedState=df,_);if((i.mode&1)===0)return _u(s,i,x,null);if(m.data==="$!"){if(f=m.nextSibling&&m.nextSibling.dataset,f)var F=f.dgst;return f=F,_=Error(t(419)),f=lf(_,f,void 0),_u(s,i,x,f)}if(F=(x&s.childLanes)!==0,Kn||F){if(f=on,f!==null){switch(x&-x){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(f.suspendedLanes|x))!==0?0:m,m!==0&&m!==_.retryLane&&(_.retryLane=m,Cs(s,m),zr(f,s,m,-1))}return kf(),f=lf(Error(t(421))),_u(s,i,x,f)}return m.data==="$?"?(i.flags|=128,i.child=s.child,i=bI.bind(null,s),m._reactRetry=i,null):(s=_.treeContext,ir=Ys(m.nextSibling),or=i,St=!0,Fr=null,s!==null&&(_r[wr++]=Ss,_r[wr++]=xs,_r[wr++]=$o,Ss=s.id,xs=s.overflow,$o=i),i=pf(i,f.children),i.flags|=4096,i)}function wy(s,i,c){s.lanes|=i;var f=s.alternate;f!==null&&(f.lanes|=i),qd(s.return,i,c)}function mf(s,i,c,f,m){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m}:(_.isBackwards=i,_.rendering=null,_.renderingStartTime=0,_.last=f,_.tail=c,_.tailMode=m)}function Ey(s,i,c){var f=i.pendingProps,m=f.revealOrder,_=f.tail;if(jn(s,i,f.children,c),f=Nt.current,(f&2)!==0)f=f&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&wy(s,c,i);else if(s.tag===19)wy(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(vt(Nt,f),(i.mode&1)===0)i.memoizedState=null;else switch(m){case"forwards":for(c=i.child,m=null;c!==null;)s=c.alternate,s!==null&&du(s)===null&&(m=c),c=c.sibling;c=m,c===null?(m=i.child,i.child=null):(m=c.sibling,c.sibling=null),mf(i,!1,m,c,_);break;case"backwards":for(c=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&du(s)===null){i.child=m;break}s=m.sibling,m.sibling=c,c=m,m=s}mf(i,!0,c,null,_);break;case"together":mf(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function wu(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Ns(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),Ko|=i.lanes,(c&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,c=lo(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=lo(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function wI(s,i,c){switch(i.tag){case 3:yy(i),Yi();break;case 5:Mg(i);break;case 1:Hn(i.type)&&nu(i);break;case 4:Hd(i,i.stateNode.containerInfo);break;case 10:var f=i.type._context,m=i.memoizedProps.value;vt(lu,f._currentValue),f._currentValue=m;break;case 13:if(f=i.memoizedState,f!==null)return f.dehydrated!==null?(vt(Nt,Nt.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?_y(s,i,c):(vt(Nt,Nt.current&1),s=Ns(s,i,c),s!==null?s.sibling:null);vt(Nt,Nt.current&1);break;case 19:if(f=(c&i.childLanes)!==0,(s.flags&128)!==0){if(f)return Ey(s,i,c);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),vt(Nt,Nt.current),f)break;return null;case 22:case 23:return i.lanes=0,py(s,i,c)}return Ns(s,i,c)}var Ty,gf,Iy,Sy;Ty=function(s,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)s.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},gf=function(){},Iy=function(s,i,c,f){var m=s.memoizedProps;if(m!==f){s=i.stateNode,Go(ns.current);var _=null;switch(c){case"input":m=re(s,m),f=re(s,f),_=[];break;case"select":m=K({},m,{value:void 0}),f=K({},f,{value:void 0}),_=[];break;case"textarea":m=Mt(s,m),f=Mt(s,f),_=[];break;default:typeof m.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=Jc)}ms(c,f);var x;c=null;for(J in m)if(!f.hasOwnProperty(J)&&m.hasOwnProperty(J)&&m[J]!=null)if(J==="style"){var F=m[J];for(x in F)F.hasOwnProperty(x)&&(c||(c={}),c[x]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(o.hasOwnProperty(J)?_||(_=[]):(_=_||[]).push(J,null));for(J in f){var z=f[J];if(F=m!=null?m[J]:void 0,f.hasOwnProperty(J)&&z!==F&&(z!=null||F!=null))if(J==="style")if(F){for(x in F)!F.hasOwnProperty(x)||z&&z.hasOwnProperty(x)||(c||(c={}),c[x]="");for(x in z)z.hasOwnProperty(x)&&F[x]!==z[x]&&(c||(c={}),c[x]=z[x])}else c||(_||(_=[]),_.push(J,c)),c=z;else J==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,F=F?F.__html:void 0,z!=null&&F!==z&&(_=_||[]).push(J,z)):J==="children"?typeof z!="string"&&typeof z!="number"||(_=_||[]).push(J,""+z):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(o.hasOwnProperty(J)?(z!=null&&J==="onScroll"&&_t("scroll",s),_||F===z||(_=[])):(_=_||[]).push(J,z))}c&&(_=_||[]).push("style",c);var J=_;(i.updateQueue=J)&&(i.flags|=4)}},Sy=function(s,i,c,f){c!==f&&(i.flags|=4)};function El(s,i){if(!St)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Sn(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(i)for(var m=s.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&14680064,f|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=f,s.childLanes=c,i}function EI(s,i,c){var f=i.pendingProps;switch(Fd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sn(i),null;case 1:return Hn(i.type)&&tu(),Sn(i),null;case 3:return f=i.stateNode,ta(),wt(Gn),wt(Tn),Xd(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(iu(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Fr!==null&&(Af(Fr),Fr=null))),gf(s,i),Sn(i),null;case 5:Kd(i);var m=Go(gl.current);if(c=i.type,s!==null&&i.stateNode!=null)Iy(s,i,c,f,m),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!f){if(i.stateNode===null)throw Error(t(166));return Sn(i),null}if(s=Go(ns.current),iu(i)){f=i.stateNode,c=i.type;var _=i.memoizedProps;switch(f[ts]=i,f[hl]=_,s=(i.mode&1)!==0,c){case"dialog":_t("cancel",f),_t("close",f);break;case"iframe":case"object":case"embed":_t("load",f);break;case"video":case"audio":for(m=0;m<ll.length;m++)_t(ll[m],f);break;case"source":_t("error",f);break;case"img":case"image":case"link":_t("error",f),_t("load",f);break;case"details":_t("toggle",f);break;case"input":se(f,_),_t("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!_.multiple},_t("invalid",f);break;case"textarea":Dn(f,_),_t("invalid",f)}ms(c,_),m=null;for(var x in _)if(_.hasOwnProperty(x)){var F=_[x];x==="children"?typeof F=="string"?f.textContent!==F&&(_.suppressHydrationWarning!==!0&&Zc(f.textContent,F,s),m=["children",F]):typeof F=="number"&&f.textContent!==""+F&&(_.suppressHydrationWarning!==!0&&Zc(f.textContent,F,s),m=["children",""+F]):o.hasOwnProperty(x)&&F!=null&&x==="onScroll"&&_t("scroll",f)}switch(c){case"input":Wt(f),Be(f,_,!0);break;case"textarea":Wt(f),Ht(f);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(f.onclick=Jc)}f=m,i.updateQueue=f,f!==null&&(i.flags|=4)}else{x=m.nodeType===9?m:m.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Ye(c)),s==="http://www.w3.org/1999/xhtml"?c==="script"?(s=x.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=x.createElement(c,{is:f.is}):(s=x.createElement(c),c==="select"&&(x=s,f.multiple?x.multiple=!0:f.size&&(x.size=f.size))):s=x.createElementNS(s,c),s[ts]=i,s[hl]=f,Ty(s,i,!1,!1),i.stateNode=s;e:{switch(x=Kr(c,f),c){case"dialog":_t("cancel",s),_t("close",s),m=f;break;case"iframe":case"object":case"embed":_t("load",s),m=f;break;case"video":case"audio":for(m=0;m<ll.length;m++)_t(ll[m],s);m=f;break;case"source":_t("error",s),m=f;break;case"img":case"image":case"link":_t("error",s),_t("load",s),m=f;break;case"details":_t("toggle",s),m=f;break;case"input":se(s,f),m=re(s,f),_t("invalid",s);break;case"option":m=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},m=K({},f,{value:void 0}),_t("invalid",s);break;case"textarea":Dn(s,f),m=Mt(s,f),_t("invalid",s);break;default:m=f}ms(c,m),F=m;for(_ in F)if(F.hasOwnProperty(_)){var z=F[_];_==="style"?Un(s,z):_==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,z!=null&&ps(s,z)):_==="children"?typeof z=="string"?(c!=="textarea"||z!=="")&&Kt(s,z):typeof z=="number"&&Kt(s,""+z):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(o.hasOwnProperty(_)?z!=null&&_==="onScroll"&&_t("scroll",s):z!=null&&U(s,_,z,x))}switch(c){case"input":Wt(s),Be(s,f,!1);break;case"textarea":Wt(s),Ht(s);break;case"option":f.value!=null&&s.setAttribute("value",""+fe(f.value));break;case"select":s.multiple=!!f.multiple,_=f.value,_!=null?ot(s,!!f.multiple,_,!1):f.defaultValue!=null&&ot(s,!!f.multiple,f.defaultValue,!0);break;default:typeof m.onClick=="function"&&(s.onclick=Jc)}switch(c){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Sn(i),null;case 6:if(s&&i.stateNode!=null)Sy(s,i,s.memoizedProps,f);else{if(typeof f!="string"&&i.stateNode===null)throw Error(t(166));if(c=Go(gl.current),Go(ns.current),iu(i)){if(f=i.stateNode,c=i.memoizedProps,f[ts]=i,(_=f.nodeValue!==c)&&(s=or,s!==null))switch(s.tag){case 3:Zc(f.nodeValue,c,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Zc(f.nodeValue,c,(s.mode&1)!==0)}_&&(i.flags|=4)}else f=(c.nodeType===9?c:c.ownerDocument).createTextNode(f),f[ts]=i,i.stateNode=f}return Sn(i),null;case 13:if(wt(Nt),f=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(St&&ir!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Ag(),Yi(),i.flags|=98560,_=!1;else if(_=iu(i),f!==null&&f.dehydrated!==null){if(s===null){if(!_)throw Error(t(318));if(_=i.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[ts]=i}else Yi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Sn(i),_=!1}else Fr!==null&&(Af(Fr),Fr=null),_=!0;if(!_)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(Nt.current&1)!==0?Zt===0&&(Zt=3):kf())),i.updateQueue!==null&&(i.flags|=4),Sn(i),null);case 4:return ta(),gf(s,i),s===null&&cl(i.stateNode.containerInfo),Sn(i),null;case 10:return $d(i.type._context),Sn(i),null;case 17:return Hn(i.type)&&tu(),Sn(i),null;case 19:if(wt(Nt),_=i.memoizedState,_===null)return Sn(i),null;if(f=(i.flags&128)!==0,x=_.rendering,x===null)if(f)El(_,!1);else{if(Zt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(x=du(s),x!==null){for(i.flags|=128,El(_,!1),f=x.updateQueue,f!==null&&(i.updateQueue=f,i.flags|=4),i.subtreeFlags=0,f=c,c=i.child;c!==null;)_=c,s=f,_.flags&=14680066,x=_.alternate,x===null?(_.childLanes=0,_.lanes=s,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=x.childLanes,_.lanes=x.lanes,_.child=x.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=x.memoizedProps,_.memoizedState=x.memoizedState,_.updateQueue=x.updateQueue,_.type=x.type,s=x.dependencies,_.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),c=c.sibling;return vt(Nt,Nt.current&1|2),i.child}s=s.sibling}_.tail!==null&&yt()>oa&&(i.flags|=128,f=!0,El(_,!1),i.lanes=4194304)}else{if(!f)if(s=du(x),s!==null){if(i.flags|=128,f=!0,c=s.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),El(_,!0),_.tail===null&&_.tailMode==="hidden"&&!x.alternate&&!St)return Sn(i),null}else 2*yt()-_.renderingStartTime>oa&&c!==1073741824&&(i.flags|=128,f=!0,El(_,!1),i.lanes=4194304);_.isBackwards?(x.sibling=i.child,i.child=x):(c=_.last,c!==null?c.sibling=x:i.child=x,_.last=x)}return _.tail!==null?(i=_.tail,_.rendering=i,_.tail=i.sibling,_.renderingStartTime=yt(),i.sibling=null,c=Nt.current,vt(Nt,f?c&1|2:c&1),i):(Sn(i),null);case 22:case 23:return Rf(),f=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(i.flags|=8192),f&&(i.mode&1)!==0?(ar&1073741824)!==0&&(Sn(i),i.subtreeFlags&6&&(i.flags|=8192)):Sn(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function TI(s,i){switch(Fd(i),i.tag){case 1:return Hn(i.type)&&tu(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return ta(),wt(Gn),wt(Tn),Xd(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Kd(i),null;case 13:if(wt(Nt),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Yi()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return wt(Nt),null;case 4:return ta(),null;case 10:return $d(i.type._context),null;case 22:case 23:return Rf(),null;case 24:return null;default:return null}}var Eu=!1,xn=!1,II=typeof WeakSet=="function"?WeakSet:Set,Se=null;function ra(s,i){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(f){Pt(s,i,f)}else c.current=null}function yf(s,i,c){try{c()}catch(f){Pt(s,i,f)}}var xy=!1;function SI(s,i){if(Nd=Ks,s=rg(),wd(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,_=f.focusNode;f=f.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var x=0,F=-1,z=-1,J=0,le=0,he=s,ie=null;t:for(;;){for(var Ee;he!==c||m!==0&&he.nodeType!==3||(F=x+m),he!==_||f!==0&&he.nodeType!==3||(z=x+f),he.nodeType===3&&(x+=he.nodeValue.length),(Ee=he.firstChild)!==null;)ie=he,he=Ee;for(;;){if(he===s)break t;if(ie===c&&++J===m&&(F=x),ie===_&&++le===f&&(z=x),(Ee=he.nextSibling)!==null)break;he=ie,ie=he.parentNode}he=Ee}c=F===-1||z===-1?null:{start:F,end:z}}else c=null}c=c||{start:0,end:0}}else c=null;for(Rd={focusedElem:s,selectionRange:c},Ks=!1,Se=i;Se!==null;)if(i=Se,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,Se=s;else for(;Se!==null;){i=Se;try{var xe=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(xe!==null){var Re=xe.memoizedProps,Ot=xe.memoizedState,H=i.stateNode,$=H.getSnapshotBeforeUpdate(i.elementType===i.type?Re:jr(i.type,Re),Ot);H.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var Y=i.stateNode.containerInfo;Y.nodeType===1?Y.textContent="":Y.nodeType===9&&Y.documentElement&&Y.removeChild(Y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(de){Pt(i,i.return,de)}if(s=i.sibling,s!==null){s.return=i.return,Se=s;break}Se=i.return}return xe=xy,xy=!1,xe}function Tl(s,i,c){var f=i.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var m=f=f.next;do{if((m.tag&s)===s){var _=m.destroy;m.destroy=void 0,_!==void 0&&yf(i,c,_)}m=m.next}while(m!==f)}}function Tu(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&s)===s){var f=c.create;c.destroy=f()}c=c.next}while(c!==i)}}function vf(s){var i=s.ref;if(i!==null){var c=s.stateNode;switch(s.tag){case 5:s=c;break;default:s=c}typeof i=="function"?i(s):i.current=s}}function Cy(s){var i=s.alternate;i!==null&&(s.alternate=null,Cy(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[ts],delete i[hl],delete i[Dd],delete i[iI],delete i[aI])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Ay(s){return s.tag===5||s.tag===3||s.tag===4}function Ny(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ay(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _f(s,i,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(s,i):c.insertBefore(s,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(s,c)):(i=c,i.appendChild(s)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Jc));else if(f!==4&&(s=s.child,s!==null))for(_f(s,i,c),s=s.sibling;s!==null;)_f(s,i,c),s=s.sibling}function wf(s,i,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(wf(s,i,c),s=s.sibling;s!==null;)wf(s,i,c),s=s.sibling}var mn=null,Lr=!1;function ro(s,i,c){for(c=c.child;c!==null;)Ry(s,i,c),c=c.sibling}function Ry(s,i,c){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(Vo,c)}catch{}switch(c.tag){case 5:xn||ra(c,i);case 6:var f=mn,m=Lr;mn=null,ro(s,i,c),mn=f,Lr=m,mn!==null&&(Lr?(s=mn,c=c.stateNode,s.nodeType===8?s.parentNode.removeChild(c):s.removeChild(c)):mn.removeChild(c.stateNode));break;case 18:mn!==null&&(Lr?(s=mn,c=c.stateNode,s.nodeType===8?bd(s.parentNode,c):s.nodeType===1&&bd(s,c),Vr(s)):bd(mn,c.stateNode));break;case 4:f=mn,m=Lr,mn=c.stateNode.containerInfo,Lr=!0,ro(s,i,c),mn=f,Lr=m;break;case 0:case 11:case 14:case 15:if(!xn&&(f=c.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){m=f=f.next;do{var _=m,x=_.destroy;_=_.tag,x!==void 0&&((_&2)!==0||(_&4)!==0)&&yf(c,i,x),m=m.next}while(m!==f)}ro(s,i,c);break;case 1:if(!xn&&(ra(c,i),f=c.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=c.memoizedProps,f.state=c.memoizedState,f.componentWillUnmount()}catch(F){Pt(c,i,F)}ro(s,i,c);break;case 21:ro(s,i,c);break;case 22:c.mode&1?(xn=(f=xn)||c.memoizedState!==null,ro(s,i,c),xn=f):ro(s,i,c);break;default:ro(s,i,c)}}function ky(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new II),i.forEach(function(f){var m=DI.bind(null,s,f);c.has(f)||(c.add(f),f.then(m,m))})}}function Br(s,i){var c=i.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f];try{var _=s,x=i,F=x;e:for(;F!==null;){switch(F.tag){case 5:mn=F.stateNode,Lr=!1;break e;case 3:mn=F.stateNode.containerInfo,Lr=!0;break e;case 4:mn=F.stateNode.containerInfo,Lr=!0;break e}F=F.return}if(mn===null)throw Error(t(160));Ry(_,x,m),mn=null,Lr=!1;var z=m.alternate;z!==null&&(z.return=null),m.return=null}catch(J){Pt(m,i,J)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Py(i,s),i=i.sibling}function Py(s,i){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Br(i,s),ss(s),f&4){try{Tl(3,s,s.return),Tu(3,s)}catch(Re){Pt(s,s.return,Re)}try{Tl(5,s,s.return)}catch(Re){Pt(s,s.return,Re)}}break;case 1:Br(i,s),ss(s),f&512&&c!==null&&ra(c,c.return);break;case 5:if(Br(i,s),ss(s),f&512&&c!==null&&ra(c,c.return),s.flags&32){var m=s.stateNode;try{Kt(m,"")}catch(Re){Pt(s,s.return,Re)}}if(f&4&&(m=s.stateNode,m!=null)){var _=s.memoizedProps,x=c!==null?c.memoizedProps:_,F=s.type,z=s.updateQueue;if(s.updateQueue=null,z!==null)try{F==="input"&&_.type==="radio"&&_.name!=null&&we(m,_),Kr(F,x);var J=Kr(F,_);for(x=0;x<z.length;x+=2){var le=z[x],he=z[x+1];le==="style"?Un(m,he):le==="dangerouslySetInnerHTML"?ps(m,he):le==="children"?Kt(m,he):U(m,le,he,J)}switch(F){case"input":Ie(m,_);break;case"textarea":Gt(m,_);break;case"select":var ie=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!_.multiple;var Ee=_.value;Ee!=null?ot(m,!!_.multiple,Ee,!1):ie!==!!_.multiple&&(_.defaultValue!=null?ot(m,!!_.multiple,_.defaultValue,!0):ot(m,!!_.multiple,_.multiple?[]:"",!1))}m[hl]=_}catch(Re){Pt(s,s.return,Re)}}break;case 6:if(Br(i,s),ss(s),f&4){if(s.stateNode===null)throw Error(t(162));m=s.stateNode,_=s.memoizedProps;try{m.nodeValue=_}catch(Re){Pt(s,s.return,Re)}}break;case 3:if(Br(i,s),ss(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Vr(i.containerInfo)}catch(Re){Pt(s,s.return,Re)}break;case 4:Br(i,s),ss(s);break;case 13:Br(i,s),ss(s),m=s.child,m.flags&8192&&(_=m.memoizedState!==null,m.stateNode.isHidden=_,!_||m.alternate!==null&&m.alternate.memoizedState!==null||(If=yt())),f&4&&ky(s);break;case 22:if(le=c!==null&&c.memoizedState!==null,s.mode&1?(xn=(J=xn)||le,Br(i,s),xn=J):Br(i,s),ss(s),f&8192){if(J=s.memoizedState!==null,(s.stateNode.isHidden=J)&&!le&&(s.mode&1)!==0)for(Se=s,le=s.child;le!==null;){for(he=Se=le;Se!==null;){switch(ie=Se,Ee=ie.child,ie.tag){case 0:case 11:case 14:case 15:Tl(4,ie,ie.return);break;case 1:ra(ie,ie.return);var xe=ie.stateNode;if(typeof xe.componentWillUnmount=="function"){f=ie,c=ie.return;try{i=f,xe.props=i.memoizedProps,xe.state=i.memoizedState,xe.componentWillUnmount()}catch(Re){Pt(f,c,Re)}}break;case 5:ra(ie,ie.return);break;case 22:if(ie.memoizedState!==null){Vy(he);continue}}Ee!==null?(Ee.return=ie,Se=Ee):Vy(he)}le=le.sibling}e:for(le=null,he=s;;){if(he.tag===5){if(le===null){le=he;try{m=he.stateNode,J?(_=m.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(F=he.stateNode,z=he.memoizedProps.style,x=z!=null&&z.hasOwnProperty("display")?z.display:null,F.style.display=wn("display",x))}catch(Re){Pt(s,s.return,Re)}}}else if(he.tag===6){if(le===null)try{he.stateNode.nodeValue=J?"":he.memoizedProps}catch(Re){Pt(s,s.return,Re)}}else if((he.tag!==22&&he.tag!==23||he.memoizedState===null||he===s)&&he.child!==null){he.child.return=he,he=he.child;continue}if(he===s)break e;for(;he.sibling===null;){if(he.return===null||he.return===s)break e;le===he&&(le=null),he=he.return}le===he&&(le=null),he.sibling.return=he.return,he=he.sibling}}break;case 19:Br(i,s),ss(s),f&4&&ky(s);break;case 21:break;default:Br(i,s),ss(s)}}function ss(s){var i=s.flags;if(i&2){try{e:{for(var c=s.return;c!==null;){if(Ay(c)){var f=c;break e}c=c.return}throw Error(t(160))}switch(f.tag){case 5:var m=f.stateNode;f.flags&32&&(Kt(m,""),f.flags&=-33);var _=Ny(s);wf(s,_,m);break;case 3:case 4:var x=f.stateNode.containerInfo,F=Ny(s);_f(s,F,x);break;default:throw Error(t(161))}}catch(z){Pt(s,s.return,z)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function xI(s,i,c){Se=s,by(s)}function by(s,i,c){for(var f=(s.mode&1)!==0;Se!==null;){var m=Se,_=m.child;if(m.tag===22&&f){var x=m.memoizedState!==null||Eu;if(!x){var F=m.alternate,z=F!==null&&F.memoizedState!==null||xn;F=Eu;var J=xn;if(Eu=x,(xn=z)&&!J)for(Se=m;Se!==null;)x=Se,z=x.child,x.tag===22&&x.memoizedState!==null?My(m):z!==null?(z.return=x,Se=z):My(m);for(;_!==null;)Se=_,by(_),_=_.sibling;Se=m,Eu=F,xn=J}Dy(s)}else(m.subtreeFlags&8772)!==0&&_!==null?(_.return=m,Se=_):Dy(s)}}function Dy(s){for(;Se!==null;){var i=Se;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:xn||Tu(5,i);break;case 1:var f=i.stateNode;if(i.flags&4&&!xn)if(c===null)f.componentDidMount();else{var m=i.elementType===i.type?c.memoizedProps:jr(i.type,c.memoizedProps);f.componentDidUpdate(m,c.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var _=i.updateQueue;_!==null&&Vg(i,_,f);break;case 3:var x=i.updateQueue;if(x!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}Vg(i,x,c)}break;case 5:var F=i.stateNode;if(c===null&&i.flags&4){c=F;var z=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":z.autoFocus&&c.focus();break;case"img":z.src&&(c.src=z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var J=i.alternate;if(J!==null){var le=J.memoizedState;if(le!==null){var he=le.dehydrated;he!==null&&Vr(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}xn||i.flags&512&&vf(i)}catch(ie){Pt(i,i.return,ie)}}if(i===s){Se=null;break}if(c=i.sibling,c!==null){c.return=i.return,Se=c;break}Se=i.return}}function Vy(s){for(;Se!==null;){var i=Se;if(i===s){Se=null;break}var c=i.sibling;if(c!==null){c.return=i.return,Se=c;break}Se=i.return}}function My(s){for(;Se!==null;){var i=Se;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{Tu(4,i)}catch(z){Pt(i,c,z)}break;case 1:var f=i.stateNode;if(typeof f.componentDidMount=="function"){var m=i.return;try{f.componentDidMount()}catch(z){Pt(i,m,z)}}var _=i.return;try{vf(i)}catch(z){Pt(i,_,z)}break;case 5:var x=i.return;try{vf(i)}catch(z){Pt(i,x,z)}}}catch(z){Pt(i,i.return,z)}if(i===s){Se=null;break}var F=i.sibling;if(F!==null){F.return=i.return,Se=F;break}Se=i.return}}var CI=Math.ceil,Iu=X.ReactCurrentDispatcher,Ef=X.ReactCurrentOwner,Ir=X.ReactCurrentBatchConfig,rt=0,on=null,$t=null,gn=0,ar=0,sa=Zs(0),Zt=0,Il=null,Ko=0,Su=0,Tf=0,Sl=null,Qn=null,If=0,oa=1/0,Rs=null,xu=!1,Sf=null,so=null,Cu=!1,oo=null,Au=0,xl=0,xf=null,Nu=-1,Ru=0;function Ln(){return(rt&6)!==0?yt():Nu!==-1?Nu:Nu=yt()}function io(s){return(s.mode&1)===0?1:(rt&2)!==0&&gn!==0?gn&-gn:cI.transition!==null?(Ru===0&&(Ru=Oo()),Ru):(s=He,s!==0||(s=window.event,s=s===void 0?16:Ja(s.type)),s)}function zr(s,i,c,f){if(50<xl)throw xl=0,xf=null,Error(t(185));qs(s,c,f),((rt&2)===0||s!==on)&&(s===on&&((rt&2)===0&&(Su|=c),Zt===4&&ao(s,gn)),Xn(s,f),c===1&&rt===0&&(i.mode&1)===0&&(oa=yt()+500,ru&&eo()))}function Xn(s,i){var c=s.callbackNode;ys(s,i);var f=Mo(s,s===on?gn:0);if(f===0)c!==null&&Ka(c),s.callbackNode=null,s.callbackPriority=0;else if(i=f&-f,s.callbackPriority!==i){if(c!=null&&Ka(c),i===1)s.tag===0?lI(Fy.bind(null,s)):Tg(Fy.bind(null,s)),sI(function(){(rt&6)===0&&eo()}),c=null;else{switch(Gs(f)){case 1:c=Do;break;case 4:c=zs;break;case 16:c=gr;break;case 536870912:c=Rc;break;default:c=gr}c=Wy(c,Oy.bind(null,s))}s.callbackPriority=i,s.callbackNode=c}}function Oy(s,i){if(Nu=-1,Ru=0,(rt&6)!==0)throw Error(t(327));var c=s.callbackNode;if(ia()&&s.callbackNode!==c)return null;var f=Mo(s,s===on?gn:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||i)i=ku(s,f);else{i=f;var m=rt;rt|=2;var _=Ly();(on!==s||gn!==i)&&(Rs=null,oa=yt()+500,Xo(s,i));do try{RI();break}catch(F){jy(s,F)}while(!0);Ud(),Iu.current=_,rt=m,$t!==null?i=0:(on=null,gn=0,i=Zt)}if(i!==0){if(i===2&&(m=nr(s),m!==0&&(f=m,i=Cf(s,m))),i===1)throw c=Il,Xo(s,0),ao(s,f),Xn(s,yt()),c;if(i===6)ao(s,f);else{if(m=s.current.alternate,(f&30)===0&&!AI(m)&&(i=ku(s,f),i===2&&(_=nr(s),_!==0&&(f=_,i=Cf(s,_))),i===1))throw c=Il,Xo(s,0),ao(s,f),Xn(s,yt()),c;switch(s.finishedWork=m,s.finishedLanes=f,i){case 0:case 1:throw Error(t(345));case 2:Yo(s,Qn,Rs);break;case 3:if(ao(s,f),(f&130023424)===f&&(i=If+500-yt(),10<i)){if(Mo(s,0)!==0)break;if(m=s.suspendedLanes,(m&f)!==f){Ln(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=Pd(Yo.bind(null,s,Qn,Rs),i);break}Yo(s,Qn,Rs);break;case 4:if(ao(s,f),(f&4194240)===f)break;for(i=s.eventTimes,m=-1;0<f;){var x=31-On(f);_=1<<x,x=i[x],x>m&&(m=x),f&=~_}if(f=m,f=yt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*CI(f/1960))-f,10<f){s.timeoutHandle=Pd(Yo.bind(null,s,Qn,Rs),f);break}Yo(s,Qn,Rs);break;case 5:Yo(s,Qn,Rs);break;default:throw Error(t(329))}}}return Xn(s,yt()),s.callbackNode===c?Oy.bind(null,s):null}function Cf(s,i){var c=Sl;return s.current.memoizedState.isDehydrated&&(Xo(s,i).flags|=256),s=ku(s,i),s!==2&&(i=Qn,Qn=c,i!==null&&Af(i)),s}function Af(s){Qn===null?Qn=s:Qn.push.apply(Qn,s)}function AI(s){for(var i=s;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var f=0;f<c.length;f++){var m=c[f],_=m.getSnapshot;m=m.value;try{if(!Or(_(),m))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ao(s,i){for(i&=~Tf,i&=~Su,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var c=31-On(i),f=1<<c;s[c]=-1,i&=~f}}function Fy(s){if((rt&6)!==0)throw Error(t(327));ia();var i=Mo(s,0);if((i&1)===0)return Xn(s,yt()),null;var c=ku(s,i);if(s.tag!==0&&c===2){var f=nr(s);f!==0&&(i=f,c=Cf(s,f))}if(c===1)throw c=Il,Xo(s,0),ao(s,i),Xn(s,yt()),c;if(c===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Yo(s,Qn,Rs),Xn(s,yt()),null}function Nf(s,i){var c=rt;rt|=1;try{return s(i)}finally{rt=c,rt===0&&(oa=yt()+500,ru&&eo())}}function Qo(s){oo!==null&&oo.tag===0&&(rt&6)===0&&ia();var i=rt;rt|=1;var c=Ir.transition,f=He;try{if(Ir.transition=null,He=1,s)return s()}finally{He=f,Ir.transition=c,rt=i,(rt&6)===0&&eo()}}function Rf(){ar=sa.current,wt(sa)}function Xo(s,i){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==-1&&(s.timeoutHandle=-1,rI(c)),$t!==null)for(c=$t.return;c!==null;){var f=c;switch(Fd(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&tu();break;case 3:ta(),wt(Gn),wt(Tn),Xd();break;case 5:Kd(f);break;case 4:ta();break;case 13:wt(Nt);break;case 19:wt(Nt);break;case 10:$d(f.type._context);break;case 22:case 23:Rf()}c=c.return}if(on=s,$t=s=lo(s.current,null),gn=ar=i,Zt=0,Il=null,Tf=Su=Ko=0,Qn=Sl=null,Wo!==null){for(i=0;i<Wo.length;i++)if(c=Wo[i],f=c.interleaved,f!==null){c.interleaved=null;var m=f.next,_=c.pending;if(_!==null){var x=_.next;_.next=m,f.next=x}c.pending=f}Wo=null}return s}function jy(s,i){do{var c=$t;try{if(Ud(),fu.current=yu,pu){for(var f=Rt.memoizedState;f!==null;){var m=f.queue;m!==null&&(m.pending=null),f=f.next}pu=!1}if(Ho=0,sn=Yt=Rt=null,yl=!1,vl=0,Ef.current=null,c===null||c.return===null){Zt=1,Il=i,$t=null;break}e:{var _=s,x=c.return,F=c,z=i;if(i=gn,F.flags|=32768,z!==null&&typeof z=="object"&&typeof z.then=="function"){var J=z,le=F,he=le.tag;if((le.mode&1)===0&&(he===0||he===11||he===15)){var ie=le.alternate;ie?(le.updateQueue=ie.updateQueue,le.memoizedState=ie.memoizedState,le.lanes=ie.lanes):(le.updateQueue=null,le.memoizedState=null)}var Ee=cy(x);if(Ee!==null){Ee.flags&=-257,uy(Ee,x,F,_,i),Ee.mode&1&&ly(_,J,i),i=Ee,z=J;var xe=i.updateQueue;if(xe===null){var Re=new Set;Re.add(z),i.updateQueue=Re}else xe.add(z);break e}else{if((i&1)===0){ly(_,J,i),kf();break e}z=Error(t(426))}}else if(St&&F.mode&1){var Ot=cy(x);if(Ot!==null){(Ot.flags&65536)===0&&(Ot.flags|=256),uy(Ot,x,F,_,i),Bd(na(z,F));break e}}_=z=na(z,F),Zt!==4&&(Zt=2),Sl===null?Sl=[_]:Sl.push(_),_=x;do{switch(_.tag){case 3:_.flags|=65536,i&=-i,_.lanes|=i;var H=iy(_,z,i);Dg(_,H);break e;case 1:F=z;var $=_.type,Y=_.stateNode;if((_.flags&128)===0&&(typeof $.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(so===null||!so.has(Y)))){_.flags|=65536,i&=-i,_.lanes|=i;var de=ay(_,F,i);Dg(_,de);break e}}_=_.return}while(_!==null)}zy(c)}catch(Pe){i=Pe,$t===c&&c!==null&&($t=c=c.return);continue}break}while(!0)}function Ly(){var s=Iu.current;return Iu.current=yu,s===null?yu:s}function kf(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),on===null||(Ko&268435455)===0&&(Su&268435455)===0||ao(on,gn)}function ku(s,i){var c=rt;rt|=2;var f=Ly();(on!==s||gn!==i)&&(Rs=null,Xo(s,i));do try{NI();break}catch(m){jy(s,m)}while(!0);if(Ud(),rt=c,Iu.current=f,$t!==null)throw Error(t(261));return on=null,gn=0,Zt}function NI(){for(;$t!==null;)By($t)}function RI(){for(;$t!==null&&!Ac();)By($t)}function By(s){var i=qy(s.alternate,s,ar);s.memoizedProps=s.pendingProps,i===null?zy(s):$t=i,Ef.current=null}function zy(s){var i=s;do{var c=i.alternate;if(s=i.return,(i.flags&32768)===0){if(c=EI(c,i,ar),c!==null){$t=c;return}}else{if(c=TI(c,i),c!==null){c.flags&=32767,$t=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Zt=6,$t=null;return}}if(i=i.sibling,i!==null){$t=i;return}$t=i=s}while(i!==null);Zt===0&&(Zt=5)}function Yo(s,i,c){var f=He,m=Ir.transition;try{Ir.transition=null,He=1,kI(s,i,c,f)}finally{Ir.transition=m,He=f}return null}function kI(s,i,c,f){do ia();while(oo!==null);if((rt&6)!==0)throw Error(t(327));c=s.finishedWork;var m=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var _=c.lanes|c.childLanes;if(mt(s,_),s===on&&($t=on=null,gn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||Cu||(Cu=!0,Wy(gr,function(){return ia(),null})),_=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||_){_=Ir.transition,Ir.transition=null;var x=He;He=1;var F=rt;rt|=4,Ef.current=null,SI(s,c),Py(c,s),XT(Rd),Ks=!!Nd,Rd=Nd=null,s.current=c,xI(c),dd(),rt=F,He=x,Ir.transition=_}else s.current=c;if(Cu&&(Cu=!1,oo=s,Au=m),_=s.pendingLanes,_===0&&(so=null),kc(c.stateNode),Xn(s,yt()),i!==null)for(f=s.onRecoverableError,c=0;c<i.length;c++)m=i[c],f(m.value,{componentStack:m.stack,digest:m.digest});if(xu)throw xu=!1,s=Sf,Sf=null,s;return(Au&1)!==0&&s.tag!==0&&ia(),_=s.pendingLanes,(_&1)!==0?s===xf?xl++:(xl=0,xf=s):xl=0,eo(),null}function ia(){if(oo!==null){var s=Gs(Au),i=Ir.transition,c=He;try{if(Ir.transition=null,He=16>s?16:s,oo===null)var f=!1;else{if(s=oo,oo=null,Au=0,(rt&6)!==0)throw Error(t(331));var m=rt;for(rt|=4,Se=s.current;Se!==null;){var _=Se,x=_.child;if((Se.flags&16)!==0){var F=_.deletions;if(F!==null){for(var z=0;z<F.length;z++){var J=F[z];for(Se=J;Se!==null;){var le=Se;switch(le.tag){case 0:case 11:case 15:Tl(8,le,_)}var he=le.child;if(he!==null)he.return=le,Se=he;else for(;Se!==null;){le=Se;var ie=le.sibling,Ee=le.return;if(Cy(le),le===J){Se=null;break}if(ie!==null){ie.return=Ee,Se=ie;break}Se=Ee}}}var xe=_.alternate;if(xe!==null){var Re=xe.child;if(Re!==null){xe.child=null;do{var Ot=Re.sibling;Re.sibling=null,Re=Ot}while(Re!==null)}}Se=_}}if((_.subtreeFlags&2064)!==0&&x!==null)x.return=_,Se=x;else e:for(;Se!==null;){if(_=Se,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Tl(9,_,_.return)}var H=_.sibling;if(H!==null){H.return=_.return,Se=H;break e}Se=_.return}}var $=s.current;for(Se=$;Se!==null;){x=Se;var Y=x.child;if((x.subtreeFlags&2064)!==0&&Y!==null)Y.return=x,Se=Y;else e:for(x=$;Se!==null;){if(F=Se,(F.flags&2048)!==0)try{switch(F.tag){case 0:case 11:case 15:Tu(9,F)}}catch(Pe){Pt(F,F.return,Pe)}if(F===x){Se=null;break e}var de=F.sibling;if(de!==null){de.return=F.return,Se=de;break e}Se=F.return}}if(rt=m,eo(),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(Vo,s)}catch{}f=!0}return f}finally{He=c,Ir.transition=i}}return!1}function Uy(s,i,c){i=na(c,i),i=iy(s,i,1),s=no(s,i,1),i=Ln(),s!==null&&(qs(s,1,i),Xn(s,i))}function Pt(s,i,c){if(s.tag===3)Uy(s,s,c);else for(;i!==null;){if(i.tag===3){Uy(i,s,c);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(so===null||!so.has(f))){s=na(c,s),s=ay(i,s,1),i=no(i,s,1),s=Ln(),i!==null&&(qs(i,1,s),Xn(i,s));break}}i=i.return}}function PI(s,i,c){var f=s.pingCache;f!==null&&f.delete(i),i=Ln(),s.pingedLanes|=s.suspendedLanes&c,on===s&&(gn&c)===c&&(Zt===4||Zt===3&&(gn&130023424)===gn&&500>yt()-If?Xo(s,0):Tf|=c),Xn(s,i)}function $y(s,i){i===0&&((s.mode&1)===0?i=1:(i=Ri,Ri<<=1,(Ri&130023424)===0&&(Ri=4194304)));var c=Ln();s=Cs(s,i),s!==null&&(qs(s,i,c),Xn(s,c))}function bI(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),$y(s,c)}function DI(s,i){var c=0;switch(s.tag){case 13:var f=s.stateNode,m=s.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(i),$y(s,c)}var qy;qy=function(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps||Gn.current)Kn=!0;else{if((s.lanes&c)===0&&(i.flags&128)===0)return Kn=!1,wI(s,i,c);Kn=(s.flags&131072)!==0}else Kn=!1,St&&(i.flags&1048576)!==0&&Ig(i,ou,i.index);switch(i.lanes=0,i.tag){case 2:var f=i.type;wu(s,i),s=i.pendingProps;var m=Ki(i,Tn.current);ea(i,c),m=Jd(null,i,f,s,m,c);var _=ef();return i.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Hn(f)?(_=!0,nu(i)):_=!1,i.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Gd(i),m.updater=vu,i.stateNode=m,m._reactInternals=i,af(i,f,s,c),i=hf(null,i,f,!0,_,c)):(i.tag=0,St&&_&&Od(i),jn(null,i,m,c),i=i.child),i;case 16:f=i.elementType;e:{switch(wu(s,i),s=i.pendingProps,m=f._init,f=m(f._payload),i.type=f,m=i.tag=MI(f),s=jr(f,s),m){case 0:i=uf(null,i,f,s,c);break e;case 1:i=gy(null,i,f,s,c);break e;case 11:i=hy(null,i,f,s,c);break e;case 14:i=dy(null,i,f,jr(f.type,s),c);break e}throw Error(t(306,f,""))}return i;case 0:return f=i.type,m=i.pendingProps,m=i.elementType===f?m:jr(f,m),uf(s,i,f,m,c);case 1:return f=i.type,m=i.pendingProps,m=i.elementType===f?m:jr(f,m),gy(s,i,f,m,c);case 3:e:{if(yy(i),s===null)throw Error(t(387));f=i.pendingProps,_=i.memoizedState,m=_.element,bg(s,i),hu(i,f,null,c);var x=i.memoizedState;if(f=x.element,_.isDehydrated)if(_={element:f,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},i.updateQueue.baseState=_,i.memoizedState=_,i.flags&256){m=na(Error(t(423)),i),i=vy(s,i,f,c,m);break e}else if(f!==m){m=na(Error(t(424)),i),i=vy(s,i,f,c,m);break e}else for(ir=Ys(i.stateNode.containerInfo.firstChild),or=i,St=!0,Fr=null,c=kg(i,null,f,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Yi(),f===m){i=Ns(s,i,c);break e}jn(s,i,f,c)}i=i.child}return i;case 5:return Mg(i),s===null&&Ld(i),f=i.type,m=i.pendingProps,_=s!==null?s.memoizedProps:null,x=m.children,kd(f,m)?x=null:_!==null&&kd(f,_)&&(i.flags|=32),my(s,i),jn(s,i,x,c),i.child;case 6:return s===null&&Ld(i),null;case 13:return _y(s,i,c);case 4:return Hd(i,i.stateNode.containerInfo),f=i.pendingProps,s===null?i.child=Zi(i,null,f,c):jn(s,i,f,c),i.child;case 11:return f=i.type,m=i.pendingProps,m=i.elementType===f?m:jr(f,m),hy(s,i,f,m,c);case 7:return jn(s,i,i.pendingProps,c),i.child;case 8:return jn(s,i,i.pendingProps.children,c),i.child;case 12:return jn(s,i,i.pendingProps.children,c),i.child;case 10:e:{if(f=i.type._context,m=i.pendingProps,_=i.memoizedProps,x=m.value,vt(lu,f._currentValue),f._currentValue=x,_!==null)if(Or(_.value,x)){if(_.children===m.children&&!Gn.current){i=Ns(s,i,c);break e}}else for(_=i.child,_!==null&&(_.return=i);_!==null;){var F=_.dependencies;if(F!==null){x=_.child;for(var z=F.firstContext;z!==null;){if(z.context===f){if(_.tag===1){z=As(-1,c&-c),z.tag=2;var J=_.updateQueue;if(J!==null){J=J.shared;var le=J.pending;le===null?z.next=z:(z.next=le.next,le.next=z),J.pending=z}}_.lanes|=c,z=_.alternate,z!==null&&(z.lanes|=c),qd(_.return,c,i),F.lanes|=c;break}z=z.next}}else if(_.tag===10)x=_.type===i.type?null:_.child;else if(_.tag===18){if(x=_.return,x===null)throw Error(t(341));x.lanes|=c,F=x.alternate,F!==null&&(F.lanes|=c),qd(x,c,i),x=_.sibling}else x=_.child;if(x!==null)x.return=_;else for(x=_;x!==null;){if(x===i){x=null;break}if(_=x.sibling,_!==null){_.return=x.return,x=_;break}x=x.return}_=x}jn(s,i,m.children,c),i=i.child}return i;case 9:return m=i.type,f=i.pendingProps.children,ea(i,c),m=Er(m),f=f(m),i.flags|=1,jn(s,i,f,c),i.child;case 14:return f=i.type,m=jr(f,i.pendingProps),m=jr(f.type,m),dy(s,i,f,m,c);case 15:return fy(s,i,i.type,i.pendingProps,c);case 17:return f=i.type,m=i.pendingProps,m=i.elementType===f?m:jr(f,m),wu(s,i),i.tag=1,Hn(f)?(s=!0,nu(i)):s=!1,ea(i,c),sy(i,f,m),af(i,f,m,c),hf(null,i,f,!0,s,c);case 19:return Ey(s,i,c);case 22:return py(s,i,c)}throw Error(t(156,i.tag))};function Wy(s,i){return Ai(s,i)}function VI(s,i,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(s,i,c,f){return new VI(s,i,c,f)}function Pf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function MI(s){if(typeof s=="function")return Pf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===M)return 11;if(s===ye)return 14}return 2}function lo(s,i){var c=s.alternate;return c===null?(c=Sr(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function Pu(s,i,c,f,m,_){var x=2;if(f=s,typeof s=="function")Pf(s)&&(x=1);else if(typeof s=="string")x=5;else e:switch(s){case A:return Zo(c.children,m,_,i);case I:x=8,m|=8;break;case N:return s=Sr(12,c,i,m|2),s.elementType=N,s.lanes=_,s;case R:return s=Sr(13,c,i,m),s.elementType=R,s.lanes=_,s;case ue:return s=Sr(19,c,i,m),s.elementType=ue,s.lanes=_,s;case ce:return bu(c,m,_,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case P:x=10;break e;case b:x=9;break e;case M:x=11;break e;case ye:x=14;break e;case pe:x=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Sr(x,c,i,m),i.elementType=s,i.type=f,i.lanes=_,i}function Zo(s,i,c,f){return s=Sr(7,s,f,i),s.lanes=c,s}function bu(s,i,c,f){return s=Sr(22,s,f,i),s.elementType=ce,s.lanes=c,s.stateNode={isHidden:!1},s}function bf(s,i,c){return s=Sr(6,s,null,i),s.lanes=c,s}function Df(s,i,c){return i=Sr(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function OI(s,i,c,f,m){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$s(0),this.expirationTimes=$s(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$s(0),this.identifierPrefix=f,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function Vf(s,i,c,f,m,_,x,F,z){return s=new OI(s,i,c,F,z),i===1?(i=1,_===!0&&(i|=8)):i=0,_=Sr(3,null,null,i),s.current=_,_.stateNode=s,_.memoizedState={element:f,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gd(_),s}function FI(s,i,c){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:f==null?null:""+f,children:s,containerInfo:i,implementation:c}}function Gy(s){if(!s)return Js;s=s._reactInternals;e:{if(Mn(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Hn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var c=s.type;if(Hn(c))return wg(s,c,i)}return i}function Hy(s,i,c,f,m,_,x,F,z){return s=Vf(c,f,!0,s,m,_,x,F,z),s.context=Gy(null),c=s.current,f=Ln(),m=io(c),_=As(f,m),_.callback=i??null,no(c,_,m),s.current.lanes=m,qs(s,m,f),Xn(s,f),s}function Du(s,i,c,f){var m=i.current,_=Ln(),x=io(m);return c=Gy(c),i.context===null?i.context=c:i.pendingContext=c,i=As(_,x),i.payload={element:s},f=f===void 0?null:f,f!==null&&(i.callback=f),s=no(m,i,x),s!==null&&(zr(s,m,x,_),uu(s,m,x)),x}function Vu(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Ky(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function Mf(s,i){Ky(s,i),(s=s.alternate)&&Ky(s,i)}function jI(){return null}var Qy=typeof reportError=="function"?reportError:function(s){console.error(s)};function Of(s){this._internalRoot=s}Mu.prototype.render=Of.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));Du(s,i,null,null)},Mu.prototype.unmount=Of.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Qo(function(){Du(null,s,null,null)}),i[Ts]=null}};function Mu(s){this._internalRoot=s}Mu.prototype.unstable_scheduleHydration=function(s){if(s){var i=Mc();s={blockedOn:null,target:s,priority:i};for(var c=0;c<Yr.length&&i!==0&&i<Yr[c].priority;c++);Yr.splice(c,0,s),c===0&&jc(s)}};function Ff(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Ou(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Xy(){}function LI(s,i,c,f,m){if(m){if(typeof f=="function"){var _=f;f=function(){var J=Vu(x);_.call(J)}}var x=Hy(i,f,s,0,null,!1,!1,"",Xy);return s._reactRootContainer=x,s[Ts]=x.current,cl(s.nodeType===8?s.parentNode:s),Qo(),x}for(;m=s.lastChild;)s.removeChild(m);if(typeof f=="function"){var F=f;f=function(){var J=Vu(z);F.call(J)}}var z=Vf(s,0,!1,null,null,!1,!1,"",Xy);return s._reactRootContainer=z,s[Ts]=z.current,cl(s.nodeType===8?s.parentNode:s),Qo(function(){Du(i,z,c,f)}),z}function Fu(s,i,c,f,m){var _=c._reactRootContainer;if(_){var x=_;if(typeof m=="function"){var F=m;m=function(){var z=Vu(x);F.call(z)}}Du(i,x,s,m)}else x=LI(c,i,s,m,f);return Vu(x)}Dc=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var c=Us(i.pendingLanes);c!==0&&(Ws(i,c|1),Xn(i,yt()),(rt&6)===0&&(oa=yt()+500,eo()))}break;case 13:Qo(function(){var f=Cs(s,1);if(f!==null){var m=Ln();zr(f,s,1,m)}}),Mf(s,1)}},ki=function(s){if(s.tag===13){var i=Cs(s,134217728);if(i!==null){var c=Ln();zr(i,s,134217728,c)}Mf(s,134217728)}},Vc=function(s){if(s.tag===13){var i=io(s),c=Cs(s,i);if(c!==null){var f=Ln();zr(c,s,i,f)}Mf(s,i)}},Mc=function(){return He},Oc=function(s,i){var c=He;try{return He=s,i()}finally{He=c}},Rr=function(s,i,c){switch(i){case"input":if(Ie(s,c),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var f=c[i];if(f!==s&&f.form===s.form){var m=eu(f);if(!m)throw Error(t(90));bn(f),Ie(f,m)}}}break;case"textarea":Gt(s,c);break;case"select":i=c.value,i!=null&&ot(s,!!c.multiple,i,!1)}},Ze=Nf,pt=Qo;var BI={usingClientEntryPoint:!1,Events:[dl,Gi,eu,Ne,Ue,Nf]},Cl={findFiberByHostInstance:zo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zI={bundleType:Cl.bundleType,version:Cl.version,rendererPackageName:Cl.rendererPackageName,rendererConfig:Cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:X.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Ha(s),s===null?null:s.stateNode},findFiberByHostInstance:Cl.findFiberByHostInstance||jI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ju=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ju.isDisabled&&ju.supportsFiber)try{Vo=ju.inject(zI),tr=ju}catch{}}return Yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BI,Yn.createPortal=function(s,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ff(i))throw Error(t(200));return FI(s,i,null,c)},Yn.createRoot=function(s,i){if(!Ff(s))throw Error(t(299));var c=!1,f="",m=Qy;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),i=Vf(s,1,!1,null,null,c,!1,f,m),s[Ts]=i.current,cl(s.nodeType===8?s.parentNode:s),new Of(i)},Yn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Ha(i),s=s===null?null:s.stateNode,s},Yn.flushSync=function(s){return Qo(s)},Yn.hydrate=function(s,i,c){if(!Ou(i))throw Error(t(200));return Fu(null,s,i,!0,c)},Yn.hydrateRoot=function(s,i,c){if(!Ff(s))throw Error(t(405));var f=c!=null&&c.hydratedSources||null,m=!1,_="",x=Qy;if(c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(_=c.identifierPrefix),c.onRecoverableError!==void 0&&(x=c.onRecoverableError)),i=Hy(i,null,s,1,c??null,m,!1,_,x),s[Ts]=i.current,cl(s),f)for(s=0;s<f.length;s++)c=f[s],m=c._getVersion,m=m(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,m]:i.mutableSourceEagerHydrationData.push(c,m);return new Mu(i)},Yn.render=function(s,i,c){if(!Ou(i))throw Error(t(200));return Fu(null,s,i,!1,c)},Yn.unmountComponentAtNode=function(s){if(!Ou(s))throw Error(t(40));return s._reactRootContainer?(Qo(function(){Fu(null,null,s,!1,function(){s._reactRootContainer=null,s[Ts]=null})}),!0):!1},Yn.unstable_batchedUpdates=Nf,Yn.unstable_renderSubtreeIntoContainer=function(s,i,c,f){if(!Ou(c))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Fu(s,i,c,!1,f)},Yn.version="18.3.1-next-f1338f8080-20240426",Yn}var ov;function XI(){if(ov)return Bf.exports;ov=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Bf.exports=QI(),Bf.exports}var iv;function YI(){if(iv)return Lu;iv=1;var r=XI();return Lu.createRoot=r.createRoot,Lu.hydrateRoot=r.hydrateRoot,Lu}var ZI=YI();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),y0=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var e1={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=ne.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:o="",children:a,iconNode:l,...u},d)=>ne.createElement("svg",{ref:d,...e1,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:y0("lucide",o),...u},[...l.map(([p,g])=>ne.createElement(p,g)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=(r,e)=>{const t=ne.forwardRef(({className:n,...o},a)=>ne.createElement(t1,{ref:a,iconNode:e,className:y0(`lucide-${JI(r)}`,n),...o}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],r1=Qe("Activity",n1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=[["path",{d:"M6 9h6V5l7 7-7 7v-4H6V9z",key:"7fvt9c"}]],o1=Qe("ArrowBigRight",s1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],a1=Qe("Award",i1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],v0=Qe("Check",l1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],u1=Qe("ChevronDown",c1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ei=Qe("ChevronLeft",h1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],mo=Qe("ChevronRight",d1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],p1=Qe("ChevronUp",f1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],g1=Qe("CirclePlus",m1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]],v1=Qe("CircleSlash",y1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],_0=Qe("Clock",_1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Gp=Qe("Download",w1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E1=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],T1=Qe("FileText",E1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I1=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],S1=Qe("GitCommitHorizontal",I1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],C1=Qe("Globe",x1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],N1=Qe("ImagePlus",A1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R1=[["path",{d:"M18 22H4a2 2 0 0 1-2-2V6",key:"pblm9e"}],["path",{d:"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18",key:"nf6bnh"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["rect",{width:"16",height:"16",x:"6",y:"2",rx:"2",key:"12espp"}]],k1=Qe("Images",R1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P1=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],b1=Qe("Info",P1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D1=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],V1=Qe("Loader",D1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],O1=Qe("Lock",M1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F1=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],j1=Qe("MessageSquare",F1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L1=[["path",{d:"M5 12h14",key:"1ays0h"}]],B1=Qe("Minus",L1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z1=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],ih=Qe("Music",z1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],Hp=Qe("Pause",U1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Kp=Qe("Play",$1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],W1=Qe("Plus",q1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],H1=Qe("RotateCw",G1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],w0=Qe("Save",K1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q1=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],X1=Qe("Settings",Q1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y1=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],Z1=Qe("ShoppingBag",Y1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J1=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],eS=Qe("Shuffle",J1);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],nS=Qe("SquarePen",tS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],E0=Qe("Trash2",rS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oS=Qe("TriangleAlert",sS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ur=Qe("X",iS),aS=()=>{};var av={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let o=r.charCodeAt(n);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},lS=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const o=r[t++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){const a=r[t++];e[n++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=r[t++],l=r[t++],u=r[t++],d=((o&7)<<18|(a&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const a=r[t++],l=r[t++];e[n++]=String.fromCharCode((o&15)<<12|(a&63)<<6|l&63)}}return e.join("")},I0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let o=0;o<r.length;o+=3){const a=r[o],l=o+1<r.length,u=l?r[o+1]:0,d=o+2<r.length,p=d?r[o+2]:0,g=a>>2,v=(a&3)<<4|u>>4;let T=(u&15)<<2|p>>6,S=p&63;d||(S=64,l||(T=64)),n.push(t[g],t[v],t[T],t[S])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(T0(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):lS(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let o=0;o<r.length;){const a=t[r.charAt(o++)],u=o<r.length?t[r.charAt(o)]:0;++o;const p=o<r.length?t[r.charAt(o)]:64;++o;const v=o<r.length?t[r.charAt(o)]:64;if(++o,a==null||u==null||p==null||v==null)throw new cS;const T=a<<2|u>>4;if(n.push(T),p!==64){const S=u<<4&240|p>>2;if(n.push(S),v!==64){const C=p<<6&192|v;n.push(C)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class cS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uS=function(r){const e=T0(r);return I0.encodeByteArray(e,!0)},ah=function(r){return uS(r).replace(/\./g,"")},hS=function(r){try{return I0.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS=()=>dS().__FIREBASE_DEFAULTS__,pS=()=>{if(typeof process>"u"||typeof av>"u")return;const r=av.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},mS=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&hS(r[1]);return e&&JSON.parse(e)},Qp=()=>{try{return aS()||fS()||pS()||mS()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},gS=r=>{var e,t;return(t=(e=Qp())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},yS=r=>{const e=gS(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},S0=()=>{var r;return(r=Qp())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",o=r.iat||0,a=r.sub||r.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},r);return[ah(JSON.stringify(t)),ah(JSON.stringify(l)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lh(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wS(){var r;const e=(r=Qp())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function x0(){return!wS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C0(){try{return typeof indexedDB=="object"}catch{return!1}}function ES(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(n);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var a;e(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS="FirebaseError";class wi extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=TS,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,A0.prototype.create)}}class A0{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},o=`${this.service}/${e}`,a=this.errors[e],l=a?IS(a,n):"Error",u=`${this.serviceName}: ${l} (${o}).`;return new wi(o,u,n)}}function IS(r,e){return r.replace(SS,(t,n)=>{const o=e[n];return o!=null?String(o):`<${n}?>`})}const SS=/\{\$([^}]+)}/g;function ch(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const o of t){if(!n.includes(o))return!1;const a=r[o],l=e[o];if(lv(a)&&lv(l)){if(!ch(a,l))return!1}else if(a!==l)return!1}for(const o of n)if(!t.includes(o))return!1;return!0}function lv(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(r){return r&&r._delegate?r._delegate:r}class wa{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new vS;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&n.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AS(e))try{this.getOrInitializeService({instanceIdentifier:ti})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:o});n.resolve(a)}catch{}}}}clearInstance(e=ti){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ti){return this.instances.has(e)}getOptions(e=ti){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(a);n===u&&l.resolve(o)}return o}onInit(e,t){var n;const o=this.normalizeInstanceIdentifier(t),a=(n=this.onInitCallbacks.get(o))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(o,a);const l=this.instances.get(o);return l&&e(l,o),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const o of n)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:CS(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ti){return this.component?this.component.multipleInstances?e:ti:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CS(r){return r===ti?void 0:r}function AS(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new xS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(tt||(tt={}));const RS={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},kS=tt.INFO,PS={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},bS=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),o=PS[e];if(o)console[o](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class R0{constructor(e){this.name=e,this._logLevel=kS,this._logHandler=bS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}}const DS=(r,e)=>e.some(t=>r instanceof t);let cv,uv;function VS(){return cv||(cv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MS(){return uv||(uv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const k0=new WeakMap,ap=new WeakMap,P0=new WeakMap,$f=new WeakMap,Xp=new WeakMap;function OS(r){const e=new Promise((t,n)=>{const o=()=>{r.removeEventListener("success",a),r.removeEventListener("error",l)},a=()=>{t(_o(r.result)),o()},l=()=>{n(r.error),o()};r.addEventListener("success",a),r.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&k0.set(t,r)}).catch(()=>{}),Xp.set(e,r),e}function FS(r){if(ap.has(r))return;const e=new Promise((t,n)=>{const o=()=>{r.removeEventListener("complete",a),r.removeEventListener("error",l),r.removeEventListener("abort",l)},a=()=>{t(),o()},l=()=>{n(r.error||new DOMException("AbortError","AbortError")),o()};r.addEventListener("complete",a),r.addEventListener("error",l),r.addEventListener("abort",l)});ap.set(r,e)}let lp={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return ap.get(r);if(e==="objectStoreNames")return r.objectStoreNames||P0.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return _o(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function jS(r){lp=r(lp)}function LS(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(qf(this),e,...t);return P0.set(n,e.sort?e.sort():[e]),_o(n)}:MS().includes(r)?function(...e){return r.apply(qf(this),e),_o(k0.get(this))}:function(...e){return _o(r.apply(qf(this),e))}}function BS(r){return typeof r=="function"?LS(r):(r instanceof IDBTransaction&&FS(r),DS(r,VS())?new Proxy(r,lp):r)}function _o(r){if(r instanceof IDBRequest)return OS(r);if($f.has(r))return $f.get(r);const e=BS(r);return e!==r&&($f.set(r,e),Xp.set(e,r)),e}const qf=r=>Xp.get(r);function zS(r,e,{blocked:t,upgrade:n,blocking:o,terminated:a}={}){const l=indexedDB.open(r,e),u=_o(l);return n&&l.addEventListener("upgradeneeded",d=>{n(_o(l.result),d.oldVersion,d.newVersion,_o(l.transaction),d)}),t&&l.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),u.then(d=>{a&&d.addEventListener("close",()=>a()),o&&d.addEventListener("versionchange",p=>o(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const US=["get","getKey","getAll","getAllKeys","count"],$S=["put","add","delete","clear"],Wf=new Map;function hv(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Wf.get(e))return Wf.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,o=$S.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(o||US.includes(t)))return;const a=async function(l,...u){const d=this.transaction(l,o?"readwrite":"readonly");let p=d.store;return n&&(p=p.index(u.shift())),(await Promise.all([p[t](...u),o&&d.done]))[0]};return Wf.set(e,a),a}jS(r=>({...r,get:(e,t,n)=>hv(e,t)||r.get(e,t,n),has:(e,t)=>!!hv(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(WS(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function WS(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cp="@firebase/app",dv="0.11.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms=new R0("@firebase/app"),GS="@firebase/app-compat",HS="@firebase/analytics-compat",KS="@firebase/analytics",QS="@firebase/app-check-compat",XS="@firebase/app-check",YS="@firebase/auth",ZS="@firebase/auth-compat",JS="@firebase/database",ex="@firebase/data-connect",tx="@firebase/database-compat",nx="@firebase/functions",rx="@firebase/functions-compat",sx="@firebase/installations",ox="@firebase/installations-compat",ix="@firebase/messaging",ax="@firebase/messaging-compat",lx="@firebase/performance",cx="@firebase/performance-compat",ux="@firebase/remote-config",hx="@firebase/remote-config-compat",dx="@firebase/storage",fx="@firebase/storage-compat",px="@firebase/firestore",mx="@firebase/vertexai",gx="@firebase/firestore-compat",yx="firebase",vx="11.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="[DEFAULT]",_x={[cp]:"fire-core",[GS]:"fire-core-compat",[KS]:"fire-analytics",[HS]:"fire-analytics-compat",[XS]:"fire-app-check",[QS]:"fire-app-check-compat",[YS]:"fire-auth",[ZS]:"fire-auth-compat",[JS]:"fire-rtdb",[ex]:"fire-data-connect",[tx]:"fire-rtdb-compat",[nx]:"fire-fn",[rx]:"fire-fn-compat",[sx]:"fire-iid",[ox]:"fire-iid-compat",[ix]:"fire-fcm",[ax]:"fire-fcm-compat",[lx]:"fire-perf",[cx]:"fire-perf-compat",[ux]:"fire-rc",[hx]:"fire-rc-compat",[dx]:"fire-gcs",[fx]:"fire-gcs-compat",[px]:"fire-fst",[gx]:"fire-fst-compat",[mx]:"fire-vertex","fire-js":"fire-js",[yx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Map,wx=new Map,hp=new Map;function fv(r,e){try{r.container.addComponent(e)}catch(t){Ms.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ql(r){const e=r.name;if(hp.has(e))return Ms.debug(`There were multiple attempts to register component ${e}.`),!1;hp.set(e,r);for(const t of uh.values())fv(t,r);for(const t of wx.values())fv(t,r);return!0}function b0(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function D0(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wo=new A0("app","Firebase",Ex);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new wa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0=vx;function M0(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:up,automaticDataCollectionEnabled:!1},e),o=n.name;if(typeof o!="string"||!o)throw wo.create("bad-app-name",{appName:String(o)});if(t||(t=S0()),!t)throw wo.create("no-options");const a=uh.get(o);if(a){if(ch(t,a.options)&&ch(n,a.config))return a;throw wo.create("duplicate-app",{appName:o})}const l=new NS(o);for(const d of hp.values())l.addComponent(d);const u=new Tx(t,n,l);return uh.set(o,u),u}function Ix(r=up){const e=uh.get(r);if(!e&&r===up&&S0())return M0();if(!e)throw wo.create("no-app",{appName:r});return e}function Eo(r,e,t){var n;let o=(n=_x[r])!==null&&n!==void 0?n:r;t&&(o+=`-${t}`);const a=o.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${o}" with version "${e}":`];a&&u.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ms.warn(u.join(" "));return}ql(new wa(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx="firebase-heartbeat-database",xx=1,Wl="firebase-heartbeat-store";let Gf=null;function O0(){return Gf||(Gf=zS(Sx,xx,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Wl)}catch(t){console.warn(t)}}}}).catch(r=>{throw wo.create("idb-open",{originalErrorMessage:r.message})})),Gf}async function Cx(r){try{const t=(await O0()).transaction(Wl),n=await t.objectStore(Wl).get(F0(r));return await t.done,n}catch(e){if(e instanceof wi)Ms.warn(e.message);else{const t=wo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ms.warn(t.message)}}}async function pv(r,e){try{const n=(await O0()).transaction(Wl,"readwrite");await n.objectStore(Wl).put(e,F0(r)),await n.done}catch(t){if(t instanceof wi)Ms.warn(t.message);else{const n=wo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ms.warn(n.message)}}}function F0(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax=1024,Nx=30;class Rx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Px(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=mv();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:o}),this._heartbeatsCache.heartbeats.length>Nx){const l=bx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ms.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=mv(),{heartbeatsToSend:n,unsentEntries:o}=kx(this._heartbeatsCache.heartbeats),a=ah(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Ms.warn(t),""}}}function mv(){return new Date().toISOString().substring(0,10)}function kx(r,e=Ax){const t=[];let n=r.slice();for(const o of r){const a=t.find(l=>l.agent===o.agent);if(a){if(a.dates.push(o.date),gv(t)>e){a.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),gv(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class Px{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return C0()?ES().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Cx(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return pv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return pv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function gv(r){return ah(JSON.stringify({version:2,heartbeats:r})).length}function bx(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(r){ql(new wa("platform-logger",e=>new qS(e),"PRIVATE")),ql(new wa("heartbeat",e=>new Rx(e),"PRIVATE")),Eo(cp,dv,r),Eo(cp,dv,"esm2017"),Eo("fire-js","")}Dx("");var Vx="firebase",Mx="11.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Eo(Vx,Mx,"app");var yv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var To,j0;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,I){function N(){}N.prototype=I.prototype,A.D=I.prototype,A.prototype=new N,A.prototype.constructor=A,A.C=function(P,b,M){for(var R=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)R[ue-2]=arguments[ue];return I.prototype[b].apply(P,R)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(A,I,N){N||(N=0);var P=Array(16);if(typeof I=="string")for(var b=0;16>b;++b)P[b]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(b=0;16>b;++b)P[b]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=A.g[0],N=A.g[1],b=A.g[2];var M=A.g[3],R=I+(M^N&(b^M))+P[0]+3614090360&4294967295;I=N+(R<<7&4294967295|R>>>25),R=M+(b^I&(N^b))+P[1]+3905402710&4294967295,M=I+(R<<12&4294967295|R>>>20),R=b+(N^M&(I^N))+P[2]+606105819&4294967295,b=M+(R<<17&4294967295|R>>>15),R=N+(I^b&(M^I))+P[3]+3250441966&4294967295,N=b+(R<<22&4294967295|R>>>10),R=I+(M^N&(b^M))+P[4]+4118548399&4294967295,I=N+(R<<7&4294967295|R>>>25),R=M+(b^I&(N^b))+P[5]+1200080426&4294967295,M=I+(R<<12&4294967295|R>>>20),R=b+(N^M&(I^N))+P[6]+2821735955&4294967295,b=M+(R<<17&4294967295|R>>>15),R=N+(I^b&(M^I))+P[7]+4249261313&4294967295,N=b+(R<<22&4294967295|R>>>10),R=I+(M^N&(b^M))+P[8]+1770035416&4294967295,I=N+(R<<7&4294967295|R>>>25),R=M+(b^I&(N^b))+P[9]+2336552879&4294967295,M=I+(R<<12&4294967295|R>>>20),R=b+(N^M&(I^N))+P[10]+4294925233&4294967295,b=M+(R<<17&4294967295|R>>>15),R=N+(I^b&(M^I))+P[11]+2304563134&4294967295,N=b+(R<<22&4294967295|R>>>10),R=I+(M^N&(b^M))+P[12]+1804603682&4294967295,I=N+(R<<7&4294967295|R>>>25),R=M+(b^I&(N^b))+P[13]+4254626195&4294967295,M=I+(R<<12&4294967295|R>>>20),R=b+(N^M&(I^N))+P[14]+2792965006&4294967295,b=M+(R<<17&4294967295|R>>>15),R=N+(I^b&(M^I))+P[15]+1236535329&4294967295,N=b+(R<<22&4294967295|R>>>10),R=I+(b^M&(N^b))+P[1]+4129170786&4294967295,I=N+(R<<5&4294967295|R>>>27),R=M+(N^b&(I^N))+P[6]+3225465664&4294967295,M=I+(R<<9&4294967295|R>>>23),R=b+(I^N&(M^I))+P[11]+643717713&4294967295,b=M+(R<<14&4294967295|R>>>18),R=N+(M^I&(b^M))+P[0]+3921069994&4294967295,N=b+(R<<20&4294967295|R>>>12),R=I+(b^M&(N^b))+P[5]+3593408605&4294967295,I=N+(R<<5&4294967295|R>>>27),R=M+(N^b&(I^N))+P[10]+38016083&4294967295,M=I+(R<<9&4294967295|R>>>23),R=b+(I^N&(M^I))+P[15]+3634488961&4294967295,b=M+(R<<14&4294967295|R>>>18),R=N+(M^I&(b^M))+P[4]+3889429448&4294967295,N=b+(R<<20&4294967295|R>>>12),R=I+(b^M&(N^b))+P[9]+568446438&4294967295,I=N+(R<<5&4294967295|R>>>27),R=M+(N^b&(I^N))+P[14]+3275163606&4294967295,M=I+(R<<9&4294967295|R>>>23),R=b+(I^N&(M^I))+P[3]+4107603335&4294967295,b=M+(R<<14&4294967295|R>>>18),R=N+(M^I&(b^M))+P[8]+1163531501&4294967295,N=b+(R<<20&4294967295|R>>>12),R=I+(b^M&(N^b))+P[13]+2850285829&4294967295,I=N+(R<<5&4294967295|R>>>27),R=M+(N^b&(I^N))+P[2]+4243563512&4294967295,M=I+(R<<9&4294967295|R>>>23),R=b+(I^N&(M^I))+P[7]+1735328473&4294967295,b=M+(R<<14&4294967295|R>>>18),R=N+(M^I&(b^M))+P[12]+2368359562&4294967295,N=b+(R<<20&4294967295|R>>>12),R=I+(N^b^M)+P[5]+4294588738&4294967295,I=N+(R<<4&4294967295|R>>>28),R=M+(I^N^b)+P[8]+2272392833&4294967295,M=I+(R<<11&4294967295|R>>>21),R=b+(M^I^N)+P[11]+1839030562&4294967295,b=M+(R<<16&4294967295|R>>>16),R=N+(b^M^I)+P[14]+4259657740&4294967295,N=b+(R<<23&4294967295|R>>>9),R=I+(N^b^M)+P[1]+2763975236&4294967295,I=N+(R<<4&4294967295|R>>>28),R=M+(I^N^b)+P[4]+1272893353&4294967295,M=I+(R<<11&4294967295|R>>>21),R=b+(M^I^N)+P[7]+4139469664&4294967295,b=M+(R<<16&4294967295|R>>>16),R=N+(b^M^I)+P[10]+3200236656&4294967295,N=b+(R<<23&4294967295|R>>>9),R=I+(N^b^M)+P[13]+681279174&4294967295,I=N+(R<<4&4294967295|R>>>28),R=M+(I^N^b)+P[0]+3936430074&4294967295,M=I+(R<<11&4294967295|R>>>21),R=b+(M^I^N)+P[3]+3572445317&4294967295,b=M+(R<<16&4294967295|R>>>16),R=N+(b^M^I)+P[6]+76029189&4294967295,N=b+(R<<23&4294967295|R>>>9),R=I+(N^b^M)+P[9]+3654602809&4294967295,I=N+(R<<4&4294967295|R>>>28),R=M+(I^N^b)+P[12]+3873151461&4294967295,M=I+(R<<11&4294967295|R>>>21),R=b+(M^I^N)+P[15]+530742520&4294967295,b=M+(R<<16&4294967295|R>>>16),R=N+(b^M^I)+P[2]+3299628645&4294967295,N=b+(R<<23&4294967295|R>>>9),R=I+(b^(N|~M))+P[0]+4096336452&4294967295,I=N+(R<<6&4294967295|R>>>26),R=M+(N^(I|~b))+P[7]+1126891415&4294967295,M=I+(R<<10&4294967295|R>>>22),R=b+(I^(M|~N))+P[14]+2878612391&4294967295,b=M+(R<<15&4294967295|R>>>17),R=N+(M^(b|~I))+P[5]+4237533241&4294967295,N=b+(R<<21&4294967295|R>>>11),R=I+(b^(N|~M))+P[12]+1700485571&4294967295,I=N+(R<<6&4294967295|R>>>26),R=M+(N^(I|~b))+P[3]+2399980690&4294967295,M=I+(R<<10&4294967295|R>>>22),R=b+(I^(M|~N))+P[10]+4293915773&4294967295,b=M+(R<<15&4294967295|R>>>17),R=N+(M^(b|~I))+P[1]+2240044497&4294967295,N=b+(R<<21&4294967295|R>>>11),R=I+(b^(N|~M))+P[8]+1873313359&4294967295,I=N+(R<<6&4294967295|R>>>26),R=M+(N^(I|~b))+P[15]+4264355552&4294967295,M=I+(R<<10&4294967295|R>>>22),R=b+(I^(M|~N))+P[6]+2734768916&4294967295,b=M+(R<<15&4294967295|R>>>17),R=N+(M^(b|~I))+P[13]+1309151649&4294967295,N=b+(R<<21&4294967295|R>>>11),R=I+(b^(N|~M))+P[4]+4149444226&4294967295,I=N+(R<<6&4294967295|R>>>26),R=M+(N^(I|~b))+P[11]+3174756917&4294967295,M=I+(R<<10&4294967295|R>>>22),R=b+(I^(M|~N))+P[2]+718787259&4294967295,b=M+(R<<15&4294967295|R>>>17),R=N+(M^(b|~I))+P[9]+3951481745&4294967295,A.g[0]=A.g[0]+I&4294967295,A.g[1]=A.g[1]+(b+(R<<21&4294967295|R>>>11))&4294967295,A.g[2]=A.g[2]+b&4294967295,A.g[3]=A.g[3]+M&4294967295}n.prototype.u=function(A,I){I===void 0&&(I=A.length);for(var N=I-this.blockSize,P=this.B,b=this.h,M=0;M<I;){if(b==0)for(;M<=N;)o(this,A,M),M+=this.blockSize;if(typeof A=="string"){for(;M<I;)if(P[b++]=A.charCodeAt(M++),b==this.blockSize){o(this,P),b=0;break}}else for(;M<I;)if(P[b++]=A[M++],b==this.blockSize){o(this,P),b=0;break}}this.h=b,this.o+=I},n.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var I=1;I<A.length-8;++I)A[I]=0;var N=8*this.o;for(I=A.length-8;I<A.length;++I)A[I]=N&255,N/=256;for(this.u(A),A=Array(16),I=N=0;4>I;++I)for(var P=0;32>P;P+=8)A[N++]=this.g[I]>>>P&255;return A};function a(A,I){var N=u;return Object.prototype.hasOwnProperty.call(N,A)?N[A]:N[A]=I(A)}function l(A,I){this.h=I;for(var N=[],P=!0,b=A.length-1;0<=b;b--){var M=A[b]|0;P&&M==I||(N[b]=M,P=!1)}this.g=N}var u={};function d(A){return-128<=A&&128>A?a(A,function(I){return new l([I|0],0>I?-1:0)}):new l([A|0],0>A?-1:0)}function p(A){if(isNaN(A)||!isFinite(A))return v;if(0>A)return V(p(-A));for(var I=[],N=1,P=0;A>=N;P++)I[P]=A/N|0,N*=4294967296;return new l(I,0)}function g(A,I){if(A.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(A.charAt(0)=="-")return V(g(A.substring(1),I));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=p(Math.pow(I,8)),P=v,b=0;b<A.length;b+=8){var M=Math.min(8,A.length-b),R=parseInt(A.substring(b,b+M),I);8>M?(M=p(Math.pow(I,M)),P=P.j(M).add(p(R))):(P=P.j(N),P=P.add(p(R)))}return P}var v=d(0),T=d(1),S=d(16777216);r=l.prototype,r.m=function(){if(D(this))return-V(this).m();for(var A=0,I=1,N=0;N<this.g.length;N++){var P=this.i(N);A+=(0<=P?P:4294967296+P)*I,I*=4294967296}return A},r.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(C(this))return"0";if(D(this))return"-"+V(this).toString(A);for(var I=p(Math.pow(A,6)),N=this,P="";;){var b=X(N,I).g;N=q(N,b.j(I));var M=((0<N.g.length?N.g[0]:N.h)>>>0).toString(A);if(N=b,C(N))return M+P;for(;6>M.length;)M="0"+M;P=M+P}},r.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function C(A){if(A.h!=0)return!1;for(var I=0;I<A.g.length;I++)if(A.g[I]!=0)return!1;return!0}function D(A){return A.h==-1}r.l=function(A){return A=q(this,A),D(A)?-1:C(A)?0:1};function V(A){for(var I=A.g.length,N=[],P=0;P<I;P++)N[P]=~A.g[P];return new l(N,~A.h).add(T)}r.abs=function(){return D(this)?V(this):this},r.add=function(A){for(var I=Math.max(this.g.length,A.g.length),N=[],P=0,b=0;b<=I;b++){var M=P+(this.i(b)&65535)+(A.i(b)&65535),R=(M>>>16)+(this.i(b)>>>16)+(A.i(b)>>>16);P=R>>>16,M&=65535,R&=65535,N[b]=R<<16|M}return new l(N,N[N.length-1]&-2147483648?-1:0)};function q(A,I){return A.add(V(I))}r.j=function(A){if(C(this)||C(A))return v;if(D(this))return D(A)?V(this).j(V(A)):V(V(this).j(A));if(D(A))return V(this.j(V(A)));if(0>this.l(S)&&0>A.l(S))return p(this.m()*A.m());for(var I=this.g.length+A.g.length,N=[],P=0;P<2*I;P++)N[P]=0;for(P=0;P<this.g.length;P++)for(var b=0;b<A.g.length;b++){var M=this.i(P)>>>16,R=this.i(P)&65535,ue=A.i(b)>>>16,ye=A.i(b)&65535;N[2*P+2*b]+=R*ye,L(N,2*P+2*b),N[2*P+2*b+1]+=M*ye,L(N,2*P+2*b+1),N[2*P+2*b+1]+=R*ue,L(N,2*P+2*b+1),N[2*P+2*b+2]+=M*ue,L(N,2*P+2*b+2)}for(P=0;P<I;P++)N[P]=N[2*P+1]<<16|N[2*P];for(P=I;P<2*I;P++)N[P]=0;return new l(N,0)};function L(A,I){for(;(A[I]&65535)!=A[I];)A[I+1]+=A[I]>>>16,A[I]&=65535,I++}function U(A,I){this.g=A,this.h=I}function X(A,I){if(C(I))throw Error("division by zero");if(C(A))return new U(v,v);if(D(A))return I=X(V(A),I),new U(V(I.g),V(I.h));if(D(I))return I=X(A,V(I)),new U(V(I.g),I.h);if(30<A.g.length){if(D(A)||D(I))throw Error("slowDivide_ only works with positive integers.");for(var N=T,P=I;0>=P.l(A);)N=O(N),P=O(P);var b=B(N,1),M=B(P,1);for(P=B(P,2),N=B(N,2);!C(P);){var R=M.add(P);0>=R.l(A)&&(b=b.add(N),M=R),P=B(P,1),N=B(N,1)}return I=q(A,b.j(I)),new U(b,I)}for(b=v;0<=A.l(I);){for(N=Math.max(1,Math.floor(A.m()/I.m())),P=Math.ceil(Math.log(N)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),M=p(N),R=M.j(I);D(R)||0<R.l(A);)N-=P,M=p(N),R=M.j(I);C(M)&&(M=T),b=b.add(M),A=q(A,R)}return new U(b,A)}r.A=function(A){return X(this,A).h},r.and=function(A){for(var I=Math.max(this.g.length,A.g.length),N=[],P=0;P<I;P++)N[P]=this.i(P)&A.i(P);return new l(N,this.h&A.h)},r.or=function(A){for(var I=Math.max(this.g.length,A.g.length),N=[],P=0;P<I;P++)N[P]=this.i(P)|A.i(P);return new l(N,this.h|A.h)},r.xor=function(A){for(var I=Math.max(this.g.length,A.g.length),N=[],P=0;P<I;P++)N[P]=this.i(P)^A.i(P);return new l(N,this.h^A.h)};function O(A){for(var I=A.g.length+1,N=[],P=0;P<I;P++)N[P]=A.i(P)<<1|A.i(P-1)>>>31;return new l(N,A.h)}function B(A,I){var N=I>>5;I%=32;for(var P=A.g.length-N,b=[],M=0;M<P;M++)b[M]=0<I?A.i(M+N)>>>I|A.i(M+N+1)<<32-I:A.i(M+N);return new l(b,A.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,j0=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=g,To=l}).apply(typeof yv<"u"?yv:typeof self<"u"?self:typeof window<"u"?window:{});var Bu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var L0,Dl,B0,Xu,dp,z0,U0,$0;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bu=="object"&&Bu];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var n=t(this);function o(h,y){if(y)e:{var E=n;h=h.split(".");for(var k=0;k<h.length-1;k++){var G=h[k];if(!(G in E))break e;E=E[G]}h=h[h.length-1],k=E[h],y=y(k),y!=k&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function a(h,y){h instanceof String&&(h+="");var E=0,k=!1,G={next:function(){if(!k&&E<h.length){var te=E++;return{value:y(te,h[te]),done:!1}}return k=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}o("Array.prototype.values",function(h){return h||function(){return a(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function d(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function p(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function g(h,y,E){return h.call.apply(h.bind,arguments)}function v(h,y,E){if(!h)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,k),h.apply(y,G)}}return function(){return h.apply(y,arguments)}}function T(h,y,E){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:v,T.apply(null,arguments)}function S(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var k=E.slice();return k.push.apply(k,arguments),h.apply(this,k)}}function C(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(k,G,te){for(var me=Array(arguments.length-2),at=2;at<arguments.length;at++)me[at-2]=arguments[at];return y.prototype[G].apply(k,me)}}function D(h){const y=h.length;if(0<y){const E=Array(y);for(let k=0;k<y;k++)E[k]=h[k];return E}return[]}function V(h,y){for(let E=1;E<arguments.length;E++){const k=arguments[E];if(d(k)){const G=h.length||0,te=k.length||0;h.length=G+te;for(let me=0;me<te;me++)h[G+me]=k[me]}else h.push(k)}}class q{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function L(h){return/^[\s\xa0]*$/.test(h)}function U(){var h=u.navigator;return h&&(h=h.userAgent)?h:""}function X(h){return X[" "](h),h}X[" "]=function(){};var O=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function B(h,y,E){for(const k in h)y.call(E,h[k],k,h)}function A(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function I(h){const y={};for(const E in h)y[E]=h[E];return y}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(h,y){let E,k;for(let G=1;G<arguments.length;G++){k=arguments[G];for(E in k)h[E]=k[E];for(let te=0;te<N.length;te++)E=N[te],Object.prototype.hasOwnProperty.call(k,E)&&(h[E]=k[E])}}function b(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function M(h){u.setTimeout(()=>{throw h},0)}function R(){var h=ee;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class ue{constructor(){this.h=this.g=null}add(y,E){const k=ye.get();k.set(y,E),this.h?this.h.next=k:this.g=k,this.h=k}}var ye=new q(()=>new pe,h=>h.reset());class pe{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,Z=!1,ee=new ue,K=()=>{const h=u.Promise.resolve(void 0);ce=()=>{h.then(j)}};var j=()=>{for(var h;h=R();){try{h.h.call(h.g)}catch(E){M(E)}var y=ye;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}Z=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var De=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};u.addEventListener("test",E,y),u.removeEventListener("test",E,y)}catch{}return h}();function ge(h,y){if(ve.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,k=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(O){e:{try{X(y.nodeName);var G=!0;break e}catch{}G=!1}G||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Fe[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ge.aa.h.call(this)}}C(ge,ve);var Fe={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Le="closure_listenable_"+(1e6*Math.random()|0),fe=0;function Xe(h,y,E,k,G){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!k,this.ha=G,this.key=++fe,this.da=this.fa=!1}function dt(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Wt(h){this.src=h,this.g={},this.h=0}Wt.prototype.add=function(h,y,E,k,G){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var me=_n(h,y,k,G);return-1<me?(y=h[me],E||(y.fa=!1)):(y=new Xe(y,this.src,te,!!k,G),y.fa=E,h.push(y)),y};function bn(h,y){var E=y.type;if(E in h.g){var k=h.g[E],G=Array.prototype.indexOf.call(k,y,void 0),te;(te=0<=G)&&Array.prototype.splice.call(k,G,1),te&&(dt(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function _n(h,y,E,k){for(var G=0;G<h.length;++G){var te=h[G];if(!te.da&&te.listener==y&&te.capture==!!E&&te.ha==k)return G}return-1}var re="closure_lm_"+(1e6*Math.random()|0),se={};function we(h,y,E,k,G){if(Array.isArray(y)){for(var te=0;te<y.length;te++)we(h,y[te],E,k,G);return null}return E=Ht(E),h&&h[Le]?h.K(y,E,p(k)?!!k.capture:!1,G):Ie(h,y,E,!1,k,G)}function Ie(h,y,E,k,G,te){if(!y)throw Error("Invalid event type");var me=p(G)?!!G.capture:!!G,at=Dn(h);if(at||(h[re]=at=new Wt(h)),E=at.add(y,E,k,me,te),E.proxy)return E;if(k=Be(),E.proxy=k,k.src=h,k.listener=E,h.addEventListener)De||(G=me),G===void 0&&(G=!1),h.addEventListener(y.toString(),k,G);else if(h.attachEvent)h.attachEvent(ot(y.toString()),k);else if(h.addListener&&h.removeListener)h.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Be(){function h(E){return y.call(h.src,h.listener,E)}const y=Mt;return h}function $e(h,y,E,k,G){if(Array.isArray(y))for(var te=0;te<y.length;te++)$e(h,y[te],E,k,G);else k=p(k)?!!k.capture:!!k,E=Ht(E),h&&h[Le]?(h=h.i,y=String(y).toString(),y in h.g&&(te=h.g[y],E=_n(te,E,k,G),-1<E&&(dt(te[E]),Array.prototype.splice.call(te,E,1),te.length==0&&(delete h.g[y],h.h--)))):h&&(h=Dn(h))&&(y=h.g[y.toString()],h=-1,y&&(h=_n(y,E,k,G)),(E=-1<h?y[h]:null)&&nt(E))}function nt(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Le])bn(y.i,h);else{var E=h.type,k=h.proxy;y.removeEventListener?y.removeEventListener(E,k,h.capture):y.detachEvent?y.detachEvent(ot(E),k):y.addListener&&y.removeListener&&y.removeListener(k),(E=Dn(y))?(bn(E,h),E.h==0&&(E.src=null,y[re]=null)):dt(h)}}}function ot(h){return h in se?se[h]:se[h]="on"+h}function Mt(h,y){if(h.da)h=!0;else{y=new ge(y,this);var E=h.listener,k=h.ha||h.src;h.fa&&nt(h),h=E.call(k,y)}return h}function Dn(h){return h=h[re],h instanceof Wt?h:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ht(h){return typeof h=="function"?h:(h[Gt]||(h[Gt]=function(y){return h.handleEvent(y)}),h[Gt])}function Ye(){Q.call(this),this.i=new Wt(this),this.M=this,this.F=null}C(Ye,Q),Ye.prototype[Le]=!0,Ye.prototype.removeEventListener=function(h,y,E,k){$e(this,h,y,E,k)};function ft(h,y){var E,k=h.F;if(k)for(E=[];k;k=k.F)E.push(k);if(h=h.M,k=y.type||y,typeof y=="string")y=new ve(y,h);else if(y instanceof ve)y.target=y.target||h;else{var G=y;y=new ve(k,h),P(y,G)}if(G=!0,E)for(var te=E.length-1;0<=te;te--){var me=y.g=E[te];G=Vn(me,k,!0,y)&&G}if(me=y.g=h,G=Vn(me,k,!0,y)&&G,G=Vn(me,k,!1,y)&&G,E)for(te=0;te<E.length;te++)me=y.g=E[te],G=Vn(me,k,!1,y)&&G}Ye.prototype.N=function(){if(Ye.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],k=0;k<E.length;k++)dt(E[k]);delete h.g[y],h.h--}}this.F=null},Ye.prototype.K=function(h,y,E,k){return this.i.add(String(h),y,!1,E,k)},Ye.prototype.L=function(h,y,E,k){return this.i.add(String(h),y,!0,E,k)};function Vn(h,y,E,k){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var G=!0,te=0;te<y.length;++te){var me=y[te];if(me&&!me.da&&me.capture==E){var at=me.listener,Xt=me.ha||me.src;me.fa&&bn(h.i,me),G=at.call(Xt,k)!==!1&&G}}return G&&!k.defaultPrevented}function ps(h,y,E){if(typeof h=="function")E&&(h=T(h,E));else if(h&&typeof h.handleEvent=="function")h=T(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:u.setTimeout(h,y||0)}function Kt(h){h.g=ps(()=>{h.g=null,h.i&&(h.i=!1,Kt(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class it extends Q{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Kt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function en(h){Q.call(this),this.h=h,this.g={}}C(en,Q);var wn=[];function Un(h){B(h.g,function(y,E){this.g.hasOwnProperty(E)&&nt(y)},h),h.g={}}en.prototype.N=function(){en.aa.N.call(this),Un(this)},en.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hr=u.JSON.stringify,ms=u.JSON.parse,Kr=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function fr(){}fr.prototype.h=null;function pr(h){return h.h||(h.h=h.i())}function Rr(){}var hn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $n(){ve.call(this,"d")}C($n,ve);function Te(){ve.call(this,"c")}C(Te,ve);var Ne={},Ue=null;function Ze(){return Ue=Ue||new Ye}Ne.La="serverreachability";function pt(h){ve.call(this,Ne.La,h)}C(pt,ve);function ct(h){const y=Ze();ft(y,new pt(y))}Ne.STAT_EVENT="statevent";function tn(h,y){ve.call(this,Ne.STAT_EVENT,h),this.stat=y}C(tn,ve);function ut(h){const y=Ze();ft(y,new tn(y,h))}Ne.Ma="timingevent";function kr(h,y){ve.call(this,Ne.Ma,h),this.size=y}C(kr,ve);function Qt(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},y)}function At(){this.g=!0}At.prototype.xa=function(){this.g=!1};function nn(h,y,E,k,G,te){h.info(function(){if(h.g)if(te)for(var me="",at=te.split("&"),Xt=0;Xt<at.length;Xt++){var Je=at[Xt].split("=");if(1<Je.length){var rn=Je[0];Je=Je[1];var Ut=rn.split("_");me=2<=Ut.length&&Ut[1]=="type"?me+(rn+"="+Je+"&"):me+(rn+"=redacted&")}}else me=null;else me=te;return"XMLHTTP REQ ("+k+") [attempt "+G+"]: "+y+`
`+E+`
`+me})}function mr(h,y,E,k,G,te,me){h.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+G+"]: "+y+`
`+E+`
`+te+" "+me})}function En(h,y,E,k){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Tt(h,E)+(k?" "+k:"")})}function We(h,y){h.info(function(){return"TIMEOUT: "+y})}At.prototype.info=function(){};function Tt(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var k=E[h];if(!(2>k.length)){var G=k[1];if(Array.isArray(G)&&!(1>G.length)){var te=G[0];if(te!="noop"&&te!="stop"&&te!="close")for(var me=1;me<G.length;me++)G[me]=""}}}}return Hr(E)}catch{return y}}var zt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Qr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Mn;function gs(){}C(gs,fr),gs.prototype.g=function(){return new XMLHttpRequest},gs.prototype.i=function(){return{}},Mn=new gs;function dn(h,y,E,k){this.j=h,this.i=y,this.l=E,this.R=k||1,this.U=new en(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Cc}function Cc(){this.i=null,this.g="",this.h=!1}var Ha={},Ci={};function Ai(h,y,E){h.L=1,h.v=Ws(nr(y)),h.m=E,h.P=!0,Ka(h,null)}function Ka(h,y){h.F=Date.now(),yt(h),h.A=nr(h.v);var E=h.A,k=h.R;Array.isArray(k)||(k=[String(k)]),Hs(E.i,"t",k),h.C=0,E=h.j.J,h.h=new Cc,h.g=qc(h.j,E?y:null,!h.m),0<h.O&&(h.M=new it(T(h.Y,h,h.g),h.O)),y=h.U,E=h.g,k=h.ca;var G="readystatechange";Array.isArray(G)||(G&&(wn[0]=G.toString()),G=wn);for(var te=0;te<G.length;te++){var me=we(E,G[te],k||y.handleEvent,!1,y.h||y);if(!me)break;y.g[me.key]=me}y=h.H?I(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),ct(),nn(h.i,h.u,h.A,h.l,h.R,h.m)}dn.prototype.ca=function(h){h=h.target;const y=this.M;y&&Wn(h)==3?y.j():this.Y(h)},dn.prototype.Y=function(h){try{if(h==this.g)e:{const Ut=Wn(this.g);var y=this.g.Ba();const vr=this.g.Z();if(!(3>Ut)&&(Ut!=3||this.g&&(this.h.h||this.g.oa()||el(this.g)))){this.J||Ut!=4||y==7||(y==8||0>=vr?ct(3):ct(2)),Do(this);var E=this.g.Z();this.X=E;t:if(Ac(this)){var k=el(this.g);h="";var G=k.length,te=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gr(this),zs(this);var me="";break t}this.h.i=new u.TextDecoder}for(y=0;y<G;y++)this.h.h=!0,h+=this.h.i.decode(k[y],{stream:!(te&&y==G-1)});k.length=0,this.h.g+=h,this.C=0,me=this.h.g}else me=this.g.oa();if(this.o=E==200,mr(this.i,this.u,this.A,this.l,this.R,Ut,E),this.o){if(this.T&&!this.K){t:{if(this.g){var at,Xt=this.g;if((at=Xt.g?Xt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(at)){var Je=at;break t}}Je=null}if(E=Je)En(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qa(this,E);else{this.o=!1,this.s=3,ut(12),gr(this),zs(this);break e}}if(this.P){E=!0;let sr;for(;!this.J&&this.C<me.length;)if(sr=dd(this,me),sr==Ci){Ut==4&&(this.s=4,ut(14),E=!1),En(this.i,this.l,null,"[Incomplete Response]");break}else if(sr==Ha){this.s=4,ut(15),En(this.i,this.l,me,"[Invalid Chunk]"),E=!1;break}else En(this.i,this.l,sr,null),Qa(this,sr);if(Ac(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ut!=4||me.length!=0||this.h.h||(this.s=1,ut(16),E=!1),this.o=this.o&&E,!E)En(this.i,this.l,me,"[Invalid Chunked Response]"),gr(this),zs(this);else if(0<me.length&&!this.W){this.W=!0;var rn=this.j;rn.g==this&&rn.ba&&!rn.M&&(rn.j.info("Great, no buffering proxy detected. Bytes received: "+me.length),nl(rn),rn.M=!0,ut(11))}}else En(this.i,this.l,me,null),Qa(this,me);Ut==4&&gr(this),this.o&&!this.J&&(Ut==4?ji(this.j,this):(this.o=!1,yt(this)))}else Di(this.g),E==400&&0<me.indexOf("Unknown SID")?(this.s=3,ut(12)):(this.s=0,ut(13)),gr(this),zs(this)}}}catch{}finally{}};function Ac(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function dd(h,y){var E=h.C,k=y.indexOf(`
`,E);return k==-1?Ci:(E=Number(y.substring(E,k)),isNaN(E)?Ha:(k+=1,k+E>y.length?Ci:(y=y.slice(k,k+E),h.C=k+E,y)))}dn.prototype.cancel=function(){this.J=!0,gr(this)};function yt(h){h.S=Date.now()+h.I,Nc(h,h.I)}function Nc(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Qt(T(h.ba,h),y)}function Do(h){h.B&&(u.clearTimeout(h.B),h.B=null)}dn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(We(this.i,this.A),this.L!=2&&(ct(),ut(17)),gr(this),this.s=2,zs(this)):Nc(this,this.S-h)};function zs(h){h.j.G==0||h.J||ji(h.j,h)}function gr(h){Do(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Un(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Qa(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||On(E.h,h))){if(!h.K&&On(E.h,h)&&E.G==3){try{var k=E.Da.g.parse(y)}catch{k=null}if(Array.isArray(k)&&k.length==3){var G=k;if(G[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)Fi(E),Mr(E);else break e;Oi(E),ut(18)}}else E.za=G[1],0<E.za-E.T&&37500>G[2]&&E.F&&E.v==0&&!E.C&&(E.C=Qt(T(E.Za,E),6e3));if(1>=kc(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else Es(E,11)}else if((h.K||E.g==h)&&Fi(E),!L(y))for(G=E.Da.g.parse(y),y=0;y<G.length;y++){let Je=G[y];if(E.T=Je[0],Je=Je[1],E.G==2)if(Je[0]=="c"){E.K=Je[1],E.ia=Je[2];const rn=Je[3];rn!=null&&(E.la=rn,E.j.info("VER="+E.la));const Ut=Je[4];Ut!=null&&(E.Aa=Ut,E.j.info("SVER="+E.Aa));const vr=Je[5];vr!=null&&typeof vr=="number"&&0<vr&&(k=1.5*vr,E.L=k,E.j.info("backChannelRequestTimeoutMs_="+k)),k=E;const sr=h.g;if(sr){const Bo=sr.g?sr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bo){var te=k.h;te.g||Bo.indexOf("spdy")==-1&&Bo.indexOf("quic")==-1&&Bo.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Xa(te,te.h),te.h=null))}if(k.D){const Bi=sr.g?sr.g.getResponseHeader("X-HTTP-Session-Id"):null;Bi&&(k.ya=Bi,mt(k.I,k.D,Bi))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),k=E;var me=h;if(k.qa=$c(k,k.J?k.ia:null,k.W),me.K){Pc(k.h,me);var at=me,Xt=k.L;Xt&&(at.I=Xt),at.B&&(Do(at),yt(at)),k.g=me}else Lo(k);0<E.i.length&&Jr(E)}else Je[0]!="stop"&&Je[0]!="close"||Es(E,7);else E.G==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?Es(E,7):pn(E):Je[0]!="noop"&&E.l&&E.l.ta(Je),E.v=0)}}ct(4)}catch{}}var Rc=class{constructor(h,y){this.g=h,this.map=y}};function Vo(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function kc(h){return h.h?1:h.g?h.g.size:0}function On(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Xa(h,y){h.g?h.g.add(y):h.h=y}function Pc(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Vo.prototype.cancel=function(){if(this.i=bc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function bc(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return D(h.i)}function Ni(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(d(h)){for(var y=[],E=h.length,k=0;k<E;k++)y.push(h[k]);return y}y=[],E=0;for(k in h)y[E++]=h[k];return y}function Ri(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(d(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const k in h)y[E++]=k;return y}}}function Us(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(d(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=Ri(h),k=Ni(h),G=k.length,te=0;te<G;te++)y.call(void 0,k[te],E&&E[te],h)}var Mo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fd(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var k=h[E].indexOf("="),G=null;if(0<=k){var te=h[E].substring(0,k);G=h[E].substring(k+1)}else te=h[E];y(te,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function ys(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof ys){this.h=h.h,Oo(this,h.j),this.o=h.o,this.g=h.g,$s(this,h.s),this.l=h.l;var y=h.i,E=new Xr;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),qs(this,E),this.m=h.m}else h&&(y=String(h).match(Mo))?(this.h=!1,Oo(this,y[1]||"",!0),this.o=He(y[2]||""),this.g=He(y[3]||"",!0),$s(this,y[4]),this.l=He(y[5]||"",!0),qs(this,y[6]||"",!0),this.m=He(y[7]||"")):(this.h=!1,this.i=new Xr(null,this.h))}ys.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Gs(y,ki,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Gs(y,ki,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Gs(E,E.charAt(0)=="/"?Mc:Vc,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Gs(E,Ya)),h.join("")};function nr(h){return new ys(h)}function Oo(h,y,E){h.j=E?He(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function $s(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function qs(h,y,E){y instanceof Xr?(h.i=y,Yr(h.i,h.h)):(E||(y=Gs(y,Oc)),h.i=new Xr(y,h.h))}function mt(h,y,E){h.i.set(y,E)}function Ws(h){return mt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function He(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Gs(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,Dc),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Dc(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var ki=/[#\/\?@]/g,Vc=/[#\?:]/g,Mc=/[#\?]/g,Oc=/[#\?@]/g,Ya=/#/g;function Xr(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function fn(h){h.g||(h.g=new Map,h.h=0,h.i&&fd(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}r=Xr.prototype,r.add=function(h,y){fn(this),this.i=null,h=yr(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function Pr(h,y){fn(h),y=yr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function br(h,y){return fn(h),y=yr(h,y),h.g.has(y)}r.forEach=function(h,y){fn(this),this.g.forEach(function(E,k){E.forEach(function(G){h.call(y,G,k,this)},this)},this)},r.na=function(){fn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let k=0;k<y.length;k++){const G=h[k];for(let te=0;te<G.length;te++)E.push(y[k])}return E},r.V=function(h){fn(this);let y=[];if(typeof h=="string")br(this,h)&&(y=y.concat(this.g.get(yr(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},r.set=function(h,y){return fn(this),this.i=null,h=yr(this,h),br(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},r.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Hs(h,y,E){Pr(h,y),0<E.length&&(h.i=null,h.g.set(yr(h,y),D(E)),h.h+=E.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var k=y[E];const te=encodeURIComponent(String(k)),me=this.V(k);for(k=0;k<me.length;k++){var G=te;me[k]!==""&&(G+="="+encodeURIComponent(String(me[k]))),h.push(G)}}return this.i=h.join("&")};function yr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Yr(h,y){y&&!h.j&&(fn(h),h.i=null,h.g.forEach(function(E,k){var G=k.toLowerCase();k!=G&&(Pr(this,k),Hs(this,G,E))},h)),h.j=y}function pd(h,y){const E=new At;if(u.Image){const k=new Image;k.onload=S(qn,E,"TestLoadImage: loaded",!0,y,k),k.onerror=S(qn,E,"TestLoadImage: error",!1,y,k),k.onabort=S(qn,E,"TestLoadImage: abort",!1,y,k),k.ontimeout=S(qn,E,"TestLoadImage: timeout",!1,y,k),u.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=h}else y(!1)}function Fc(h,y){const E=new At,k=new AbortController,G=setTimeout(()=>{k.abort(),qn(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:k.signal}).then(te=>{clearTimeout(G),te.ok?qn(E,"TestPingServer: ok",!0,y):qn(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(G),qn(E,"TestPingServer: error",!1,y)})}function qn(h,y,E,k,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),k(E)}catch{}}function md(){this.g=new Kr}function jc(h,y,E){const k=E||"";try{Us(h,function(G,te){let me=G;p(G)&&(me=Hr(G)),y.push(k+te+"="+encodeURIComponent(me))})}catch(G){throw y.push(k+"type="+encodeURIComponent("_badmap")),G}}function vs(h){this.l=h.Ub||null,this.j=h.eb||!1}C(vs,fr),vs.prototype.g=function(){return new Fo(this.l,this.j)},vs.prototype.i=function(h){return function(){return h}}({});function Fo(h,y){Ye.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Fo,Ye),r=Fo.prototype,r.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Vr(this)},r.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||u).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Dr(this)),this.readyState=0},r.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Vr(this)),this.g&&(this.readyState=3,Vr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lc(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lc(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}r.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Dr(this):Vr(this),this.readyState==3&&Lc(this)}},r.Ra=function(h){this.g&&(this.response=this.responseText=h,Dr(this))},r.Qa=function(h){this.g&&(this.response=h,Dr(this))},r.ga=function(){this.g&&Dr(this)};function Dr(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Vr(h)}r.setRequestHeader=function(h,y){this.u.append(h,y)},r.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function Vr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Fo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function _s(h){let y="";return B(h,function(E,k){y+=k,y+=":",y+=E,y+=`\r
`}),y}function Ks(h,y,E){e:{for(k in E){var k=!1;break e}k=!0}k||(E=_s(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):mt(h,y,E))}function It(h){Ye.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(It,Ye);var gd=/^https?$/i,Za=["POST","PUT"];r=It.prototype,r.Ha=function(h){this.J=h},r.ea=function(h,y,E,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Mn.g(),this.v=this.o?pr(this.o):pr(Mn),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(te){jo(this,te);return}if(h=E||"",E=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var G in k)E.set(G,k[G]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const te of k.keys())E.set(te,k.get(te));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(E.keys()).find(te=>te.toLowerCase()=="content-type"),G=u.FormData&&h instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Za,y,void 0))||k||G||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,me]of E)this.g.setRequestHeader(te,me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{bi(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){jo(this,te)}};function jo(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Pi(h),rr(h)}function Pi(h){h.A||(h.A=!0,ft(h,"complete"),ft(h,"error"))}r.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,ft(this,"complete"),ft(this,"abort"),rr(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rr(this,!0)),It.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Ja(this):this.bb())},r.bb=function(){Ja(this)};function Ja(h){if(h.h&&typeof l<"u"&&(!h.v[1]||Wn(h)!=4||h.Z()!=2)){if(h.u&&Wn(h)==4)ps(h.Ea,0,h);else if(ft(h,"readystatechange"),Wn(h)==4){h.h=!1;try{const me=h.Z();e:switch(me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var k;if(k=me===0){var G=String(h.D).match(Mo)[1]||null;!G&&u.self&&u.self.location&&(G=u.self.location.protocol.slice(0,-1)),k=!gd.test(G?G.toLowerCase():"")}E=k}if(E)ft(h,"complete"),ft(h,"success");else{h.m=6;try{var te=2<Wn(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",Pi(h)}}finally{rr(h)}}}}function rr(h,y){if(h.g){bi(h);const E=h.g,k=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||ft(h,"ready");try{E.onreadystatechange=k}catch{}}}function bi(h){h.I&&(u.clearTimeout(h.I),h.I=null)}r.isActive=function(){return!!this.g};function Wn(h){return h.g?h.g.readyState:0}r.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),ms(y)}};function el(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Di(h){const y={};h=(h.g&&2<=Wn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<h.length;k++){if(L(h[k]))continue;var E=b(h[k]);const G=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const te=y[G]||[];y[G]=te,te.push(E)}A(y,function(k){return k.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function tl(h){this.Aa=0,this.i=[],this.j=new At,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zr("baseRetryDelayMs",5e3,h),this.cb=Zr("retryDelaySeedMs",1e4,h),this.Wa=Zr("forwardChannelMaxRetries",2,h),this.wa=Zr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Vo(h&&h.concurrentRequestLimit),this.Da=new md,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=tl.prototype,r.la=8,r.G=1,r.connect=function(h,y,E,k){ut(0),this.W=h,this.H=y||{},E&&k!==void 0&&(this.H.OSID=E,this.H.OAID=k),this.F=this.X,this.I=$c(this,null,this.W),Jr(this)};function pn(h){if(Vi(h),h.G==3){var y=h.U++,E=nr(h.I);if(mt(E,"SID",h.K),mt(E,"RID",y),mt(E,"TYPE","terminate"),ws(h,E),y=new dn(h,h.j,y),y.L=2,y.v=Ws(nr(E)),E=!1,u.navigator&&u.navigator.sendBeacon)try{E=u.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&u.Image&&(new Image().src=y.v,E=!0),E||(y.g=qc(y.j,null),y.g.ea(y.v)),y.F=Date.now(),yt(y)}Uc(h)}function Mr(h){h.g&&(nl(h),h.g.cancel(),h.g=null)}function Vi(h){Mr(h),h.u&&(u.clearTimeout(h.u),h.u=null),Fi(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&u.clearTimeout(h.s),h.s=null)}function Jr(h){if(!tr(h.h)&&!h.s){h.s=!0;var y=h.Ga;ce||K(),Z||(ce(),Z=!0),ee.add(y,h),h.B=0}}function yd(h,y){return kc(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Qt(T(h.Ga,h,y),zc(h,h.B)),h.B++,!0)}r.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const G=new dn(this,this.j,h);let te=this.o;if(this.S&&(te?(te=I(te),P(te,this.S)):te=this.S),this.m!==null||this.O||(G.H=te,te=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var k=this.i[E];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(y+=k,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=Qs(this,G,y),E=nr(this.I),mt(E,"RID",h),mt(E,"CVER",22),this.D&&mt(E,"X-HTTP-Session-Id",this.D),ws(this,E),te&&(this.O?y="headers="+encodeURIComponent(String(_s(te)))+"&"+y:this.m&&Ks(E,this.m,te)),Xa(this.h,G),this.Ua&&mt(E,"TYPE","init"),this.P?(mt(E,"$req",y),mt(E,"SID","null"),G.T=!0,Ai(G,E,null)):Ai(G,E,y),this.G=2}}else this.G==3&&(h?Mi(this,h):this.i.length==0||tr(this.h)||Mi(this))};function Mi(h,y){var E;y?E=y.l:E=h.U++;const k=nr(h.I);mt(k,"SID",h.K),mt(k,"RID",E),mt(k,"AID",h.T),ws(h,k),h.m&&h.o&&Ks(k,h.m,h.o),E=new dn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=Qs(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Xa(h.h,E),Ai(E,k,y)}function ws(h,y){h.H&&B(h.H,function(E,k){mt(y,k,E)}),h.l&&Us({},function(E,k){mt(y,k,E)})}function Qs(h,y,E){E=Math.min(h.i.length,E);var k=h.l?T(h.l.Na,h.l,h):null;e:{var G=h.i;let te=-1;for(;;){const me=["count="+E];te==-1?0<E?(te=G[0].g,me.push("ofs="+te)):te=0:me.push("ofs="+te);let at=!0;for(let Xt=0;Xt<E;Xt++){let Je=G[Xt].g;const rn=G[Xt].map;if(Je-=te,0>Je)te=Math.max(0,G[Xt].g-100),at=!1;else try{jc(rn,me,"req"+Je+"_")}catch{k&&k(rn)}}if(at){k=me.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,k}function Lo(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;ce||K(),Z||(ce(),Z=!0),ee.add(y,h),h.v=0}}function Oi(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Qt(T(h.Fa,h),zc(h,h.v)),h.v++,!0)}r.Fa=function(){if(this.u=null,Bc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Qt(T(this.ab,this),h)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ut(10),Mr(this),Bc(this))};function nl(h){h.A!=null&&(u.clearTimeout(h.A),h.A=null)}function Bc(h){h.g=new dn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=nr(h.qa);mt(y,"RID","rpc"),mt(y,"SID",h.K),mt(y,"AID",h.T),mt(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&mt(y,"TO",h.ja),mt(y,"TYPE","xmlhttp"),ws(h,y),h.m&&h.o&&Ks(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=Ws(nr(y)),E.m=null,E.P=!0,Ka(E,h)}r.Za=function(){this.C!=null&&(this.C=null,Mr(this),Oi(this),ut(19))};function Fi(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function ji(h,y){var E=null;if(h.g==y){Fi(h),nl(h),h.g=null;var k=2}else if(On(h.h,y))E=y.D,Pc(h.h,y),k=1;else return;if(h.G!=0){if(y.o)if(k==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var G=h.B;k=Ze(),ft(k,new kr(k,E)),Jr(h)}else Lo(h);else if(G=y.s,G==3||G==0&&0<y.X||!(k==1&&yd(h,y)||k==2&&Oi(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),G){case 1:Es(h,5);break;case 4:Es(h,10);break;case 3:Es(h,6);break;default:Es(h,2)}}}function zc(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function Es(h,y){if(h.j.info("Error code "+y),y==2){var E=T(h.fb,h),k=h.Xa;const G=!k;k=new ys(k||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Oo(k,"https"),Ws(k),G?pd(k.toString(),E):Fc(k.toString(),E)}else ut(2);h.G=0,h.l&&h.l.sa(y),Uc(h),Vi(h)}r.fb=function(h){h?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function Uc(h){if(h.G=0,h.ka=[],h.l){const y=bc(h.h);(y.length!=0||h.i.length!=0)&&(V(h.ka,y),V(h.ka,h.i),h.h.i.length=0,D(h.i),h.i.length=0),h.l.ra()}}function $c(h,y,E){var k=E instanceof ys?nr(E):new ys(E);if(k.g!="")y&&(k.g=y+"."+k.g),$s(k,k.s);else{var G=u.location;k=G.protocol,y=y?y+"."+G.hostname:G.hostname,G=+G.port;var te=new ys(null);k&&Oo(te,k),y&&(te.g=y),G&&$s(te,G),E&&(te.l=E),k=te}return E=h.D,y=h.ya,E&&y&&mt(k,E,y),mt(k,"VER",h.la),ws(h,k),k}function qc(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new It(new vs({eb:E})):new It(h.pa),y.Ha(h.J),y}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function rl(){}r=rl.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Li(){}Li.prototype.g=function(h,y){return new Fn(h,y)};function Fn(h,y){Ye.call(this),this.g=new tl(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!L(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!L(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new es(this)}C(Fn,Ye),Fn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fn.prototype.close=function(){pn(this.g)},Fn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=Hr(h),h=E);y.i.push(new Rc(y.Ya++,h)),y.G==3&&Jr(y)},Fn.prototype.N=function(){this.g.l=null,delete this.j,pn(this.g),delete this.g,Fn.aa.N.call(this)};function Wc(h){$n.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}C(Wc,$n);function Gc(){Te.call(this),this.status=1}C(Gc,Te);function es(h){this.g=h}C(es,rl),es.prototype.ua=function(){ft(this.g,"a")},es.prototype.ta=function(h){ft(this.g,new Wc(h))},es.prototype.sa=function(h){ft(this.g,new Gc)},es.prototype.ra=function(){ft(this.g,"b")},Li.prototype.createWebChannel=Li.prototype.g,Fn.prototype.send=Fn.prototype.o,Fn.prototype.open=Fn.prototype.m,Fn.prototype.close=Fn.prototype.close,$0=function(){return new Li},U0=function(){return Ze()},z0=Ne,dp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},zt.NO_ERROR=0,zt.TIMEOUT=8,zt.HTTP_ERROR=6,Xu=zt,Qr.COMPLETE="complete",B0=Qr,Rr.EventType=hn,hn.OPEN="a",hn.CLOSE="b",hn.ERROR="c",hn.MESSAGE="d",Ye.prototype.listen=Ye.prototype.K,Dl=Rr,It.prototype.listenOnce=It.prototype.L,It.prototype.getLastError=It.prototype.Ka,It.prototype.getLastErrorCode=It.prototype.Ba,It.prototype.getStatus=It.prototype.Z,It.prototype.getResponseJson=It.prototype.Oa,It.prototype.getResponseText=It.prototype.oa,It.prototype.send=It.prototype.ea,It.prototype.setWithCredentials=It.prototype.Ha,L0=It}).apply(typeof Bu<"u"?Bu:typeof self<"u"?self:typeof window<"u"?window:{});const vv="@firebase/firestore",_v="4.7.9";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ja="11.4.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di=new R0("@firebase/firestore");function fa(){return di.logLevel}function ae(r,...e){if(di.logLevel<=tt.DEBUG){const t=e.map(Yp);di.debug(`Firestore (${ja}): ${r}`,...t)}}function Ft(r,...e){if(di.logLevel<=tt.ERROR){const t=e.map(Yp);di.error(`Firestore (${ja}): ${r}`,...t)}}function Gl(r,...e){if(di.logLevel<=tt.WARN){const t=e.map(Yp);di.warn(`Firestore (${ja}): ${r}`,...t)}}function Yp(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(r="Unexpected state"){const e=`FIRESTORE (${ja}) INTERNAL ASSERTION FAILED: `+r;throw Ft(e),new Error(e)}function be(r,e){r||Ae()}function ke(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Fx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(An.UNAUTHENTICATED))}shutdown(){}}class jx{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){be(this.o===void 0);let n=this.i;const o=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let a=new Io;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Io,e.enqueueRetryable(()=>o(this.currentUser))};const l=()=>{const d=a;e.enqueueRetryable(async()=>{await d.promise,await o(this.currentUser)})},u=d=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Io)}},0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(be(typeof n.accessToken=="string"),new Ox(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string"),new An(e)}}class Lx{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=An.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Bx{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Lx(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(An.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class zx{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,D0(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){be(this.o===void 0);const n=a=>{a.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.R;return this.R=a.token,ae("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const o=a=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>o(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?o(a):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new wv(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(be(typeof t.token=="string"),this.R=t.token,new wv(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const o=Ux(40);for(let a=0;a<o.length;++a)n.length<20&&o[a]<t&&(n+=e.charAt(o[a]%62))}return n}}function ze(r,e){return r<e?-1:r>e?1:0}function Ea(r,e,t){return r.length===e.length&&r.every((n,o)=>t(n,e[o]))}function W0(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev=-62135596800,Tv=1e6;class cn{static now(){return cn.fromMillis(Date.now())}static fromDate(e){return cn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Tv);return new cn(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Ev)throw new Ce(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tv}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Ev;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new cn(0,0))}static max(){return new Ve(new cn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="__name__";class os{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ae(),n===void 0?n=e.length-t:n>e.length-t&&Ae(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return os.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof os?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let o=0;o<n;o++){const a=os.compareSegments(e.get(o),t.get(o));if(a!==0)return a}return Math.sign(e.length-t.length)}static compareSegments(e,t){const n=os.isNumericId(e),o=os.isNumericId(t);return n&&!o?-1:!n&&o?1:n&&o?os.extractNumericId(e).compare(os.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return To.fromString(e.substring(4,e.length-2))}}class gt extends os{construct(e,t,n){return new gt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ce(oe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(o=>o.length>0))}return new gt(t)}static emptyPath(){return new gt([])}}const $x=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jt extends os{construct(e,t,n){return new jt(e,t,n)}static isValidIdentifier(e){return $x.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Iv}static keyField(){return new jt([Iv])}static fromServerFormat(e){const t=[];let n="",o=0;const a=()=>{if(n.length===0)throw new Ce(oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;o<e.length;){const u=e[o];if(u==="\\"){if(o+1===e.length)throw new Ce(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ce(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,o+=2}else u==="`"?(l=!l,o++):u!=="."||l?(n+=u,o++):(a(),o++)}if(a(),l)throw new Ce(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jt(t)}static emptyPath(){return new jt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(gt.fromString(e))}static fromName(e){return new _e(gt.fromString(e).popFirst(5))}static empty(){return new _e(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return gt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new gt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta=-1;class hh{constructor(e,t,n,o){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=o}}function fp(r){return r.fields.find(e=>e.kind===2)}function ni(r){return r.fields.filter(e=>e.kind!==2)}hh.UNKNOWN_ID=-1;class Yu{constructor(e,t){this.fieldPath=e,this.kind=t}}class Hl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Hl(0,dr.min())}}function G0(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,o=Ve.fromTimestamp(n===1e9?new cn(t+1,0):new cn(t,n));return new dr(o,_e.empty(),e)}function H0(r){return new dr(r.readTime,r.key,Ta)}class dr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new dr(Ve.min(),_e.empty(),Ta)}static max(){return new dr(Ve.max(),_e.empty(),Ta)}}function Zp(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=_e.comparator(r.documentKey,e.documentKey),t!==0?t:ze(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Q0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(r){if(r.code!==oe.FAILED_PRECONDITION||r.message!==K0)throw r;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new W((n,o)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,o)},this.catchCallback=a=>{this.wrapFailure(t,a).next(n,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof W?t:W.resolve(t)}catch(t){return W.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):W.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):W.reject(t)}static resolve(e){return new W((t,n)=>{t(e)})}static reject(e){return new W((t,n)=>{n(e)})}static waitFor(e){return new W((t,n)=>{let o=0,a=0,l=!1;e.forEach(u=>{++o,u.next(()=>{++a,l&&a===o&&t()},d=>n(d))}),l=!0,a===o&&t()})}static or(e){let t=W.resolve(!1);for(const n of e)t=t.next(o=>o?W.resolve(o):n());return t}static forEach(e,t){const n=[];return e.forEach((o,a)=>{n.push(t.call(this,o,a))}),this.waitFor(n)}static mapArray(e,t){return new W((n,o)=>{const a=e.length,l=new Array(a);let u=0;for(let d=0;d<a;d++){const p=d;t(e[p]).next(g=>{l[p]=g,++u,u===a&&n(l)},g=>o(g))}})}static doWhile(e,t){return new W((n,o)=>{const a=()=>{e()===!0?t().next(()=>{a()},o):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lr="SimpleDb";class zh{static open(e,t,n,o){try{return new zh(t,e.transaction(o,n))}catch(a){throw new Fl(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new Io,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new Fl(e,t.error)):this.m.resolve()},this.transaction.onerror=n=>{const o=Jp(n.target.error);this.m.reject(new Fl(e,o))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(ae(lr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Wx(t)}}class So{static delete(e){return ae(lr,"Removing database:",e),si(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!C0())return!1;if(So.v())return!0;const e=lh(),t=So.C(e),n=0<t&&t<10,o=X0(e),a=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static C(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,So.C(lh())===12.2&&Ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(e){return this.db||(ae(lr,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const o=indexedDB.open(this.name,this.version);o.onsuccess=a=>{const l=a.target.result;t(l)},o.onblocked=()=>{n(new Fl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=a=>{const l=a.target.error;l.name==="VersionError"?n(new Ce(oe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?n(new Ce(oe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):n(new Fl(e,l))},o.onupgradeneeded=a=>{ae(lr,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.O.B(l,o.transaction,a.oldVersion,this.version).next(()=>{ae(lr,"Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,o){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.N(e);const u=zh.open(this.db,e,a?"readonly":"readwrite",n),d=o(u).next(p=>(u.S(),p)).catch(p=>(u.abort(p),W.reject(p))).toPromise();return d.catch(()=>{}),await u.p,d}catch(u){const d=u,p=d.name!=="FirebaseError"&&l<3;if(ae(lr,"Transaction failed with error:",d.message,"Retrying:",p),this.close(),!p)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function X0(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class qx{constructor(e){this.q=e,this.$=!1,this.K=null}get isDone(){return this.$}get U(){return this.K}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.K=e}delete(){return si(this.q.delete())}}class Fl extends Ce{constructor(e,t){super(oe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ko(r){return r.name==="IndexedDbTransactionError"}class Wx{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(ae(lr,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(ae(lr,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),si(n)}add(e){return ae(lr,"ADD",this.store.name,e,e),si(this.store.add(e))}get(e){return si(this.store.get(e)).next(t=>(t===void 0&&(t=null),ae(lr,"GET",this.store.name,e,t),t))}delete(e){return ae(lr,"DELETE",this.store.name,e),si(this.store.delete(e))}count(){return ae(lr,"COUNT",this.store.name),si(this.store.count())}G(e,t){const n=this.options(e,t),o=n.index?this.store.index(n.index):this.store;if(typeof o.getAll=="function"){const a=o.getAll(n.range);return new W((l,u)=>{a.onerror=d=>{u(d.target.error)},a.onsuccess=d=>{l(d.target.result)}})}{const a=this.cursor(n),l=[];return this.j(a,(u,d)=>{l.push(d)}).next(()=>l)}}H(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new W((o,a)=>{n.onerror=l=>{a(l.target.error)},n.onsuccess=l=>{o(l.target.result)}})}J(e,t){ae(lr,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const o=this.cursor(n);return this.j(o,(a,l,u)=>u.delete())}Z(e,t){let n;t?n=e:(n={},t=e);const o=this.cursor(n);return this.j(o,t)}X(e){const t=this.cursor({});return new W((n,o)=>{t.onerror=a=>{const l=Jp(a.target.error);o(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(u=>{u?l.continue():n()}):n()}})}j(e,t){const n=[];return new W((o,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void o();const d=new qx(u),p=t(u.primaryKey,u.value,d);if(p instanceof W){const g=p.catch(v=>(d.done(),W.reject(v)));n.push(g)}d.isDone?o():d.U===null?u.continue():u.continue(d.U)}}).next(()=>W.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function si(r){return new W((e,t)=>{r.onsuccess=n=>{const o=n.target.result;e(o)},r.onerror=n=>{const o=Jp(n.target.error);t(o)}})}let Sv=!1;function Jp(r){const e=So.C(lh());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Sv||(Sv=!0,setTimeout(()=>{throw n},0)),n}}return r}const jl="IndexBackfiller";class Gx{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){ae(jl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ee.ne();ae(jl,`Documents written: ${t}`)}catch(t){ko(t)?ae(jl,"Ignoring IndexedDB error during index backfill: ",t):await Ro(t)}await this.te(6e4)})}}class Hx{constructor(e,t){this.localStore=e,this.persistence=t}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.re(t,e))}re(e,t){const n=new Set;let o=t,a=!0;return W.doWhile(()=>a===!0&&o>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(l!==null&&!n.has(l))return ae(jl,`Processing collection: ${l}`),this.ie(e,l,o).next(u=>{o-=u,n.add(l)});a=!1})).next(()=>t-o)}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(o=>this.localStore.localDocuments.getNextDocuments(e,t,o,n).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.se(o,a)).next(u=>(ae(jl,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u))).next(()=>l.size)}))}se(e,t){let n=e;return t.changes.forEach((o,a)=>{const l=H0(a);Zp(l,n)>0&&(n=l)}),new dr(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Jn.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=-1;function Uh(r){return r==null}function Kl(r){return r===0&&1/r==-1/0}function Kx(r){return typeof r=="number"&&Number.isInteger(r)&&!Kl(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh="";function Rn(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=xv(e)),e=Qx(r.get(t),e);return xv(e)}function Qx(r,e){let t=e;const n=r.length;for(let o=0;o<n;o++){const a=r.charAt(o);switch(a){case"\0":t+="";break;case dh:t+="";break;default:t+=a}}return t}function xv(r){return r+dh+""}function as(r){const e=r.length;if(be(e>=2),e===2)return be(r.charAt(0)===dh&&r.charAt(1)===""),gt.emptyPath();const t=e-2,n=[];let o="";for(let a=0;a<e;){const l=r.indexOf(dh,a);switch((l<0||l>t)&&Ae(),r.charAt(l+1)){case"":const u=r.substring(a,l);let d;o.length===0?d=u:(o+=u,d=o,o=""),n.push(d);break;case"":o+=r.substring(a,l),o+="\0";break;case"":o+=r.substring(a,l+1);break;default:Ae()}a=l+2}return new gt(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ri="remoteDocuments",cc="owner",aa="owner",Ql="mutationQueues",Xx="userId",Ur="mutations",Cv="batchId",li="userMutationsIndex",Av=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(r,e){return[r,Rn(e)]}function Y0(r,e,t){return[r,Rn(e),t]}const Yx={},Ia="documentMutations",fh="remoteDocumentsV14",Zx=["prefixPath","collectionGroup","readTime","documentId"],Ju="documentKeyIndex",Jx=["prefixPath","collectionGroup","documentId"],Z0="collectionGroupIndex",eC=["collectionGroup","readTime","prefixPath","documentId"],Xl="remoteDocumentGlobal",pp="remoteDocumentGlobalKey",Sa="targets",J0="queryTargetsIndex",tC=["canonicalId","targetId"],xa="targetDocuments",nC=["targetId","path"],em="documentTargetsIndex",rC=["path","targetId"],ph="targetGlobalKey",ui="targetGlobal",Yl="collectionParents",sC=["collectionId","parent"],Ca="clientMetadata",oC="clientId",$h="bundles",iC="bundleId",qh="namedQueries",aC="name",tm="indexConfiguration",lC="indexId",mp="collectionGroupIndex",cC="collectionGroup",mh="indexState",uC=["indexId","uid"],ew="sequenceNumberIndex",hC=["uid","sequenceNumber"],gh="indexEntries",dC=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],tw="documentKeyIndex",fC=["indexId","uid","orderedDocumentKey"],Wh="documentOverlays",pC=["userId","collectionPath","documentId"],gp="collectionPathOverlayIndex",mC=["userId","collectionPath","largestBatchId"],nw="collectionGroupOverlayIndex",gC=["userId","collectionGroup","largestBatchId"],nm="globals",yC="name",rw=[Ql,Ur,Ia,ri,Sa,cc,ui,xa,Ca,Xl,Yl,$h,qh],vC=[...rw,Wh],sw=[Ql,Ur,Ia,fh,Sa,cc,ui,xa,Ca,Xl,Yl,$h,qh,Wh],ow=sw,rm=[...ow,tm,mh,gh],_C=rm,wC=[...rm,nm];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp extends Q0{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function Jt(r,e){const t=ke(r);return So.M(t.ue,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function uc(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function EC(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,t){this.comparator=e,this.root=t||vn.EMPTY}insert(e,t){return new Et(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,vn.BLACK,null,null))}remove(e){return new Et(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return t+n.left.size;o<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zu(this.root,e,this.comparator,!1)}getReverseIterator(){return new zu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zu(this.root,e,this.comparator,!0)}}class zu{constructor(e,t,n,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&o&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vn{constructor(e,t,n,o,a){this.key=e,this.value=t,this.color=n??vn.RED,this.left=o??vn.EMPTY,this.right=a??vn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,o,a){return new vn(e??this.key,t??this.value,n??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let o=this;const a=n(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,t,n),null):a===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,n)),o.fixUp()}removeMin(){if(this.left.isEmpty())return vn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return vn.EMPTY;n=o.right.min(),o=o.copy(n.key,n.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ae();const e=this.left.check();if(e!==this.right.check())throw Ae();return e+(this.isRed()?0:1)}}vn.EMPTY=null,vn.RED=!0,vn.BLACK=!1;vn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae()}get value(){throw Ae()}get color(){throw Ae()}get left(){throw Ae()}get right(){throw Ae()}copy(e,t,n,o,a){return this}insert(e,t,n){return new vn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.comparator=e,this.data=new Et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const o=n.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Rv(this.data.getIterator())}getIteratorFrom(e){return new Rv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof lt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=n.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new lt(this.comparator);return t.data=e,t}}class Rv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function la(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this.fields=e,e.sort(jt.comparator)}static empty(){return new Ps([])}unionWith(e){let t=new lt(jt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ps(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ea(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new iw("Invalid base64 string: "+a):a}}(e);return new Lt(t)}static fromUint8Array(e){const t=function(o){let a="";for(let l=0;l<o.length;++l)a+=String.fromCharCode(o[l]);return a}(e);return new Lt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let o=0;o<t.length;o++)n[o]=t.charCodeAt(o);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lt.EMPTY_BYTE_STRING=new Lt("");const TC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Os(r){if(be(!!r),typeof r=="string"){let e=0;const t=TC.exec(r);if(be(!!t),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:xt(r.seconds),nanos:xt(r.nanos)}}function xt(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Fs(r){return typeof r=="string"?Lt.fromBase64String(r):Lt.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw="server_timestamp",lw="__type__",cw="__previous_value__",uw="__local_write_time__";function sm(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[lw])===null||t===void 0?void 0:t.stringValue)===aw}function Gh(r){const e=r.mapValue.fields[cw];return sm(e)?Gh(e):e}function Zl(r){const e=Os(r.mapValue.fields[uw].timestampValue);return new cn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e,t,n,o,a,l,u,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=o,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=p}}const yh="(default)";class fi{constructor(e,t){this.projectId=e,this.database=t||yh}static empty(){return new fi("","")}get isDefaultDatabase(){return this.database===yh}isEqual(e){return e instanceof fi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw="__type__",dw="__max__",vo={mapValue:{fields:{__type__:{stringValue:dw}}}},fw="__vector__",Jl="value",eh={nullValue:"NULL_VALUE"};function xo(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?sm(r)?4:pw(r)?9007199254740991:Hh(r)?10:11:Ae()}function cs(r,e){if(r===e)return!0;const t=xo(r);if(t!==xo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Zl(r).isEqual(Zl(e));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const l=Os(o.timestampValue),u=Os(a.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(o,a){return Fs(o.bytesValue).isEqual(Fs(a.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(o,a){return xt(o.geoPointValue.latitude)===xt(a.geoPointValue.latitude)&&xt(o.geoPointValue.longitude)===xt(a.geoPointValue.longitude)}(r,e);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return xt(o.integerValue)===xt(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const l=xt(o.doubleValue),u=xt(a.doubleValue);return l===u?Kl(l)===Kl(u):isNaN(l)&&isNaN(u)}return!1}(r,e);case 9:return Ea(r.arrayValue.values||[],e.arrayValue.values||[],cs);case 10:case 11:return function(o,a){const l=o.mapValue.fields||{},u=a.mapValue.fields||{};if(Nv(l)!==Nv(u))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(u[d]===void 0||!cs(l[d],u[d])))return!1;return!0}(r,e);default:return Ae()}}function ec(r,e){return(r.values||[]).find(t=>cs(t,e))!==void 0}function Co(r,e){if(r===e)return 0;const t=xo(r),n=xo(e);if(t!==n)return ze(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return ze(r.booleanValue,e.booleanValue);case 2:return function(a,l){const u=xt(a.integerValue||a.doubleValue),d=xt(l.integerValue||l.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(r,e);case 3:return kv(r.timestampValue,e.timestampValue);case 4:return kv(Zl(r),Zl(e));case 5:return ze(r.stringValue,e.stringValue);case 6:return function(a,l){const u=Fs(a),d=Fs(l);return u.compareTo(d)}(r.bytesValue,e.bytesValue);case 7:return function(a,l){const u=a.split("/"),d=l.split("/");for(let p=0;p<u.length&&p<d.length;p++){const g=ze(u[p],d[p]);if(g!==0)return g}return ze(u.length,d.length)}(r.referenceValue,e.referenceValue);case 8:return function(a,l){const u=ze(xt(a.latitude),xt(l.latitude));return u!==0?u:ze(xt(a.longitude),xt(l.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Pv(r.arrayValue,e.arrayValue);case 10:return function(a,l){var u,d,p,g;const v=a.fields||{},T=l.fields||{},S=(u=v[Jl])===null||u===void 0?void 0:u.arrayValue,C=(d=T[Jl])===null||d===void 0?void 0:d.arrayValue,D=ze(((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0,((g=C==null?void 0:C.values)===null||g===void 0?void 0:g.length)||0);return D!==0?D:Pv(S,C)}(r.mapValue,e.mapValue);case 11:return function(a,l){if(a===vo.mapValue&&l===vo.mapValue)return 0;if(a===vo.mapValue)return 1;if(l===vo.mapValue)return-1;const u=a.fields||{},d=Object.keys(u),p=l.fields||{},g=Object.keys(p);d.sort(),g.sort();for(let v=0;v<d.length&&v<g.length;++v){const T=ze(d[v],g[v]);if(T!==0)return T;const S=Co(u[d[v]],p[g[v]]);if(S!==0)return S}return ze(d.length,g.length)}(r.mapValue,e.mapValue);default:throw Ae()}}function kv(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return ze(r,e);const t=Os(r),n=Os(e),o=ze(t.seconds,n.seconds);return o!==0?o:ze(t.nanos,n.nanos)}function Pv(r,e){const t=r.values||[],n=e.values||[];for(let o=0;o<t.length&&o<n.length;++o){const a=Co(t[o],n[o]);if(a)return a}return ze(t.length,n.length)}function Aa(r){return vp(r)}function vp(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Os(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Fs(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return _e.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",o=!0;for(const a of t.values||[])o?o=!1:n+=",",n+=vp(a);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let o="{",a=!0;for(const l of n)a?a=!1:o+=",",o+=`${l}:${vp(t.fields[l])}`;return o+"}"}(r.mapValue):Ae()}function th(r){switch(xo(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Gh(r);return e?16+th(e):16;case 5:return 2*r.stringValue.length;case 6:return Fs(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((o,a)=>o+th(a),0)}(r.arrayValue);case 10:case 11:return function(n){let o=0;return uc(n.fields,(a,l)=>{o+=a.length+th(l)}),o}(r.mapValue);default:throw Ae()}}function om(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function _p(r){return!!r&&"integerValue"in r}function tc(r){return!!r&&"arrayValue"in r}function bv(r){return!!r&&"nullValue"in r}function Dv(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Hf(r){return!!r&&"mapValue"in r}function Hh(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[hw])===null||t===void 0?void 0:t.stringValue)===fw}function Ll(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return uc(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ll(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ll(r.arrayValue.values[t]);return e}return Object.assign({},r)}function pw(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===dw}const mw={mapValue:{fields:{[hw]:{stringValue:fw},[Jl]:{arrayValue:{}}}}};function SC(r){return"nullValue"in r?eh:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?om(fi.empty(),_e.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?Hh(r)?mw:{mapValue:{}}:Ae()}function xC(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?om(fi.empty(),_e.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?mw:"mapValue"in r?Hh(r)?{mapValue:{}}:vo:Ae()}function Vv(r,e){const t=Co(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function Mv(r,e){const t=Co(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this.value=e}static empty(){return new Cr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Hf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ll(t)}setAll(e){let t=jt.emptyPath(),n={},o=[];e.forEach((l,u)=>{if(!t.isImmediateParentOf(u)){const d=this.getFieldsMap(t);this.applyChanges(d,n,o),n={},o=[],t=u.popLast()}l?n[u.lastSegment()]=Ll(l):o.push(u.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,o)}delete(e){const t=this.field(e.popLast());Hf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let o=t.mapValue.fields[e.get(n)];Hf(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,n){uc(t,(o,a)=>e[o]=a);for(const o of n)delete e[o]}clone(){return new Cr(Ll(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,t,n,o,a,l,u){this.key=e,this.documentType=t,this.version=n,this.readTime=o,this.createTime=a,this.data=l,this.documentState=u}static newInvalidDocument(e){return new bt(e,0,Ve.min(),Ve.min(),Ve.min(),Cr.empty(),0)}static newFoundDocument(e,t,n,o){return new bt(e,1,t,Ve.min(),n,o,0)}static newNoDocument(e,t){return new bt(e,2,t,Ve.min(),Ve.min(),Cr.empty(),0)}static newUnknownDocument(e,t){return new bt(e,3,t,Ve.min(),Ve.min(),Cr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,t){this.position=e,this.inclusive=t}}function Ov(r,e,t){let n=0;for(let o=0;o<r.position.length;o++){const a=e[o],l=r.position[o];if(a.field.isKeyField()?n=_e.comparator(_e.fromName(l.referenceValue),t.key):n=Co(l,t.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function Fv(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!cs(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,t="asc"){this.field=e,this.dir=t}}function CC(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{}class Ke extends gw{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new AC(e,t,n):t==="array-contains"?new kC(e,n):t==="in"?new Tw(e,n):t==="not-in"?new PC(e,n):t==="array-contains-any"?new bC(e,n):new Ke(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new NC(e,n):new RC(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Co(t,this.value)):t!==null&&xo(this.value)===xo(t)&&this.matchesComparison(Co(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends gw{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new ht(e,t)}matches(e){return Ra(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function Ra(r){return r.op==="and"}function wp(r){return r.op==="or"}function im(r){return yw(r)&&Ra(r)}function yw(r){for(const e of r.filters)if(e instanceof ht)return!1;return!0}function Ep(r){if(r instanceof Ke)return r.field.canonicalString()+r.op.toString()+Aa(r.value);if(im(r))return r.filters.map(e=>Ep(e)).join(",");{const e=r.filters.map(t=>Ep(t)).join(",");return`${r.op}(${e})`}}function vw(r,e){return r instanceof Ke?function(n,o){return o instanceof Ke&&n.op===o.op&&n.field.isEqual(o.field)&&cs(n.value,o.value)}(r,e):r instanceof ht?function(n,o){return o instanceof ht&&n.op===o.op&&n.filters.length===o.filters.length?n.filters.reduce((a,l,u)=>a&&vw(l,o.filters[u]),!0):!1}(r,e):void Ae()}function _w(r,e){const t=r.filters.concat(e);return ht.create(t,r.op)}function ww(r){return r instanceof Ke?function(t){return`${t.field.canonicalString()} ${t.op} ${Aa(t.value)}`}(r):r instanceof ht?function(t){return t.op.toString()+" {"+t.getFilters().map(ww).join(" ,")+"}"}(r):"Filter"}class AC extends Ke{constructor(e,t,n){super(e,t,n),this.key=_e.fromName(n.referenceValue)}matches(e){const t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}class NC extends Ke{constructor(e,t){super(e,"in",t),this.keys=Ew("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class RC extends Ke{constructor(e,t){super(e,"not-in",t),this.keys=Ew("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Ew(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>_e.fromName(n.referenceValue))}class kC extends Ke{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tc(t)&&ec(t.arrayValue,this.value)}}class Tw extends Ke{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ec(this.value.arrayValue,t)}}class PC extends Ke{constructor(e,t){super(e,"not-in",t)}matches(e){if(ec(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!ec(this.value.arrayValue,t)}}class bC extends Ke{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>ec(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,t=null,n=[],o=[],a=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=o,this.limit=a,this.startAt=l,this.endAt=u,this.le=null}}function Tp(r,e=null,t=[],n=[],o=null,a=null,l=null){return new DC(r,e,t,n,o,a,l)}function pi(r){const e=ke(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>Ep(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Uh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Aa(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Aa(n)).join(",")),e.le=t}return e.le}function hc(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!CC(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!vw(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!Fv(r.startAt,e.startAt)&&Fv(r.endAt,e.endAt)}function _h(r){return _e.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function wh(r,e){return r.filters.filter(t=>t instanceof Ke&&t.field.isEqual(e))}function jv(r,e,t){let n=eh,o=!0;for(const a of wh(r,e)){let l=eh,u=!0;switch(a.op){case"<":case"<=":l=SC(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,u=!1;break;case"!=":case"not-in":l=eh}Vv({value:n,inclusive:o},{value:l,inclusive:u})<0&&(n=l,o=u)}if(t!==null){for(let a=0;a<r.orderBy.length;++a)if(r.orderBy[a].field.isEqual(e)){const l=t.position[a];Vv({value:n,inclusive:o},{value:l,inclusive:t.inclusive})<0&&(n=l,o=t.inclusive);break}}return{value:n,inclusive:o}}function Lv(r,e,t){let n=vo,o=!0;for(const a of wh(r,e)){let l=vo,u=!0;switch(a.op){case">=":case">":l=xC(a.value),u=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,u=!1;break;case"!=":case"not-in":l=vo}Mv({value:n,inclusive:o},{value:l,inclusive:u})>0&&(n=l,o=u)}if(t!==null){for(let a=0;a<r.orderBy.length;++a)if(r.orderBy[a].field.isEqual(e)){const l=t.position[a];Mv({value:n,inclusive:o},{value:l,inclusive:t.inclusive})>0&&(n=l,o=t.inclusive);break}}return{value:n,inclusive:o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,t=null,n=[],o=[],a=null,l="F",u=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=o,this.limit=a,this.limitType=l,this.startAt=u,this.endAt=d,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Iw(r,e,t,n,o,a,l,u){return new Kh(r,e,t,n,o,a,l,u)}function Qh(r){return new Kh(r)}function Bv(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function VC(r){return r.collectionGroup!==null}function Bl(r){const e=ke(r);if(e.he===null){e.he=[];const t=new Set;for(const a of e.explicitOrderBy)e.he.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new lt(jt.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(u=u.add(p.field))})}),u})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.he.push(new vh(a,n))}),t.has(jt.keyField().canonicalString())||e.he.push(new vh(jt.keyField(),n))}return e.he}function hr(r){const e=ke(r);return e.Pe||(e.Pe=MC(e,Bl(r))),e.Pe}function MC(r,e){if(r.limitType==="F")return Tp(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(o=>{const a=o.dir==="desc"?"asc":"desc";return new vh(o.field,a)});const t=r.endAt?new Na(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Na(r.startAt.position,r.startAt.inclusive):null;return Tp(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Ip(r,e,t){return new Kh(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Xh(r,e){return hc(hr(r),hr(e))&&r.limitType===e.limitType}function Sw(r){return`${pi(hr(r))}|lt:${r.limitType}`}function pa(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(o=>ww(o)).join(", ")}]`),Uh(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(o=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(o)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(o=>Aa(o)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(o=>Aa(o)).join(",")),`Target(${n})`}(hr(r))}; limitType=${r.limitType})`}function dc(r,e){return e.isFoundDocument()&&function(n,o){const a=o.key.path;return n.collectionGroup!==null?o.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):_e.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(r,e)&&function(n,o){for(const a of Bl(n))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(r,e)&&function(n,o){for(const a of n.filters)if(!a.matches(o))return!1;return!0}(r,e)&&function(n,o){return!(n.startAt&&!function(l,u,d){const p=Ov(l,u,d);return l.inclusive?p<=0:p<0}(n.startAt,Bl(n),o)||n.endAt&&!function(l,u,d){const p=Ov(l,u,d);return l.inclusive?p>=0:p>0}(n.endAt,Bl(n),o))}(r,e)}function xw(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Cw(r){return(e,t)=>{let n=!1;for(const o of Bl(r)){const a=OC(o,e,t);if(a!==0)return a;n=n||o.field.isKeyField()}return 0}}function OC(r,e,t){const n=r.field.isKeyField()?_e.comparator(e.key,t.key):function(a,l,u){const d=l.data.field(a),p=u.data.field(a);return d!==null&&p!==null?Co(d,p):Ae()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[o,a]of n)if(this.equalsFn(o,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return void(o[a]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let o=0;o<n.length;o++)if(this.equalsFn(n[o][0],e))return n.length===1?delete this.inner[t]:n.splice(o,1),this.innerSize--,!0;return!1}forEach(e){uc(this.inner,(t,n)=>{for(const[o,a]of n)e(o,a)})}isEmpty(){return EC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC=new Et(_e.comparator);function Ar(){return FC}const Aw=new Et(_e.comparator);function Vl(...r){let e=Aw;for(const t of r)e=e.insert(t.key,t);return e}function jC(r){let e=Aw;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function ls(){return zl()}function Nw(){return zl()}function zl(){return new js(r=>r.toString(),(r,e)=>r.isEqual(e))}const LC=new Et(_e.comparator),BC=new lt(_e.comparator);function Ge(...r){let e=BC;for(const t of r)e=e.add(t);return e}const zC=new lt(ze);function am(){return zC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kl(e)?"-0":e}}function $C(r){return{integerValue:""+r}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(){this._=void 0}}function qC(r,e,t){return r instanceof nc?function(o,a){const l={fields:{[lw]:{stringValue:aw},[uw]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&sm(a)&&(a=Gh(a)),a&&(l.fields[cw]=a),{mapValue:l}}(t,e):r instanceof ka?Rw(r,e):r instanceof Pa?kw(r,e):function(o,a){const l=GC(o,a),u=zv(l)+zv(o.Ie);return _p(l)&&_p(o.Ie)?$C(u):UC(o.serializer,u)}(r,e)}function WC(r,e,t){return r instanceof ka?Rw(r,e):r instanceof Pa?kw(r,e):t}function GC(r,e){return r instanceof rc?function(n){return _p(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class nc extends Yh{}class ka extends Yh{constructor(e){super(),this.elements=e}}function Rw(r,e){const t=Pw(e);for(const n of r.elements)t.some(o=>cs(o,n))||t.push(n);return{arrayValue:{values:t}}}class Pa extends Yh{constructor(e){super(),this.elements=e}}function kw(r,e){let t=Pw(e);for(const n of r.elements)t=t.filter(o=>!cs(o,n));return{arrayValue:{values:t}}}class rc extends Yh{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function zv(r){return xt(r.integerValue||r.doubleValue)}function Pw(r){return tc(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e,t){this.field=e,this.transform=t}}function KC(r,e){return r.field.isEqual(e.field)&&function(n,o){return n instanceof ka&&o instanceof ka||n instanceof Pa&&o instanceof Pa?Ea(n.elements,o.elements,cs):n instanceof rc&&o instanceof rc?cs(n.Ie,o.Ie):n instanceof nc&&o instanceof nc}(r.transform,e.transform)}class QC{constructor(e,t){this.version=e,this.transformResults=t}}class $r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $r}static exists(e){return new $r(void 0,e)}static updateTime(e){return new $r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nh(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Zh{}function bw(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new lm(r.key,$r.none()):new fc(r.key,r.data,$r.none());{const t=r.data,n=Cr.empty();let o=new lt(jt.comparator);for(let a of e.fields)if(!o.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?n.delete(a):n.set(a,l),o=o.add(a)}return new La(r.key,n,new Ps(o.toArray()),$r.none())}}function XC(r,e,t){r instanceof fc?function(o,a,l){const u=o.value.clone(),d=$v(o.fieldTransforms,a,l.transformResults);u.setAll(d),a.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(r,e,t):r instanceof La?function(o,a,l){if(!nh(o.precondition,a))return void a.convertToUnknownDocument(l.version);const u=$v(o.fieldTransforms,a,l.transformResults),d=a.data;d.setAll(Dw(o)),d.setAll(u),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(r,e,t):function(o,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,t)}function Ul(r,e,t,n){return r instanceof fc?function(a,l,u,d){if(!nh(a.precondition,l))return u;const p=a.value.clone(),g=qv(a.fieldTransforms,d,l);return p.setAll(g),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null}(r,e,t,n):r instanceof La?function(a,l,u,d){if(!nh(a.precondition,l))return u;const p=qv(a.fieldTransforms,d,l),g=l.data;return g.setAll(Dw(a)),g.setAll(p),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),u===null?null:u.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(v=>v.field))}(r,e,t,n):function(a,l,u){return nh(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u}(r,e,t)}function Uv(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,o){return n===void 0&&o===void 0||!(!n||!o)&&Ea(n,o,(a,l)=>KC(a,l))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class fc extends Zh{constructor(e,t,n,o=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class La extends Zh{constructor(e,t,n,o,a=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Dw(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function $v(r,e,t){const n=new Map;be(r.length===t.length);for(let o=0;o<t.length;o++){const a=r[o],l=a.transform,u=e.data.field(a.field);n.set(a.field,WC(l,u,t[o]))}return n}function qv(r,e,t){const n=new Map;for(const o of r){const a=o.transform,l=t.data.field(o.field);n.set(o.field,qC(a,l,e))}return n}class lm extends Zh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Vw extends Zh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e,t,n,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=o}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(e.key)&&XC(a,e,n[o])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ul(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ul(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Nw();return this.mutations.forEach(o=>{const a=e.get(o.key),l=a.overlayedDocument;let u=this.applyToLocalView(l,a.mutatedFields);u=t.has(o.key)?null:u;const d=bw(l,u);d!==null&&n.set(o.key,d),l.isValidDocument()||l.convertToNoDocument(Ve.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ge())}isEqual(e){return this.batchId===e.batchId&&Ea(this.mutations,e.mutations,(t,n)=>Uv(t,n))&&Ea(this.baseMutations,e.baseMutations,(t,n)=>Uv(t,n))}}class um{constructor(e,t,n,o){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=o}static from(e,t,n){be(e.mutations.length===n.length);let o=function(){return LC}();const a=e.mutations;for(let l=0;l<a.length;l++)o=o.insert(a[l].key,n[l].version);return new um(e,t,n,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,et;function ZC(r){switch(r){case oe.OK:return Ae();case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0;default:return Ae()}}function Mw(r){if(r===void 0)return Ft("GRPC error has no .code"),oe.UNKNOWN;switch(r){case qt.OK:return oe.OK;case qt.CANCELLED:return oe.CANCELLED;case qt.UNKNOWN:return oe.UNKNOWN;case qt.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case qt.INTERNAL:return oe.INTERNAL;case qt.UNAVAILABLE:return oe.UNAVAILABLE;case qt.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case qt.NOT_FOUND:return oe.NOT_FOUND;case qt.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case qt.ABORTED:return oe.ABORTED;case qt.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case qt.DATA_LOSS:return oe.DATA_LOSS;default:return Ae()}}(et=qt||(qt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA=new To([4294967295,4294967295],0);function Wv(r){const e=JC().encode(r),t=new j0;return t.update(e),new Uint8Array(t.digest())}function Gv(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),o=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new To([t,n],0),new To([o,a],0)]}class dm{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ml(`Invalid padding: ${t}`);if(n<0)throw new Ml(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ml(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ml(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=To.fromNumber(this.Ee)}Ae(e,t,n){let o=e.add(t.multiply(To.fromNumber(n)));return o.compare(eA)===1&&(o=new To([o.getBits(0),o.getBits(1)],0)),o.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=Wv(e),[n,o]=Gv(t);for(let a=0;a<this.hashCount;a++){const l=this.Ae(n,o,a);if(!this.Re(l))return!1}return!0}static create(e,t,n){const o=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new dm(a,o,t);return n.forEach(u=>l.insert(u)),l}insert(e){if(this.Ee===0)return;const t=Wv(e),[n,o]=Gv(t);for(let a=0;a<this.hashCount;a++){const l=this.Ae(n,o,a);this.Ve(l)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ml extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,t,n,o,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const o=new Map;return o.set(e,mc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new pc(Ve.min(),o,new Et(ze),Ar(),Ge())}}class mc{constructor(e,t,n,o,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new mc(n,t,Ge(),Ge(),Ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t,n,o){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=o}}class Ow{constructor(e,t){this.targetId=e,this.ge=t}}class Fw{constructor(e,t,n=Lt.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=o}}class Hv{constructor(){this.pe=0,this.ye=Kv(),this.we=Lt.EMPTY_BYTE_STRING,this.be=!1,this.Se=!0}get current(){return this.be}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.we=e)}Fe(){let e=Ge(),t=Ge(),n=Ge();return this.ye.forEach((o,a)=>{switch(a){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:n=n.add(o);break;default:Ae()}}),new mc(this.we,this.be,e,t,n)}Me(){this.Se=!1,this.ye=Kv()}xe(e,t){this.Se=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.Se=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,be(this.pe>=0)}Le(){this.Se=!0,this.be=!0}}class tA{constructor(e){this.ke=e,this.qe=new Map,this.Qe=Ar(),this.$e=Uu(),this.Ke=Uu(),this.Ue=new Et(ze)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:Ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,o)=>{this.Je(o)&&t(o)})}Ze(e){const t=e.targetId,n=e.ge.count,o=this.Xe(t);if(o){const a=o.target;if(_h(a))if(n===0){const l=new _e(a.path);this.ze(t,l,bt.newNoDocument(l,Ve.min()))}else be(n===1);else{const l=this.et(t);if(l!==n){const u=this.tt(e),d=u?this.nt(u,e,l):1;if(d!==0){this.Ye(t);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(t,p)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:o=0},hashCount:a=0}=t;let l,u;try{l=Fs(n).toUint8Array()}catch(d){if(d instanceof iw)return Gl("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new dm(l,o,a)}catch(d){return Gl(d instanceof Ml?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.Ee===0?null:u}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let o=0;return n.forEach(a=>{const l=this.ke.it(),u=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(u)||(this.ze(t,a,null),o++)}),o}ot(e){const t=new Map;this.qe.forEach((a,l)=>{const u=this.Xe(l);if(u){if(a.current&&_h(u.target)){const d=new _e(u.target.path);this._t(d).has(l)||this.ut(l,d)||this.ze(l,d,bt.newNoDocument(d,e))}a.ve&&(t.set(l,a.Fe()),a.Me())}});let n=Ge();this.Ke.forEach((a,l)=>{let u=!0;l.forEachWhile(d=>{const p=this.Xe(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(a))}),this.Qe.forEach((a,l)=>l.setReadTime(e));const o=new pc(e,t,this.Ue,this.Qe,n);return this.Qe=Ar(),this.$e=Uu(),this.Ke=Uu(),this.Ue=new Et(ze),o}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ke=this.Ke.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const o=this.He(e);this.ut(e,t)?o.xe(t,1):o.Oe(t),this.Ke=this.Ke.insert(t,this.ct(t).delete(e)),this.Ke=this.Ke.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Hv,this.qe.set(e,t)),t}ct(e){let t=this.Ke.get(e);return t||(t=new lt(ze),this.Ke=this.Ke.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new lt(ze),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||ae("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Hv),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function Uu(){return new Et(_e.comparator)}function Kv(){return new Et(_e.comparator)}const nA={asc:"ASCENDING",desc:"DESCENDING"},rA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sA={and:"AND",or:"OR"};class oA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sp(r,e){return r.useProto3Json||Uh(e)?e:{value:e}}function Eh(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function iA(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function aA(r,e){return Eh(r,e.toTimestamp())}function Bn(r){return be(!!r),Ve.fromTimestamp(function(t){const n=Os(t);return new cn(n.seconds,n.nanos)}(r))}function jw(r,e){return xp(r,e).canonicalString()}function xp(r,e){const t=function(o){return new gt(["projects",o.projectId,"databases",o.database])}(r).child("documents");return e===void 0?t:t.child(e)}function Lw(r){const e=gt.fromString(r);return be(Kw(e)),e}function Th(r,e){return jw(r.databaseId,e.path)}function hi(r,e){const t=Lw(e);if(t.get(1)!==r.databaseId.projectId)throw new Ce(oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Ce(oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new _e(Uw(t))}function Bw(r,e){return jw(r.databaseId,e)}function zw(r){const e=Lw(r);return e.length===4?gt.emptyPath():Uw(e)}function Cp(r){return new gt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function Uw(r){return be(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Qv(r,e,t){return{name:Th(r,e),fields:t.value.mapValue.fields}}function lA(r,e,t){const n=hi(r,e.name),o=Bn(e.updateTime),a=e.createTime?Bn(e.createTime):Ve.min(),l=new Cr({mapValue:{fields:e.fields}}),u=bt.newFoundDocument(n,o,a,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function cA(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],a=function(p,g){return p.useProto3Json?(be(g===void 0||typeof g=="string"),Lt.fromBase64String(g||"")):(be(g===void 0||g instanceof Buffer||g instanceof Uint8Array),Lt.fromUint8Array(g||new Uint8Array))}(r,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&function(p){const g=p.code===void 0?oe.UNKNOWN:Mw(p.code);return new Ce(g,p.message||"")}(l);t=new Fw(n,o,a,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const o=hi(r,n.document.name),a=Bn(n.document.updateTime),l=n.document.createTime?Bn(n.document.createTime):Ve.min(),u=new Cr({mapValue:{fields:n.document.fields}}),d=bt.newFoundDocument(o,a,l,u),p=n.targetIds||[],g=n.removedTargetIds||[];t=new rh(p,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const o=hi(r,n.document),a=n.readTime?Bn(n.readTime):Ve.min(),l=bt.newNoDocument(o,a),u=n.removedTargetIds||[];t=new rh([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const o=hi(r,n.document),a=n.removedTargetIds||[];t=new rh([],a,o,null)}else{if(!("filter"in e))return Ae();{e.filter;const n=e.filter;n.targetId;const{count:o=0,unchangedNames:a}=n,l=new YC(o,a),u=n.targetId;t=new Ow(u,l)}}return t}function Ih(r,e){let t;if(e instanceof fc)t={update:Qv(r,e.key,e.value)};else if(e instanceof lm)t={delete:Th(r,e.key)};else if(e instanceof La)t={update:Qv(r,e.key,e.data),updateMask:mA(e.fieldMask)};else{if(!(e instanceof Vw))return Ae();t={verify:Th(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(a,l){const u=l.transform;if(u instanceof nc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ka)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Pa)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof rc)return{fieldPath:l.field.canonicalString(),increment:u.Ie};throw Ae()}(0,n))),e.precondition.isNone||(t.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:aA(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ae()}(r,e.precondition)),t}function Ap(r,e){const t=e.currentDocument?function(a){return a.updateTime!==void 0?$r.updateTime(Bn(a.updateTime)):a.exists!==void 0?$r.exists(a.exists):$r.none()}(e.currentDocument):$r.none(),n=e.updateTransforms?e.updateTransforms.map(o=>function(l,u){let d=null;if("setToServerValue"in u)be(u.setToServerValue==="REQUEST_TIME"),d=new nc;else if("appendMissingElements"in u){const g=u.appendMissingElements.values||[];d=new ka(g)}else if("removeAllFromArray"in u){const g=u.removeAllFromArray.values||[];d=new Pa(g)}else"increment"in u?d=new rc(l,u.increment):Ae();const p=jt.fromServerFormat(u.fieldPath);return new HC(p,d)}(r,o)):[];if(e.update){e.update.name;const o=hi(r,e.update.name),a=new Cr({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=function(d){const p=d.fieldPaths||[];return new Ps(p.map(g=>jt.fromServerFormat(g)))}(e.updateMask);return new La(o,a,l,t,n)}return new fc(o,a,t,n)}if(e.delete){const o=hi(r,e.delete);return new lm(o,t)}if(e.verify){const o=hi(r,e.verify);return new Vw(o,t)}return Ae()}function uA(r,e){return r&&r.length>0?(be(e!==void 0),r.map(t=>function(o,a){let l=o.updateTime?Bn(o.updateTime):Bn(a);return l.isEqual(Ve.min())&&(l=Bn(a)),new QC(l,o.transformResults||[])}(t,e))):[]}function $w(r,e){return{documents:[Bw(r,e.path)]}}function qw(r,e){const t={structuredQuery:{}},n=e.path;let o;e.collectionGroup!==null?(o=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Bw(r,o);const a=function(p){if(p.length!==0)return Hw(ht.create(p,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const l=function(p){if(p.length!==0)return p.map(g=>function(T){return{field:ma(T.field),direction:dA(T.dir)}}(g))}(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=Sp(r,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{ht:t,parent:o}}function Ww(r){let e=zw(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let o=null;if(n>0){be(n===1);const g=t.from[0];g.allDescendants?o=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=function(v){const T=Gw(v);return T instanceof ht&&im(T)?T.getFilters():[T]}(t.where));let l=[];t.orderBy&&(l=function(v){return v.map(T=>function(C){return new vh(ga(C.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(T))}(t.orderBy));let u=null;t.limit&&(u=function(v){let T;return T=typeof v=="object"?v.value:v,Uh(T)?null:T}(t.limit));let d=null;t.startAt&&(d=function(v){const T=!!v.before,S=v.values||[];return new Na(S,T)}(t.startAt));let p=null;return t.endAt&&(p=function(v){const T=!v.before,S=v.values||[];return new Na(S,T)}(t.endAt)),Iw(e,o,l,a,u,"F",d,p)}function hA(r,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Gw(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ga(t.unaryFilter.field);return Ke.create(n,"==",{doubleValue:NaN});case"IS_NULL":const o=ga(t.unaryFilter.field);return Ke.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ga(t.unaryFilter.field);return Ke.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=ga(t.unaryFilter.field);return Ke.create(l,"!=",{nullValue:"NULL_VALUE"});default:return Ae()}}(r):r.fieldFilter!==void 0?function(t){return Ke.create(ga(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ae()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return ht.create(t.compositeFilter.filters.map(n=>Gw(n)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ae()}}(t.compositeFilter.op))}(r):Ae()}function dA(r){return nA[r]}function fA(r){return rA[r]}function pA(r){return sA[r]}function ma(r){return{fieldPath:r.canonicalString()}}function ga(r){return jt.fromServerFormat(r.fieldPath)}function Hw(r){return r instanceof Ke?function(t){if(t.op==="=="){if(Dv(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NAN"}};if(bv(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Dv(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NOT_NAN"}};if(bv(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ma(t.field),op:fA(t.op),value:t.value}}}(r):r instanceof ht?function(t){const n=t.getFilters().map(o=>Hw(o));return n.length===1?n[0]:{compositeFilter:{op:pA(t.op),filters:n}}}(r):Ae()}function mA(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Kw(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,t,n,o,a=Ve.min(),l=Ve.min(),u=Lt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new bs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new bs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e){this.Tt=e}}function gA(r,e){let t;if(e.document)t=lA(r.Tt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=_e.fromSegments(e.noDocument.path),o=gi(e.noDocument.readTime);t=bt.newNoDocument(n,o),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae();{const n=_e.fromSegments(e.unknownDocument.path),o=gi(e.unknownDocument.version);t=bt.newUnknownDocument(n,o)}}return e.readTime&&t.setReadTime(function(o){const a=new cn(o[0],o[1]);return Ve.fromTimestamp(a)}(e.readTime)),t}function Xv(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Sh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,l){return{name:Th(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Eh(a,l.version.toTimestamp()),createTime:Eh(a,l.createTime.toTimestamp())}}(r.Tt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:mi(e.version)};else{if(!e.isUnknownDocument())return Ae();n.unknownDocument={path:t.path.toArray(),version:mi(e.version)}}return n}function Sh(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function mi(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function gi(r){const e=new cn(r.seconds,r.nanoseconds);return Ve.fromTimestamp(e)}function oi(r,e){const t=(e.baseMutations||[]).map(a=>Ap(r.Tt,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const u=e.mutations[a+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>Ap(r.Tt,a)),o=cn.fromMillis(e.localWriteTimeMs);return new cm(e.batchId,o,t,n)}function Ol(r){const e=gi(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?gi(r.lastLimboFreeSnapshotVersion):Ve.min();let n;return n=function(a){return a.documents!==void 0}(r.query)?function(a){return be(a.documents.length===1),hr(Qh(zw(a.documents[0])))}(r.query):function(a){return hr(Ww(a))}(r.query),new bs(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Lt.fromBase64String(r.resumeToken))}function Xw(r,e){const t=mi(e.snapshotVersion),n=mi(e.lastLimboFreeSnapshotVersion);let o;o=_h(e.target)?$w(r.Tt,e.target):qw(r.Tt,e.target).ht;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pi(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:o}}function Yw(r){const e=Ww({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Ip(e,e.limit,"L"):e}function Kf(r,e){return new hm(e.largestBatchId,Ap(r.Tt,e.overlayMutation))}function Yv(r,e){const t=e.path.lastSegment();return[r,Rn(e.path.popLast()),t]}function Zv(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:mi(n.readTime),documentKey:Rn(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{getBundleMetadata(e,t){return Jv(e).get(t).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:gi(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,t){return Jv(e).put(function(o){return{bundleId:o.id,createTime:mi(Bn(o.createTime)),version:o.version}}(t))}getNamedQuery(e,t){return e_(e).get(t).next(n=>{if(n)return function(a){return{name:a.name,query:Yw(a.bundledQuery),readTime:gi(a.readTime)}}(n)})}saveNamedQuery(e,t){return e_(e).put(function(o){return{name:o.name,readTime:mi(Bn(o.readTime)),bundledQuery:o.bundledQuery}}(t))}}function Jv(r){return Jt(r,$h)}function e_(r){return Jt(r,qh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){const n=t.uid||"";return new Jh(e,n)}getOverlay(e,t){return Nl(e).get(Yv(this.userId,t)).next(n=>n?Kf(this.serializer,n):null)}getOverlays(e,t){const n=ls();return W.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&n.set(o,a)})).next(()=>n)}saveOverlays(e,t,n){const o=[];return n.forEach((a,l)=>{const u=new hm(t,l);o.push(this.Et(e,u))}),W.waitFor(o)}removeOverlaysForBatchId(e,t,n){const o=new Set;t.forEach(l=>o.add(Rn(l.getCollectionPath())));const a=[];return o.forEach(l=>{const u=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,n+1],!1,!0);a.push(Nl(e).J(gp,u))}),W.waitFor(a)}getOverlaysForCollection(e,t,n){const o=ls(),a=Rn(t),l=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Nl(e).G(gp,l).next(u=>{for(const d of u){const p=Kf(this.serializer,d);o.set(p.getKey(),p)}return o})}getOverlaysForCollectionGroup(e,t,n,o){const a=ls();let l;const u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Nl(e).Z({index:nw,range:u},(d,p,g)=>{const v=Kf(this.serializer,p);a.size()<o||v.largestBatchId===l?(a.set(v.getKey(),v),l=v.largestBatchId):g.done()}).next(()=>a)}Et(e,t){return Nl(e).put(function(o,a,l){const[u,d,p]=Yv(a,l.mutation.key);return{userId:a,collectionPath:d,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Ih(o.Tt,l.mutation)}}(this.serializer,this.userId,t))}}function Nl(r){return Jt(r,Wh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{dt(e){return Jt(e,nm)}getSessionToken(e){return this.dt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Lt.fromUint8Array(n):Lt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(xt(e.integerValue));else if("doubleValue"in e){const n=xt(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Kl(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),typeof n=="string"&&(n=Os(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.bt(t);else if("bytesValue"in e)this.ft(t,30),t.St(Fs(e.bytesValue)),this.bt(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?pw(e)?this.ft(t,Number.MAX_SAFE_INTEGER):Hh(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.bt(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.bt(t)):Ae()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const o of Object.keys(n))this.wt(o,t),this.Rt(n[o],t)}vt(e,t){var n,o;const a=e.fields||{};this.ft(t,53);const l=Jl,u=((o=(n=a[l].arrayValue)===null||n===void 0?void 0:n.values)===null||o===void 0?void 0:o.length)||0;this.ft(t,15),t.gt(xt(u)),this.wt(l,t),this.Rt(a[l],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const o of n)this.Rt(o,t)}Dt(e,t){this.ft(t,37),_e.fromName(e).path.forEach(n=>{this.ft(t,60),this.Mt(n,t)})}ft(e,t){e.gt(t)}bt(e){e.gt(2)}}ii.xt=new ii;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca=255;function _A(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function t_(r){const e=64-function(n){let o=0;for(let a=0;a<8;++a){const l=_A(255&n[a]);if(o+=l,l!==8)break}return o}(r);return Math.ceil(e/8)}class wA{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Nt(n);else if(n<2048)this.Nt(960|n>>>6),this.Nt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Nt(480|n>>>12),this.Nt(128|63&n>>>6),this.Nt(128|63&n);else{const o=t.codePointAt(0);this.Nt(240|o>>>18),this.Nt(128|63&o>>>12),this.Nt(128|63&o>>>6),this.Nt(128|63&o)}}this.Bt()}$t(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.kt(n);else if(n<2048)this.kt(960|n>>>6),this.kt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.kt(480|n>>>12),this.kt(128|63&n>>>6),this.kt(128|63&n);else{const o=t.codePointAt(0);this.kt(240|o>>>18),this.kt(128|63&o>>>12),this.kt(128|63&o>>>6),this.kt(128|63&o)}}this.qt()}Kt(e){const t=this.Ut(e),n=t_(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let o=t.length-n;o<t.length;++o)this.buffer[this.position++]=255&t[o]}Gt(e){const t=this.Ut(e),n=t_(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let o=t.length-n;o<t.length;++o)this.buffer[this.position++]=~(255&t[o])}zt(){this.jt(ca),this.jt(255)}Ht(){this.Jt(ca),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Ut(e){const t=function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let o=1;o<t.length;++o)t[o]^=n?255:0;return t}Nt(e){const t=255&e;t===0?(this.jt(0),this.jt(255)):t===ca?(this.jt(ca),this.jt(0)):this.jt(t)}kt(e){const t=255&e;t===0?(this.Jt(0),this.Jt(255)):t===ca?(this.Jt(ca),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const o=new Uint8Array(n);o.set(this.buffer),this.buffer=o}}class EA{constructor(e){this.Zt=e}St(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Kt(e)}Vt(){this.Zt.zt()}}class TA{constructor(e){this.Zt=e}St(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class Rl{constructor(){this.Zt=new wA,this.Xt=new EA(this.Zt),this.en=new TA(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return e===0?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,t,n,o){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=o}nn(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new ai(this.indexId,this.documentKey,this.arrayValue,n)}}function uo(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=n_(r.arrayValue,e.arrayValue),t!==0?t:(t=n_(r.directionalValue,e.directionalValue),t!==0?t:_e.comparator(r.documentKey,e.documentKey)))}function n_(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e){this.rn=new lt((t,n)=>jt.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(const t of e.filters){const n=t;n.isInequality()?this.rn=this.rn.add(n):this._n.push(n)}}get an(){return this.rn.size>1}un(e){if(be(e.collectionGroup===this.collectionId),this.an)return!1;const t=fp(e);if(t!==void 0&&!this.cn(t))return!1;const n=ni(e);let o=new Set,a=0,l=0;for(;a<n.length&&this.cn(n[a]);++a)o=o.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.rn.size>0){const u=this.rn.getIterator().getNext();if(!o.has(u.field.canonicalString())){const d=n[a];if(!this.ln(u,d)||!this.hn(this.sn[l++],d))return!1}++a}for(;a<n.length;++a){const u=n[a];if(l>=this.sn.length||!this.hn(this.sn[l++],u))return!1}return!0}Pn(){if(this.an)return null;let e=new lt(jt.comparator);const t=[];for(const n of this._n)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Yu(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Yu(n.field,0))}for(const n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Yu(n.field,n.dir==="asc"?0:1)));return new hh(hh.UNKNOWN_ID,this.collectionId,t,Hl.empty())}cn(e){for(const t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(r){var e,t;if(be(r instanceof Ke||r instanceof ht),r instanceof Ke){if(r instanceof Tw){const o=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(a=>Ke.create(r.field,"==",a)))||[];return ht.create(o,"or")}return r}const n=r.filters.map(o=>Zw(o));return ht.create(n,r.op)}function IA(r){if(r.getFilters().length===0)return[];const e=kp(Zw(r));return be(Jw(e)),Np(e)||Rp(e)?[e]:e.getFilters()}function Np(r){return r instanceof Ke}function Rp(r){return r instanceof ht&&im(r)}function Jw(r){return Np(r)||Rp(r)||function(t){if(t instanceof ht&&wp(t)){for(const n of t.getFilters())if(!Np(n)&&!Rp(n))return!1;return!0}return!1}(r)}function kp(r){if(be(r instanceof Ke||r instanceof ht),r instanceof Ke)return r;if(r.filters.length===1)return kp(r.filters[0]);const e=r.filters.map(n=>kp(n));let t=ht.create(e,r.op);return t=xh(t),Jw(t)?t:(be(t instanceof ht),be(Ra(t)),be(t.filters.length>1),t.filters.reduce((n,o)=>fm(n,o)))}function fm(r,e){let t;return be(r instanceof Ke||r instanceof ht),be(e instanceof Ke||e instanceof ht),t=r instanceof Ke?e instanceof Ke?function(o,a){return ht.create([o,a],"and")}(r,e):s_(r,e):e instanceof Ke?s_(e,r):function(o,a){if(be(o.filters.length>0&&a.filters.length>0),Ra(o)&&Ra(a))return _w(o,a.getFilters());const l=wp(o)?o:a,u=wp(o)?a:o,d=l.filters.map(p=>fm(p,u));return ht.create(d,"or")}(r,e),xh(t)}function s_(r,e){if(Ra(e))return _w(e,r.getFilters());{const t=e.filters.map(n=>fm(r,n));return ht.create(t,"or")}}function xh(r){if(be(r instanceof Ke||r instanceof ht),r instanceof Ke)return r;const e=r.getFilters();if(e.length===1)return xh(e[0]);if(yw(r))return r;const t=e.map(o=>xh(o)),n=[];return t.forEach(o=>{o instanceof Ke?n.push(o):o instanceof ht&&(o.op===r.op?n.push(...o.filters):n.push(o))}),n.length===1?n[0]:ht.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(){this.Tn=new pm}addToCollectionParentIndex(e,t){return this.Tn.add(t),W.resolve()}getCollectionParents(e,t){return W.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return W.resolve()}deleteFieldIndex(e,t){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,t){return W.resolve()}getDocumentsMatchingTarget(e,t){return W.resolve(null)}getIndexType(e,t){return W.resolve(0)}getFieldIndexes(e,t){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,t){return W.resolve(dr.min())}getMinOffsetFromCollectionGroup(e,t){return W.resolve(dr.min())}updateCollectionGroup(e,t,n){return W.resolve()}updateIndexEntries(e,t){return W.resolve()}}class pm{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),o=this.index[t]||new lt(gt.comparator),a=!o.has(n);return this.index[t]=o.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),o=this.index[t];return o&&o.has(n)}getEntries(e){return(this.index[e]||new lt(gt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_="IndexedDbIndexManager",$u=new Uint8Array(0);class xA{constructor(e,t){this.databaseId=t,this.In=new pm,this.En=new js(n=>pi(n),(n,o)=>hc(n,o)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){const n=t.lastSegment(),o=t.popLast();e.addOnCommittedListener(()=>{this.In.add(t)});const a={collectionId:n,parent:Rn(o)};return i_(e).put(a)}return W.resolve()}getCollectionParents(e,t){const n=[],o=IDBKeyRange.bound([t,""],[W0(t),""],!1,!0);return i_(e).G(o).next(a=>{for(const l of a){if(l.collectionId!==t)break;n.push(as(l.parent))}return n})}addFieldIndex(e,t){const n=kl(e),o=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(t);delete o.indexId;const a=n.add(o);if(t.indexState){const l=ha(e);return a.next(u=>{l.put(Zv(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const n=kl(e),o=ha(e),a=ua(e);return n.delete(t.indexId).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=kl(e),n=ua(e),o=ha(e);return t.J().next(()=>n.J()).next(()=>o.J())}createTargetIndexes(e,t){return W.forEach(this.dn(t),n=>this.getIndexType(e,n).next(o=>{if(o===0||o===1){const a=new r_(n).Pn();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,t){const n=ua(e);let o=!0;const a=new Map;return W.forEach(this.dn(t),l=>this.An(e,l).next(u=>{o&&(o=!!u),a.set(l,u)})).next(()=>{if(o){let l=Ge();const u=[];return W.forEach(a,(d,p)=>{ae(o_,`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(X=>`${X.fieldPath}:${X.kind}`).join(",")}`}(d)} to execute ${pi(t)}`);const g=function(U,X){const O=fp(X);if(O===void 0)return null;for(const B of wh(U,O.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(p,d),v=function(U,X){const O=new Map;for(const B of ni(X))for(const A of wh(U,B.fieldPath))switch(A.op){case"==":case"in":O.set(B.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return O.set(B.fieldPath.canonicalString(),A.value),Array.from(O.values())}return null}(p,d),T=function(U,X){const O=[];let B=!0;for(const A of ni(X)){const I=A.kind===0?jv(U,A.fieldPath,U.startAt):Lv(U,A.fieldPath,U.startAt);O.push(I.value),B&&(B=I.inclusive)}return new Na(O,B)}(p,d),S=function(U,X){const O=[];let B=!0;for(const A of ni(X)){const I=A.kind===0?Lv(U,A.fieldPath,U.endAt):jv(U,A.fieldPath,U.endAt);O.push(I.value),B&&(B=I.inclusive)}return new Na(O,B)}(p,d),C=this.Rn(d,p,T),D=this.Rn(d,p,S),V=this.Vn(d,p,v),q=this.mn(d.indexId,g,C,T.inclusive,D,S.inclusive,V);return W.forEach(q,L=>n.H(L,t.limit).next(U=>{U.forEach(X=>{const O=_e.fromSegments(X.documentKey);l.has(O)||(l=l.add(O),u.push(O))})}))}).next(()=>u)}return W.resolve(null)})}dn(e){let t=this.En.get(e);return t||(e.filters.length===0?t=[e]:t=IA(ht.create(e.filters,"and")).map(n=>Tp(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.En.set(e,t),t)}mn(e,t,n,o,a,l,u){const d=(t!=null?t.length:1)*Math.max(n.length,a.length),p=d/(t!=null?t.length:1),g=[];for(let v=0;v<d;++v){const T=t?this.fn(t[v/p]):$u,S=this.gn(e,T,n[v%p],o),C=this.pn(e,T,a[v%p],l),D=u.map(V=>this.gn(e,T,V,!0));g.push(...this.createRange(S,C,D))}return g}gn(e,t,n,o){const a=new ai(e,_e.empty(),t,n);return o?a:a.nn()}pn(e,t,n,o){const a=new ai(e,_e.empty(),t,n);return o?a.nn():a}An(e,t){const n=new r_(t),o=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,o).next(a=>{let l=null;for(const u of a)n.un(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l})}getIndexType(e,t){let n=2;const o=this.dn(t);return W.forEach(o,a=>this.An(e,a).next(l=>{l?n!==0&&l.fields.length<function(d){let p=new lt(jt.comparator),g=!1;for(const v of d.filters)for(const T of v.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?g=!0:p=p.add(T.field));for(const v of d.orderBy)v.field.isKeyField()||(p=p.add(v.field));return p.size+(g?1:0)}(a)&&(n=1):n=0})).next(()=>function(l){return l.limit!==null}(t)&&o.length>1&&n===2?1:n)}yn(e,t){const n=new Rl;for(const o of ni(e)){const a=t.data.field(o.fieldPath);if(a==null)return null;const l=n.tn(o.kind);ii.xt.At(a,l)}return n.Yt()}fn(e){const t=new Rl;return ii.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){const n=new Rl;return ii.xt.At(om(this.databaseId,t),n.tn(function(a){const l=ni(a);return l.length===0?0:l[l.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(n===null)return[];let o=[];o.push(new Rl);let a=0;for(const l of ni(e)){const u=n[a++];for(const d of o)if(this.bn(t,l.fieldPath)&&tc(u))o=this.Sn(o,l,u);else{const p=d.tn(l.kind);ii.xt.At(u,p)}}return this.Dn(o)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}Sn(e,t,n){const o=[...e],a=[];for(const l of n.arrayValue.values||[])for(const u of o){const d=new Rl;d.seed(u.Yt()),ii.xt.At(l,d.tn(t.kind)),a.push(d)}return a}bn(e,t){return!!e.filters.find(n=>n instanceof Ke&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=kl(e),o=ha(e);return(t?n.G(mp,IDBKeyRange.bound(t,t)):n.G()).next(a=>{const l=[];return W.forEach(a,u=>o.get([u.indexId,this.uid]).next(d=>{l.push(function(g,v){const T=v?new Hl(v.sequenceNumber,new dr(gi(v.readTime),new _e(as(v.documentKey)),v.largestBatchId)):Hl.empty(),S=g.fields.map(([C,D])=>new Yu(jt.fromServerFormat(C),D));return new hh(g.indexId,g.collectionGroup,S,T)}(u,d))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,o)=>{const a=n.indexState.sequenceNumber-o.indexState.sequenceNumber;return a!==0?a:ze(n.collectionGroup,o.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const o=kl(e),a=ha(e);return this.vn(e).next(l=>o.G(mp,IDBKeyRange.bound(t,t)).next(u=>W.forEach(u,d=>a.put(Zv(d.indexId,this.uid,l,n)))))}updateIndexEntries(e,t){const n=new Map;return W.forEach(t,(o,a)=>{const l=n.get(o.collectionGroup);return(l?W.resolve(l):this.getFieldIndexes(e,o.collectionGroup)).next(u=>(n.set(o.collectionGroup,u),W.forEach(u,d=>this.Cn(e,o,d).next(p=>{const g=this.Fn(a,d);return p.isEqual(g)?W.resolve():this.Mn(e,a,d,p,g)}))))})}xn(e,t,n,o){return ua(e).put({indexId:o.indexId,uid:this.uid,arrayValue:o.arrayValue,directionalValue:o.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,o){return ua(e).delete([o.indexId,this.uid,o.arrayValue,o.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){const o=ua(e);let a=new lt(uo);return o.Z({index:tw,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},(l,u)=>{a=a.add(new ai(n.indexId,t,u.arrayValue,u.directionalValue))}).next(()=>a)}Fn(e,t){let n=new lt(uo);const o=this.yn(t,e);if(o==null)return n;const a=fp(t);if(a!=null){const l=e.data.field(a.fieldPath);if(tc(l))for(const u of l.arrayValue.values||[])n=n.add(new ai(t.indexId,e.key,this.fn(u),o))}else n=n.add(new ai(t.indexId,e.key,$u,o));return n}Mn(e,t,n,o,a){ae(o_,"Updating index entries for document '%s'",t.key);const l=[];return function(d,p,g,v,T){const S=d.getIterator(),C=p.getIterator();let D=la(S),V=la(C);for(;D||V;){let q=!1,L=!1;if(D&&V){const U=g(D,V);U<0?L=!0:U>0&&(q=!0)}else D!=null?L=!0:q=!0;q?(v(V),V=la(C)):L?(T(D),D=la(S)):(D=la(S),V=la(C))}}(o,a,uo,u=>{l.push(this.xn(e,t,n,u))},u=>{l.push(this.On(e,t,n,u))}),W.waitFor(l)}vn(e){let t=1;return ha(e).Z({index:ew,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,o,a)=>{a.done(),t=o.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((l,u)=>uo(l,u)).filter((l,u,d)=>!u||uo(l,d[u-1])!==0);const o=[];o.push(e);for(const l of n){const u=uo(l,e),d=uo(l,t);if(u===0)o[0]=e.nn();else if(u>0&&d<0)o.push(l),o.push(l.nn());else if(d>0)break}o.push(t);const a=[];for(let l=0;l<o.length;l+=2){if(this.Nn(o[l],o[l+1]))return[];const u=[o[l].indexId,this.uid,o[l].arrayValue,o[l].directionalValue,$u,[]],d=[o[l+1].indexId,this.uid,o[l+1].arrayValue,o[l+1].directionalValue,$u,[]];a.push(IDBKeyRange.bound(u,d))}return a}Nn(e,t){return uo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(a_)}getMinOffset(e,t){return W.mapArray(this.dn(t),n=>this.An(e,n).next(o=>o||Ae())).next(a_)}}function i_(r){return Jt(r,Yl)}function ua(r){return Jt(r,gh)}function kl(r){return Jt(r,tm)}function ha(r){return Jt(r,mh)}function a_(r){be(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const o=r[n].indexState.offset;Zp(o,e)<0&&(e=o),t<o.largestBatchId&&(t=o.largestBatchId)}return new dr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eE=41943040;class Nn{static withCacheSize(e){return new Nn(e,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(r,e,t){const n=r.store(Ur),o=r.store(Ia),a=[],l=IDBKeyRange.only(t.batchId);let u=0;const d=n.Z({range:l},(g,v,T)=>(u++,T.delete()));a.push(d.next(()=>{be(u===1)}));const p=[];for(const g of t.mutations){const v=Y0(e,g.key.path,t.batchId);a.push(o.delete(v)),p.push(g.key)}return W.waitFor(a).next(()=>p)}function Ch(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ae();e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(eE,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);class ed{constructor(e,t,n,o){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=o,this.Bn={}}static It(e,t,n,o){be(e.uid!=="");const a=e.isAuthenticated()?e.uid:"";return new ed(a,t,n,o)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ho(e).Z({index:li,range:n},(o,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,n,o){const a=ya(e),l=ho(e);return l.add({}).next(u=>{be(typeof u=="number");const d=new cm(u,t,n,o),p=function(S,C,D){const V=D.baseMutations.map(L=>Ih(S.Tt,L)),q=D.mutations.map(L=>Ih(S.Tt,L));return{userId:C,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:V,mutations:q}}(this.serializer,this.userId,d),g=[];let v=new lt((T,S)=>ze(T.canonicalString(),S.canonicalString()));for(const T of o){const S=Y0(this.userId,T.key.path,u);v=v.add(T.key.path.popLast()),g.push(l.put(p)),g.push(a.put(S,Yx))}return v.forEach(T=>{g.push(this.indexManager.addToCollectionParentIndex(e,T))}),e.addOnCommittedListener(()=>{this.Bn[u]=d.keys()}),W.waitFor(g).next(()=>d)})}lookupMutationBatch(e,t){return ho(e).get(t).next(n=>n?(be(n.userId===this.userId),oi(this.serializer,n)):null)}Ln(e,t){return this.Bn[t]?W.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const o=n.keys();return this.Bn[t]=o,o}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,o=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return ho(e).Z({index:li,range:o},(l,u,d)=>{u.userId===this.userId&&(be(u.batchId>=n),a=oi(this.serializer,u)),d.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=ci;return ho(e).Z({index:li,range:t,reverse:!0},(o,a,l)=>{n=a.batchId,l.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ci],[this.userId,Number.POSITIVE_INFINITY]);return ho(e).G(li,t).next(n=>n.map(o=>oi(this.serializer,o)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Zu(this.userId,t.path),o=IDBKeyRange.lowerBound(n),a=[];return ya(e).Z({range:o},(l,u,d)=>{const[p,g,v]=l,T=as(g);if(p===this.userId&&t.path.isEqual(T))return ho(e).get(v).next(S=>{if(!S)throw Ae();be(S.userId===this.userId),a.push(oi(this.serializer,S))});d.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new lt(ze);const o=[];return t.forEach(a=>{const l=Zu(this.userId,a.path),u=IDBKeyRange.lowerBound(l),d=ya(e).Z({range:u},(p,g,v)=>{const[T,S,C]=p,D=as(S);T===this.userId&&a.path.isEqual(D)?n=n.add(C):v.done()});o.push(d)}),W.waitFor(o).next(()=>this.kn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,o=n.length+1,a=Zu(this.userId,n),l=IDBKeyRange.lowerBound(a);let u=new lt(ze);return ya(e).Z({range:l},(d,p,g)=>{const[v,T,S]=d,C=as(T);v===this.userId&&n.isPrefixOf(C)?C.length===o&&(u=u.add(S)):g.done()}).next(()=>this.kn(e,u))}kn(e,t){const n=[],o=[];return t.forEach(a=>{o.push(ho(e).get(a).next(l=>{if(l===null)throw Ae();be(l.userId===this.userId),n.push(oi(this.serializer,l))}))}),W.waitFor(o).next(()=>n)}removeMutationBatch(e,t){return tE(e.ue,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.qn(t.batchId)}),W.forEach(n,o=>this.referenceDelegate.markPotentiallyOrphaned(e,o))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return W.resolve();const n=IDBKeyRange.lowerBound(function(l){return[l]}(this.userId)),o=[];return ya(e).Z({range:n},(a,l,u)=>{if(a[0]===this.userId){const d=as(a[1]);o.push(d)}else u.done()}).next(()=>{be(o.length===0)})})}containsKey(e,t){return nE(e,this.userId,t)}Qn(e){return rE(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:ci,lastStreamToken:""})}}function nE(r,e,t){const n=Zu(e,t.path),o=n[1],a=IDBKeyRange.lowerBound(n);let l=!1;return ya(r).Z({range:a,Y:!0},(u,d,p)=>{const[g,v,T]=u;g===e&&v===o&&(l=!0),p.done()}).next(()=>l)}function ho(r){return Jt(r,Ur)}function ya(r){return Jt(r,Ia)}function rE(r){return Jt(r,Ql)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Kn(){return new yi(0)}static Un(){return new yi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next(t=>{const n=new yi(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Wn(e).next(t=>Ve.fromTimestamp(new cn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Wn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Wn(e).next(o=>(o.highestListenSequenceNumber=t,n&&(o.lastRemoteSnapshotVersion=n.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),this.Gn(e,o)))}addTargetData(e,t){return this.zn(e,t).next(()=>this.Wn(e).next(n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>da(e).delete(t.targetId)).next(()=>this.Wn(e)).next(n=>(be(n.targetCount>0),n.targetCount-=1,this.Gn(e,n)))}removeTargets(e,t,n){let o=0;const a=[];return da(e).Z((l,u)=>{const d=Ol(u);d.sequenceNumber<=t&&n.get(d.targetId)===null&&(o++,a.push(this.removeTargetData(e,d)))}).next(()=>W.waitFor(a)).next(()=>o)}forEachTarget(e,t){return da(e).Z((n,o)=>{const a=Ol(o);t(a)})}Wn(e){return c_(e).get(ph).next(t=>(be(t!==null),t))}Gn(e,t){return c_(e).put(ph,t)}zn(e,t){return da(e).put(Xw(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=pi(t),o=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return da(e).Z({range:o,index:J0},(l,u,d)=>{const p=Ol(u);hc(t,p.target)&&(a=p,d.done())}).next(()=>a)}addMatchingKeys(e,t,n){const o=[],a=yo(e);return t.forEach(l=>{const u=Rn(l.path);o.push(a.put({targetId:n,path:u})),o.push(this.referenceDelegate.addReference(e,n,l))}),W.waitFor(o)}removeMatchingKeys(e,t,n){const o=yo(e);return W.forEach(t,a=>{const l=Rn(a.path);return W.waitFor([o.delete([n,l]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,t){const n=yo(e),o=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(o)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),o=yo(e);let a=Ge();return o.Z({range:n,Y:!0},(l,u,d)=>{const p=as(l[1]),g=new _e(p);a=a.add(g)}).next(()=>a)}containsKey(e,t){const n=Rn(t.path),o=IDBKeyRange.bound([n],[W0(n)],!1,!0);let a=0;return yo(e).Z({index:em,Y:!0,range:o},([l,u],d,p)=>{l!==0&&(a++,p.done())}).next(()=>a>0)}lt(e,t){return da(e).get(t).next(n=>n?Ol(n):null)}}function da(r){return Jt(r,Sa)}function c_(r){return Jt(r,ui)}function yo(r){return Jt(r,xa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_="LruGarbageCollector",sE=1048576;function h_([r,e],[t,n]){const o=ze(r,t);return o===0?ze(e,n):o}class AA{constructor(e){this.Hn=e,this.buffer=new lt(h_),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();h_(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class oE{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){ae(u_,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ko(t)?ae(u_,"Ignoring IndexedDB error during garbage collection: ",t):await Ro(t)}await this.er(3e5)})}}class NA{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return W.resolve(Jn.ae);const n=new AA(t);return this.tr.forEachTarget(e,o=>n.Zn(o.sequenceNumber)).next(()=>this.tr.rr(e,o=>n.Zn(o))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ae("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(l_)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),l_):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,o,a,l,u,d,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,l=Date.now(),this.nthSequenceNumber(e,o))).next(v=>(n=v,u=Date.now(),this.removeTargets(e,n,t))).next(v=>(a=v,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(v=>(p=Date.now(),fa()<=tt.DEBUG&&ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-g}ms
	Determined least recently used ${o} in `+(u-l)+`ms
	Removed ${a} targets in `+(d-u)+`ms
	Removed ${v} documents in `+(p-d)+`ms
Total Duration: ${p-g}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:a,documentsRemoved:v})))}}function iE(r,e){return new NA(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,t){this.db=e,this.garbageCollector=iE(this,t)}nr(e){const t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(o=>n+o))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,(n,o)=>t(o))}addReference(e,t,n){return qu(e,n)}removeReference(e,t,n){return qu(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return qu(e,t)}ar(e,t){return function(o,a){let l=!1;return rE(o).X(u=>nE(o,u,a).next(d=>(d&&(l=!0),W.resolve(!d)))).next(()=>l)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[];let a=0;return this._r(e,(l,u)=>{if(u<=t){const d=this.ar(e,l).next(p=>{if(!p)return a++,n.getEntry(e,l).next(()=>(n.removeEntry(l,Ve.min()),yo(e).delete(function(v){return[0,Rn(v.path)]}(l))))});o.push(d)}}).next(()=>W.waitFor(o)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return qu(e,t)}_r(e,t){const n=yo(e);let o,a=Jn.ae;return n.Z({index:em},([l,u],{path:d,sequenceNumber:p})=>{l===0?(a!==Jn.ae&&t(new _e(as(o)),a),a=p,o=d):a=Jn.ae}).next(()=>{a!==Jn.ae&&t(new _e(as(o)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function qu(r,e){return yo(r).put(function(n,o){return{targetId:0,path:Rn(n.path),sequenceNumber:o}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(){this.changes=new js(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?W.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Jo(e).put(n)}removeEntry(e,t,n){return Jo(e).delete(function(a,l){const u=a.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Sh(l),u[u.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.ur(e,n)))}getEntry(e,t){let n=bt.newInvalidDocument(t);return Jo(e).Z({index:Ju,range:IDBKeyRange.only(Pl(t))},(o,a)=>{n=this.cr(t,a)}).next(()=>n)}lr(e,t){let n={size:0,document:bt.newInvalidDocument(t)};return Jo(e).Z({index:Ju,range:IDBKeyRange.only(Pl(t))},(o,a)=>{n={document:this.cr(t,a),size:Ch(a)}}).next(()=>n)}getEntries(e,t){let n=Ar();return this.hr(e,t,(o,a)=>{const l=this.cr(o,a);n=n.insert(o,l)}).next(()=>n)}Pr(e,t){let n=Ar(),o=new Et(_e.comparator);return this.hr(e,t,(a,l)=>{const u=this.cr(a,l);n=n.insert(a,u),o=o.insert(a,Ch(l))}).next(()=>({documents:n,Tr:o}))}hr(e,t,n){if(t.isEmpty())return W.resolve();let o=new lt(p_);t.forEach(d=>o=o.add(d));const a=IDBKeyRange.bound(Pl(o.first()),Pl(o.last())),l=o.getIterator();let u=l.getNext();return Jo(e).Z({index:Ju,range:a},(d,p,g)=>{const v=_e.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;u&&p_(u,v)<0;)n(u,null),u=l.getNext();u&&u.isEqual(v)&&(n(u,p),u=l.hasNext()?l.getNext():null),u?g.W(Pl(u)):g.done()}).next(()=>{for(;u;)n(u,null),u=l.hasNext()?l.getNext():null})}getDocumentsMatchingQuery(e,t,n,o,a){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),Sh(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],d=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Jo(e).G(IDBKeyRange.bound(u,d,!0)).next(p=>{a==null||a.incrementDocumentReadCount(p.length);let g=Ar();for(const v of p){const T=this.cr(_e.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);T.isFoundDocument()&&(dc(t,T)||o.has(T.key))&&(g=g.insert(T.key,T))}return g})}getAllFromCollectionGroup(e,t,n,o){let a=Ar();const l=f_(t,n),u=f_(t,dr.max());return Jo(e).Z({index:Z0,range:IDBKeyRange.bound(l,u,!0)},(d,p,g)=>{const v=this.cr(_e.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(v.key,v),a.size===o&&g.done()}).next(()=>a)}newChangeBuffer(e){return new PA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return d_(e).get(pp).next(t=>(be(!!t),t))}ur(e,t){return d_(e).put(pp,t)}cr(e,t){if(t){const n=gA(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Ve.min())))return n}return bt.newInvalidDocument(e)}}function lE(r){return new kA(r)}class PA extends aE{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new js(n=>n.toString(),(n,o)=>n.isEqual(o))}applyChanges(e){const t=[];let n=0,o=new lt((a,l)=>ze(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const u=this.Er.get(a);if(t.push(this.Ir.removeEntry(e,a,u.readTime)),l.isValidDocument()){const d=Xv(this.Ir.serializer,l);o=o.add(a.path.popLast());const p=Ch(d);n+=p-u.size,t.push(this.Ir.addEntry(e,a,d))}else if(n-=u.size,this.trackRemovals){const d=Xv(this.Ir.serializer,l.convertToNoDocument(Ve.min()));t.push(this.Ir.addEntry(e,a,d))}}),o.forEach(a=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Ir.updateMetadata(e,n)),W.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next(n=>(this.Er.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next(({documents:n,Tr:o})=>(o.forEach((a,l)=>{this.Er.set(a,{size:l,readTime:n.get(a).readTime})}),n))}}function d_(r){return Jt(r,Xl)}function Jo(r){return Jt(r,fh)}function Pl(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function f_(r,e){const t=e.documentKey.path.toArray();return[r,Sh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function p_(r,e){const t=r.path.toArray(),n=e.path.toArray();let o=0;for(let a=0;a<t.length-2&&a<n.length-2;++a)if(o=ze(t[a],n[a]),o)return o;return o=ze(t.length,n.length),o||(o=ze(t[t.length-2],n[n.length-2]),o||ze(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,t,n,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=o}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(n=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(n!==null&&Ul(n.mutation,o,Ps.empty(),cn.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Ge()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Ge()){const o=ls();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,n).next(a=>{let l=Vl();return a.forEach((u,d)=>{l=l.insert(u,d.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const n=ls();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Ge()))}populateOverlays(e,t,n){const o=[];return n.forEach(a=>{t.has(a)||o.push(a)}),this.documentOverlayCache.getOverlays(e,o).next(a=>{a.forEach((l,u)=>{t.set(l,u)})})}computeViews(e,t,n,o){let a=Ar();const l=zl(),u=function(){return zl()}();return t.forEach((d,p)=>{const g=n.get(p.key);o.has(p.key)&&(g===void 0||g.mutation instanceof La)?a=a.insert(p.key,p):g!==void 0?(l.set(p.key,g.mutation.getFieldMask()),Ul(g.mutation,p,g.mutation.getFieldMask(),cn.now())):l.set(p.key,Ps.empty())}),this.recalculateAndSaveOverlays(e,a).next(d=>(d.forEach((p,g)=>l.set(p,g)),t.forEach((p,g)=>{var v;return u.set(p,new bA(g,(v=l.get(p))!==null&&v!==void 0?v:null))}),u))}recalculateAndSaveOverlays(e,t){const n=zl();let o=new Et((l,u)=>l-u),a=Ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const u of l)u.keys().forEach(d=>{const p=t.get(d);if(p===null)return;let g=n.get(d)||Ps.empty();g=u.applyToLocalView(p,g),n.set(d,g);const v=(o.get(u.batchId)||Ge()).add(d);o=o.insert(u.batchId,v)})}).next(()=>{const l=[],u=o.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),p=d.key,g=d.value,v=Nw();g.forEach(T=>{if(!a.has(T)){const S=bw(t.get(T),n.get(T));S!==null&&v.set(T,S),a=a.add(T)}}),l.push(this.documentOverlayCache.saveOverlays(e,p,v))}return W.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,o){return function(l){return _e.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):VC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,o):this.getDocumentsMatchingCollectionQuery(e,t,n,o)}getNextDocuments(e,t,n,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,o).next(a=>{const l=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,o-a.size):W.resolve(ls());let u=Ta,d=a;return l.next(p=>W.forEach(p,(g,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),a.get(g)?W.resolve():this.remoteDocumentCache.getEntry(e,g).next(T=>{d=d.insert(g,T)}))).next(()=>this.populateOverlays(e,p,a)).next(()=>this.computeViews(e,d,p,Ge())).next(g=>({batchId:u,changes:jC(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _e(t)).next(n=>{let o=Vl();return n.isFoundDocument()&&(o=o.insert(n.key,n)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,n,o){const a=t.collectionGroup;let l=Vl();return this.indexManager.getCollectionParents(e,a).next(u=>W.forEach(u,d=>{const p=function(v,T){return new Kh(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(t,d.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,n,o).next(g=>{g.forEach((v,T)=>{l=l.insert(v,T)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,t,n,o){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,o))).next(l=>{a.forEach((d,p)=>{const g=p.getKey();l.get(g)===null&&(l=l.insert(g,bt.newInvalidDocument(g)))});let u=Vl();return l.forEach((d,p)=>{const g=a.get(d);g!==void 0&&Ul(g.mutation,p,Ps.empty(),cn.now()),dc(t,p)&&(u=u.insert(d,p))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return W.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Bn(o.createTime)}}(t)),W.resolve()}getNamedQuery(e,t){return W.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(o){return{name:o.name,query:Yw(o.bundledQuery),readTime:Bn(o.readTime)}}(t)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(){this.overlays=new Et(_e.comparator),this.Rr=new Map}getOverlay(e,t){return W.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ls();return W.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&n.set(o,a)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((o,a)=>{this.Et(e,t,a)}),W.resolve()}removeOverlaysForBatchId(e,t,n){const o=this.Rr.get(n);return o!==void 0&&(o.forEach(a=>this.overlays=this.overlays.remove(a)),this.Rr.delete(n)),W.resolve()}getOverlaysForCollection(e,t,n){const o=ls(),a=t.length+1,l=new _e(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const d=u.getNext().value,p=d.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&d.largestBatchId>n&&o.set(d.getKey(),d)}return W.resolve(o)}getOverlaysForCollectionGroup(e,t,n,o){let a=new Et((p,g)=>p-g);const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>n){let g=a.get(p.largestBatchId);g===null&&(g=ls(),a=a.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const u=ls(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,g)=>u.set(p,g)),!(u.size()>=o)););return W.resolve(u)}Et(e,t,n){const o=this.overlays.get(n.key);if(o!==null){const l=this.Rr.get(o.largestBatchId).delete(n.key);this.Rr.set(o.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new hm(t,n));let a=this.Rr.get(t);a===void 0&&(a=Ge(),this.Rr.set(t,a)),this.Rr.set(t,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this.sessionToken=Lt.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(){this.Vr=new lt(ln.mr),this.gr=new lt(ln.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new ln(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new ln(e,t))}br(e,t){e.forEach(n=>this.removeReference(n,t))}Sr(e){const t=new _e(new gt([])),n=new ln(t,e),o=new ln(t,e+1),a=[];return this.gr.forEachInRange([n,o],l=>{this.wr(l),a.push(l.key)}),a}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new _e(new gt([])),n=new ln(t,e),o=new ln(t,e+1);let a=Ge();return this.gr.forEachInRange([n,o],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new ln(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class ln{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return _e.comparator(e.key,t.key)||ze(e.Cr,t.Cr)}static pr(e,t){return ze(e.Cr,t.Cr)||_e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new lt(ln.mr)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,o){const a=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new cm(a,t,n,o);this.mutationQueue.push(l);for(const u of o)this.Mr=this.Mr.add(new ln(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return W.resolve(l)}lookupMutationBatch(e,t){return W.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,o=this.Nr(n),a=o<0?0:o;return W.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?ci:this.Fr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ln(t,0),o=new ln(t,Number.POSITIVE_INFINITY),a=[];return this.Mr.forEachInRange([n,o],l=>{const u=this.Or(l.Cr);a.push(u)}),W.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new lt(ze);return t.forEach(o=>{const a=new ln(o,0),l=new ln(o,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([a,l],u=>{n=n.add(u.Cr)})}),W.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,o=n.length+1;let a=n;_e.isDocumentKey(a)||(a=a.child(""));const l=new ln(new _e(a),0);let u=new lt(ze);return this.Mr.forEachWhile(d=>{const p=d.key.path;return!!n.isPrefixOf(p)&&(p.length===o&&(u=u.add(d.Cr)),!0)},l),W.resolve(this.Br(u))}Br(e){const t=[];return e.forEach(n=>{const o=this.Or(n);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){be(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return W.forEach(t.mutations,o=>{const a=new ln(o.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new ln(t,0),o=this.Mr.firstAfterOrEqual(n);return W.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e){this.kr=e,this.docs=function(){return new Et(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,o=this.docs.get(n),a=o?o.size:0,l=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return W.resolve(n?n.document.mutableCopy():bt.newInvalidDocument(t))}getEntries(e,t){let n=Ar();return t.forEach(o=>{const a=this.docs.get(o);n=n.insert(o,a?a.document.mutableCopy():bt.newInvalidDocument(o))}),W.resolve(n)}getDocumentsMatchingQuery(e,t,n,o){let a=Ar();const l=t.path,u=new _e(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:p,value:{document:g}}=d.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||Zp(H0(g),n)<=0||(o.has(g.key)||dc(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return W.resolve(a)}getAllFromCollectionGroup(e,t,n,o){Ae()}qr(e,t){return W.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new jA(this)}getSize(e){return W.resolve(this.size)}}class jA extends aE{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,o)=>{o.isValidDocument()?t.push(this.Ir.addEntry(e,o)):this.Ir.removeEntry(n)}),W.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{constructor(e){this.persistence=e,this.Qr=new js(t=>pi(t),hc),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.$r=0,this.Kr=new mm,this.targetCount=0,this.Ur=yi.Kn()}forEachTarget(e,t){return this.Qr.forEach((n,o)=>t(o)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Ur.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),W.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ur=new yi(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,W.resolve()}updateTargetData(e,t){return this.zn(t),W.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Kr.Sr(t.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,t,n){let o=0;const a=[];return this.Qr.forEach((l,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.Qr.delete(l),a.push(this.removeMatchingKeysForTargetId(e,u.targetId)),o++)}),W.waitFor(a).next(()=>o)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return W.resolve(n)}addMatchingKeys(e,t,n){return this.Kr.yr(t,n),W.resolve()}removeMatchingKeys(e,t,n){this.Kr.br(t,n);const o=this.persistence.referenceDelegate,a=[];return o&&t.forEach(l=>{a.push(o.markPotentiallyOrphaned(e,l))}),W.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Kr.Sr(t),W.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Kr.vr(t);return W.resolve(n)}containsKey(e,t){return W.resolve(this.Kr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Jn(0),this.zr=!1,this.zr=!0,this.jr=new MA,this.referenceDelegate=e(this),this.Hr=new LA(this),this.indexManager=new SA,this.remoteDocumentCache=function(o){return new FA(o)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new Qw(t),this.Yr=new DA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new OA(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){ae("MemoryPersistence","Starting transaction:",e);const o=new BA(this.Gr.next());return this.referenceDelegate.Zr(),n(o).next(a=>this.referenceDelegate.Xr(o).next(()=>a)).toPromise().then(a=>(o.raiseOnCommittedEvent(),a))}ei(e,t){return W.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class BA extends Q0{constructor(e){super(),this.currentSequenceNumber=e}}class td{constructor(e){this.persistence=e,this.ti=new mm,this.ni=null}static ri(e){return new td(e)}get ii(){if(this.ni)return this.ni;throw Ae()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),W.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),W.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),W.resolve()}removeTarget(e,t){this.ti.Sr(t.targetId).forEach(o=>this.ii.add(o.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(a=>this.ii.add(a.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.ii,n=>{const o=_e.fromPath(n);return this.si(e,o).next(a=>{a||t.removeEntry(o,Ve.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return W.or([()=>W.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Ah{constructor(e,t){this.persistence=e,this.oi=new js(n=>Rn(n.path),(n,o)=>n.isEqual(o)),this.garbageCollector=iE(this,t)}static ri(e,t){return new Ah(e,t)}Zr(){}Xr(e){return W.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(o=>n+o))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return W.forEach(this.oi,(n,o)=>this.ar(e,n,o).next(a=>a?W.resolve():t(o)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const o=this.persistence.getRemoteDocumentCache(),a=o.newChangeBuffer();return o.qr(e,l=>this.ar(e,l,t).next(u=>{u||(n++,a.removeEntry(l,Ve.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),W.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),W.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),W.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),W.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=th(e.data.value)),t}ar(e,t,n){return W.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.oi.get(t);return W.resolve(o!==void 0&&o>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.serializer=e}B(e,t,n,o){const a=new zh("createOrUpgrade",t);n<1&&o>=1&&(function(d){d.createObjectStore(cc)}(e),function(d){d.createObjectStore(Ql,{keyPath:Xx}),d.createObjectStore(Ur,{keyPath:Cv,autoIncrement:!0}).createIndex(li,Av,{unique:!0}),d.createObjectStore(Ia)}(e),m_(e),function(d){d.createObjectStore(ri)}(e));let l=W.resolve();return n<3&&o>=3&&(n!==0&&(function(d){d.deleteObjectStore(xa),d.deleteObjectStore(Sa),d.deleteObjectStore(ui)}(e),m_(e)),l=l.next(()=>function(d){const p=d.store(ui),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ve.min().toTimestamp(),targetCount:0};return p.put(ph,g)}(a))),n<4&&o>=4&&(n!==0&&(l=l.next(()=>function(d,p){return p.store(Ur).G().next(v=>{d.deleteObjectStore(Ur),d.createObjectStore(Ur,{keyPath:Cv,autoIncrement:!0}).createIndex(li,Av,{unique:!0});const T=p.store(Ur),S=v.map(C=>T.put(C));return W.waitFor(S)})}(e,a))),l=l.next(()=>{(function(d){d.createObjectStore(Ca,{keyPath:oC})})(e)})),n<5&&o>=5&&(l=l.next(()=>this._i(a))),n<6&&o>=6&&(l=l.next(()=>(function(d){d.createObjectStore(Xl)}(e),this.ai(a)))),n<7&&o>=7&&(l=l.next(()=>this.ui(a))),n<8&&o>=8&&(l=l.next(()=>this.ci(e,a))),n<9&&o>=9&&(l=l.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&o>=10&&(l=l.next(()=>this.li(a))),n<11&&o>=11&&(l=l.next(()=>{(function(d){d.createObjectStore($h,{keyPath:iC})})(e),function(d){d.createObjectStore(qh,{keyPath:aC})}(e)})),n<12&&o>=12&&(l=l.next(()=>{(function(d){const p=d.createObjectStore(Wh,{keyPath:pC});p.createIndex(gp,mC,{unique:!1}),p.createIndex(nw,gC,{unique:!1})})(e)})),n<13&&o>=13&&(l=l.next(()=>function(d){const p=d.createObjectStore(fh,{keyPath:Zx});p.createIndex(Ju,Jx),p.createIndex(Z0,eC)}(e)).next(()=>this.hi(e,a)).next(()=>e.deleteObjectStore(ri))),n<14&&o>=14&&(l=l.next(()=>this.Pi(e,a))),n<15&&o>=15&&(l=l.next(()=>function(d){d.createObjectStore(tm,{keyPath:lC,autoIncrement:!0}).createIndex(mp,cC,{unique:!1}),d.createObjectStore(mh,{keyPath:uC}).createIndex(ew,hC,{unique:!1}),d.createObjectStore(gh,{keyPath:dC}).createIndex(tw,fC,{unique:!1})}(e))),n<16&&o>=16&&(l=l.next(()=>{t.objectStore(mh).clear()}).next(()=>{t.objectStore(gh).clear()})),n<17&&o>=17&&(l=l.next(()=>{(function(d){d.createObjectStore(nm,{keyPath:yC})})(e)})),l}ai(e){let t=0;return e.store(ri).Z((n,o)=>{t+=Ch(o)}).next(()=>{const n={byteSize:t};return e.store(Xl).put(pp,n)})}_i(e){const t=e.store(Ql),n=e.store(Ur);return t.G().next(o=>W.forEach(o,a=>{const l=IDBKeyRange.bound([a.userId,ci],[a.userId,a.lastAcknowledgedBatchId]);return n.G(li,l).next(u=>W.forEach(u,d=>{be(d.userId===a.userId);const p=oi(this.serializer,d);return tE(e,a.userId,p).next(()=>{})}))}))}ui(e){const t=e.store(xa),n=e.store(ri);return e.store(ui).get(ph).next(o=>{const a=[];return n.Z((l,u)=>{const d=new gt(l),p=function(v){return[0,Rn(v)]}(d);a.push(t.get(p).next(g=>g?W.resolve():(v=>t.put({targetId:0,path:Rn(v),sequenceNumber:o.highestListenSequenceNumber}))(d)))}).next(()=>W.waitFor(a))})}ci(e,t){e.createObjectStore(Yl,{keyPath:sC});const n=t.store(Yl),o=new pm,a=l=>{if(o.add(l)){const u=l.lastSegment(),d=l.popLast();return n.put({collectionId:u,parent:Rn(d)})}};return t.store(ri).Z({Y:!0},(l,u)=>{const d=new gt(l);return a(d.popLast())}).next(()=>t.store(Ia).Z({Y:!0},([l,u,d],p)=>{const g=as(u);return a(g.popLast())}))}li(e){const t=e.store(Sa);return t.Z((n,o)=>{const a=Ol(o),l=Xw(this.serializer,a);return t.put(l)})}hi(e,t){const n=t.store(ri),o=[];return n.Z((a,l)=>{const u=t.store(fh),d=function(v){return v.document?new _e(gt.fromString(v.document.name).popFirst(5)):v.noDocument?_e.fromSegments(v.noDocument.path):v.unknownDocument?_e.fromSegments(v.unknownDocument.path):Ae()}(l).path.toArray(),p={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};o.push(u.put(p))}).next(()=>W.waitFor(o))}Pi(e,t){const n=t.store(Ur),o=lE(this.serializer),a=new gm(td.ri,this.serializer.Tt);return n.G().next(l=>{const u=new Map;return l.forEach(d=>{var p;let g=(p=u.get(d.userId))!==null&&p!==void 0?p:Ge();oi(this.serializer,d).keys().forEach(v=>g=g.add(v)),u.set(d.userId,g)}),W.forEach(u,(d,p)=>{const g=new An(p),v=Jh.It(this.serializer,g),T=a.getIndexManager(g),S=ed.It(g,this.serializer,T,a.referenceDelegate);return new cE(o,S,v,T).recalculateAndSaveOverlaysForDocumentKeys(new yp(t,Jn.ae),d).next()})})}}function m_(r){r.createObjectStore(xa,{keyPath:nC}).createIndex(em,rC,{unique:!0}),r.createObjectStore(Sa,{keyPath:"targetId"}).createIndex(J0,tC,{unique:!0}),r.createObjectStore(ui)}const fo="IndexedDbPersistence",Qf=18e5,Xf=5e3,Yf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",UA="main";class ym{constructor(e,t,n,o,a,l,u,d,p,g,v=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=a,this.window=l,this.document=u,this.Ii=p,this.Ei=g,this.di=v,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=T=>Promise.resolve(),!ym.D())throw new Ce(oe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new RA(this,o),this.gi=t+UA,this.serializer=new Qw(d),this.pi=new So(this.gi,this.di,new zA(this.serializer)),this.jr=new vA,this.Hr=new CA(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lE(this.serializer),this.Yr=new yA,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,g===!1&&Ft(fo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ce(oe.FAILED_PRECONDITION,Yf);return this.bi(),this.Si(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Hr.getHighestSequenceNumber(e))}).then(e=>{this.Gr=new Jn(e,this.Ii)}).then(()=>{this.zr=!0}).catch(e=>(this.pi&&this.pi.close(),Promise.reject(e)))}Ci(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget(async()=>{this.started&&await this.wi()}))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Wu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Fi(e).next(t=>{t||(this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Mi(e)).next(t=>this.isPrimary&&!t?this.xi(e).next(()=>!1):!!t&&this.Oi(e).next(()=>!0))).catch(e=>{if(ko(e))return ae(fo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ae(fo,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Fi(e){return bl(e).get(aa).next(t=>W.resolve(this.Ni(t)))}Bi(e){return Wu(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,Qf)){this.mi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=Jt(t,Ca);return n.G().next(o=>{const a=this.qi(o,Qf),l=o.filter(u=>a.indexOf(u)===-1);return W.forEach(l,u=>n.delete(u.clientId)).next(()=>l)})}).catch(()=>[]);if(this.yi)for(const t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Li()).then(()=>this.Di()))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?W.resolve(!0):bl(e).get(aa).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Xf)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new Ce(oe.FAILED_PRECONDITION,Yf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Wu(e).G().next(n=>this.qi(n,Xf).find(o=>{if(this.clientId!==o.clientId){const a=!this.networkEnabled&&o.networkEnabled,l=!this.inForeground&&o.inForeground,u=this.networkEnabled===o.networkEnabled;if(a||l&&u)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&ae(fo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.zr=!1,this.Ki(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ui(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[cc,Ca],e=>{const t=new yp(e,Jn.ae);return this.xi(t).next(()=>this.Bi(t))}),this.pi.close(),this.Gi()}qi(e,t){return e.filter(n=>this.ki(n.updateTimeMs,t)&&!this.$i(n.clientId))}zi(){return this.runTransaction("getActiveClients","readonly",e=>Wu(e).G().next(t=>this.qi(t,Qf).map(n=>n.clientId)))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return ed.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xA(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return Jh.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){ae(fo,"Starting transaction:",e);const o=t==="readonly"?"readonly":"readwrite",a=function(d){return d===17?wC:d===16?_C:d===15?rm:d===14?ow:d===13?sw:d===12?vC:d===11?rw:void Ae()}(this.di);let l;return this.pi.runTransaction(e,o,a,u=>(l=new yp(u,this.Gr?this.Gr.next():Jn.ae),t==="readwrite-primary"?this.Fi(l).next(d=>!!d||this.Mi(l)).next(d=>{if(!d)throw Ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)),new Ce(oe.FAILED_PRECONDITION,K0);return n(l)}).next(d=>this.Oi(l).next(()=>d)):this.ji(l).next(()=>n(l)))).then(u=>(l.raiseOnCommittedEvent(),u))}ji(e){return bl(e).get(aa).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Xf)&&!this.$i(t.ownerId)&&!this.Ni(t)&&!(this.Ei||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ce(oe.FAILED_PRECONDITION,Yf)})}Oi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bl(e).put(aa,t)}static D(){return So.D()}xi(e){const t=bl(e);return t.get(aa).next(n=>this.Ni(n)?(ae(fo,"Releasing primary lease."),t.delete(aa)):W.resolve())}ki(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Ft(`Detected an update time that is in the future: ${e} > ${n}`),!1))}bi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ri=()=>{this.Ti.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.wi()))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground=this.document.visibilityState==="visible")}Ui(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}Si(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ai=()=>{this.Ki();const t=/(?:Version|Mobile)\/1[456]/;x0()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{const n=((t=this.yi)===null||t===void 0?void 0:t.getItem(this.Qi(e)))!==null;return ae(fo,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ft(fo,"Failed to get zombied client id.",n),!1}}Ki(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){Ft("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch{}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function bl(r){return Jt(r,cc)}function Wu(r){return Jt(r,Ca)}function uE(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,t,n,o){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=o}static Yi(e,t){let n=Ge(),o=Ge();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new vm(e,t.fromCache,n,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return x0()?8:X0(lh())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,o){const a={result:null};return this.rs(e,t).next(l=>{a.result=l}).next(()=>{if(!a.result)return this.ss(e,t,o,n).next(l=>{a.result=l})}).next(()=>{if(a.result)return;const l=new $A;return this._s(e,t,l).next(u=>{if(a.result=u,this.Xi)return this.us(e,t,l,u.size)})}).next(()=>a.result)}us(e,t,n,o){return n.documentReadCount<this.es?(fa()<=tt.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",pa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),W.resolve()):(fa()<=tt.DEBUG&&ae("QueryEngine","Query:",pa(t),"scans",n.documentReadCount,"local documents and returns",o,"documents as results."),n.documentReadCount>this.ts*o?(fa()<=tt.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",pa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hr(t))):W.resolve())}rs(e,t){if(Bv(t))return W.resolve(null);let n=hr(t);return this.indexManager.getIndexType(e,n).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Ip(t,null,"F"),n=hr(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const l=Ge(...a);return this.ns.getDocuments(e,l).next(u=>this.indexManager.getMinOffset(e,n).next(d=>{const p=this.cs(t,u);return this.ls(t,p,l,d.readTime)?this.rs(e,Ip(t,null,"F")):this.hs(e,p,t,d)}))})))}ss(e,t,n,o){return Bv(t)||o.isEqual(Ve.min())?W.resolve(null):this.ns.getDocuments(e,n).next(a=>{const l=this.cs(t,a);return this.ls(t,l,n,o)?W.resolve(null):(fa()<=tt.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),pa(t)),this.hs(e,l,t,G0(o,Ta)).next(u=>u))})}cs(e,t){let n=new lt(Cw(e));return t.forEach((o,a)=>{dc(e,a)&&(n=n.add(a))}),n}ls(e,t,n,o){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}_s(e,t,n){return fa()<=tt.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",pa(t)),this.ns.getDocumentsMatchingQuery(e,t,dr.min(),n)}hs(e,t,n,o){return this.ns.getDocumentsMatchingQuery(e,n,o).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="LocalStore",qA=3e8;class WA{constructor(e,t,n,o){this.persistence=e,this.Ps=t,this.serializer=o,this.Ts=new Et(ze),this.Is=new js(a=>pi(a),hc),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cE(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function dE(r,e,t,n){return new WA(r,e,t,n)}async function fE(r,e){const t=ke(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let o;return t.mutationQueue.getAllMutationBatches(n).next(a=>(o=a,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(a=>{const l=[],u=[];let d=Ge();for(const p of o){l.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}for(const p of a){u.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}return t.localDocuments.getDocuments(n,d).next(p=>({Rs:p,removedBatchIds:l,addedBatchIds:u}))})})}function GA(r,e){const t=ke(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const o=e.batch.keys(),a=t.ds.newChangeBuffer({trackRemovals:!0});return function(u,d,p,g){const v=p.batch,T=v.keys();let S=W.resolve();return T.forEach(C=>{S=S.next(()=>g.getEntry(d,C)).next(D=>{const V=p.docVersions.get(C);be(V!==null),D.version.compareTo(V)<0&&(v.applyToRemoteDocument(D,p),D.isValidDocument()&&(D.setReadTime(p.commitVersion),g.addEntry(D)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(d,v))}(t,n,e,a).next(()=>a.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let d=Ge();for(let p=0;p<u.mutationResults.length;++p)u.mutationResults[p].transformResults.length>0&&(d=d.add(u.batch.mutations[p].key));return d}(e))).next(()=>t.localDocuments.getDocuments(n,o))})}function pE(r){const e=ke(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function HA(r,e){const t=ke(r),n=e.snapshotVersion;let o=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.ds.newChangeBuffer({trackRemovals:!0});o=t.Ts;const u=[];e.targetChanges.forEach((g,v)=>{const T=o.get(v);if(!T)return;u.push(t.Hr.removeMatchingKeys(a,g.removedDocuments,v).next(()=>t.Hr.addMatchingKeys(a,g.addedDocuments,v)));let S=T.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(Lt.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):g.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(g.resumeToken,n)),o=o.insert(v,S),function(D,V,q){return D.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=qA?!0:q.addedDocuments.size+q.modifiedDocuments.size+q.removedDocuments.size>0}(T,S,g)&&u.push(t.Hr.updateTargetData(a,S))});let d=Ar(),p=Ge();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))}),u.push(KA(a,l,e.documentUpdates).next(g=>{d=g.Vs,p=g.fs})),!n.isEqual(Ve.min())){const g=t.Hr.getLastRemoteSnapshotVersion(a).next(v=>t.Hr.setTargetsMetadata(a,a.currentSequenceNumber,n));u.push(g)}return W.waitFor(u).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,d,p)).next(()=>d)}).then(a=>(t.Ts=o,a))}function KA(r,e,t){let n=Ge(),o=Ge();return t.forEach(a=>n=n.add(a)),e.getEntries(r,n).next(a=>{let l=Ar();return t.forEach((u,d)=>{const p=a.get(u);d.isFoundDocument()!==p.isFoundDocument()&&(o=o.add(u)),d.isNoDocument()&&d.version.isEqual(Ve.min())?(e.removeEntry(u,d.readTime),l=l.insert(u,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),l=l.insert(u,d)):ae(_m,"Ignoring outdated watch update for ",u,". Current version:",p.version," Watch version:",d.version)}),{Vs:l,fs:o}})}function QA(r,e){const t=ke(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=ci),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Nh(r,e){const t=ke(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let o;return t.Hr.getTargetData(n,e).next(a=>a?(o=a,W.resolve(o)):t.Hr.allocateTargetId(n).next(l=>(o=new bs(e,l,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,o).next(()=>o))))}).then(n=>{const o=t.Ts.get(n.targetId);return(o===null||n.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function ba(r,e,t){const n=ke(r),o=n.Ts.get(e),a=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",a,l=>n.persistence.referenceDelegate.removeTarget(l,o))}catch(l){if(!ko(l))throw l;ae(_m,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ts=n.Ts.remove(e),n.Is.delete(o.target)}function Pp(r,e,t){const n=ke(r);let o=Ve.min(),a=Ge();return n.persistence.runTransaction("Execute query","readwrite",l=>function(d,p,g){const v=ke(d),T=v.Is.get(g);return T!==void 0?W.resolve(v.Ts.get(T)):v.Hr.getTargetData(p,g)}(n,l,hr(e)).next(u=>{if(u)return o=u.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(l,u.targetId).next(d=>{a=d})}).next(()=>n.Ps.getDocumentsMatchingQuery(l,e,t?o:Ve.min(),t?a:Ge())).next(u=>(yE(n,xw(e),u),{documents:u,gs:a})))}function mE(r,e){const t=ke(r),n=ke(t.Hr),o=t.Ts.get(e);return o?Promise.resolve(o.target):t.persistence.runTransaction("Get target data","readonly",a=>n.lt(a,e).next(l=>l?l.target:null))}function gE(r,e){const t=ke(r),n=t.Es.get(e)||Ve.min();return t.persistence.runTransaction("Get new document changes","readonly",o=>t.ds.getAllFromCollectionGroup(o,e,G0(n,Ta),Number.MAX_SAFE_INTEGER)).then(o=>(yE(t,e,o),o))}function yE(r,e,t){let n=r.Es.get(e)||Ve.min();t.forEach((o,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),r.Es.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE="firestore_clients";function g_(r,e){return`${vE}_${r}_${e}`}const _E="firestore_mutations";function y_(r,e,t){let n=`${_E}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const wE="firestore_targets";function Zf(r,e){return`${wE}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="SharedClientState";class Rh{constructor(e,t,n,o){this.user=e,this.batchId=t,this.state=n,this.error=o}static bs(e,t,n){const o=JSON.parse(n);let a,l=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return l&&o.error&&(l=typeof o.error.message=="string"&&typeof o.error.code=="string",l&&(a=new Ce(o.error.code,o.error.message))),l?new Rh(e,t,o.state,a):(Ft(is,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class $l{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static bs(e,t){const n=JSON.parse(t);let o,a=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return a&&n.error&&(a=typeof n.error.message=="string"&&typeof n.error.code=="string",a&&(o=new Ce(n.error.code,n.error.message))),a?new $l(e,n.state,o):(Ft(is,`Failed to parse target state for ID '${e}': ${t}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class kh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static bs(e,t){const n=JSON.parse(t);let o=typeof n=="object"&&n.activeTargetIds instanceof Array,a=am();for(let l=0;o&&l<n.activeTargetIds.length;++l)o=Kx(n.activeTargetIds[l]),a=a.add(n.activeTargetIds[l]);return o?new kh(e,a):(Ft(is,`Failed to parse client data for instance '${e}': ${t}`),null)}}class wm{constructor(e,t){this.clientId=e,this.onlineState=t}static bs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new wm(t.clientId,t.onlineState):(Ft(is,`Failed to parse online state: ${e}`),null)}}class bp{constructor(){this.activeTargetIds=am()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ss(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jf{constructor(e,t,n,o,a){this.window=e,this.Ti=t,this.persistenceKey=n,this.Cs=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Fs=this.Ms.bind(this),this.xs=new Et(ze),this.started=!1,this.Os=[];const l=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.Ns=g_(this.persistenceKey,this.Cs),this.Bs=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.xs=this.xs.insert(this.Cs,new bp),this.Ls=new RegExp(`^${vE}_${l}_([^_]*)$`),this.ks=new RegExp(`^${_E}_${l}_(\\d+)(?:_(.*))?$`),this.qs=new RegExp(`^${wE}_${l}_(\\d+)$`),this.Qs=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.$s=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.Fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.zi();for(const n of e){if(n===this.Cs)continue;const o=this.getItem(g_(this.persistenceKey,n));if(o){const a=kh.bs(n,o);a&&(this.xs=this.xs.insert(a.clientId,a))}}this.Ks();const t=this.storage.getItem(this.Qs);if(t){const n=this.Us(t);n&&this.Ws(n)}for(const n of this.Os)this.Ms(n);this.Os=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Bs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.xs)}isActiveQueryTarget(e){let t=!1;return this.xs.forEach((n,o)=>{o.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,n){this.zs(e,t,n),this.js(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const o=this.storage.getItem(Zf(this.persistenceKey,e));if(o){const a=$l.bs(e,o);a&&(n=a.state)}}return t&&this.Hs.Ds(e),this.Ks(),n}removeLocalQueryTarget(e){this.Hs.vs(e),this.Ks()}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zf(this.persistenceKey,e))}updateQueryState(e,t,n){this.Js(e,t,n)}handleUserChange(e,t,n){t.forEach(o=>{this.js(o)}),this.currentUser=e,n.forEach(o=>{this.addPendingMutation(o)})}setOnlineState(e){this.Ys(e)}notifyBundleLoaded(e){this.Zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Fs),this.removeItem(this.Ns),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ae(is,"READ",e,t),t}setItem(e,t){ae(is,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ae(is,"REMOVE",e),this.storage.removeItem(e)}Ms(e){const t=e;if(t.storageArea===this.storage){if(ae(is,"EVENT",t.key,t.newValue),t.key===this.Ns)return void Ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ti.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ls.test(t.key)){if(t.newValue==null){const n=this.Xs(t.key);return this.eo(n,null)}{const n=this.no(t.key,t.newValue);if(n)return this.eo(n.clientId,n)}}else if(this.ks.test(t.key)){if(t.newValue!==null){const n=this.ro(t.key,t.newValue);if(n)return this.io(n)}}else if(this.qs.test(t.key)){if(t.newValue!==null){const n=this.so(t.key,t.newValue);if(n)return this.oo(n)}}else if(t.key===this.Qs){if(t.newValue!==null){const n=this.Us(t.newValue);if(n)return this.Ws(n)}}else if(t.key===this.Bs){const n=function(a){let l=Jn.ae;if(a!=null)try{const u=JSON.parse(a);be(typeof u=="number"),l=u}catch(u){Ft(is,"Failed to read sequence number from WebStorage",u)}return l}(t.newValue);n!==Jn.ae&&this.sequenceNumberHandler(n)}else if(t.key===this.$s){const n=this._o(t.newValue);await Promise.all(n.map(o=>this.syncEngine.ao(o)))}}}else this.Os.push(t)})}}get Hs(){return this.xs.get(this.Cs)}Ks(){this.setItem(this.Ns,this.Hs.Ss())}zs(e,t,n){const o=new Rh(this.currentUser,e,t,n),a=y_(this.persistenceKey,this.currentUser,e);this.setItem(a,o.Ss())}js(e){const t=y_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ys(e){const t={clientId:this.Cs,onlineState:e};this.storage.setItem(this.Qs,JSON.stringify(t))}Js(e,t,n){const o=Zf(this.persistenceKey,e),a=new $l(e,t,n);this.setItem(o,a.Ss())}Zs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.$s,t)}Xs(e){const t=this.Ls.exec(e);return t?t[1]:null}no(e,t){const n=this.Xs(e);return kh.bs(n,t)}ro(e,t){const n=this.ks.exec(e),o=Number(n[1]),a=n[2]!==void 0?n[2]:null;return Rh.bs(new An(a),o,t)}so(e,t){const n=this.qs.exec(e),o=Number(n[1]);return $l.bs(o,t)}Us(e){return wm.bs(e)}_o(e){return JSON.parse(e)}async io(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.uo(e.batchId,e.state,e.error);ae(is,`Ignoring mutation for non-active user ${e.user.uid}`)}oo(e){return this.syncEngine.co(e.targetId,e.state,e.error)}eo(e,t){const n=t?this.xs.insert(e,t):this.xs.remove(e),o=this.Gs(this.xs),a=this.Gs(n),l=[],u=[];return a.forEach(d=>{o.has(d)||l.push(d)}),o.forEach(d=>{a.has(d)||u.push(d)}),this.syncEngine.lo(l,u).then(()=>{this.xs=n})}Ws(e){this.xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=am();return e.forEach((n,o)=>{t=t.unionWith(o.activeTargetIds)}),t}}class EE{constructor(){this.ho=new bp,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new bp,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="ConnectivityMonitor";class __{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){ae(v_,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){ae(v_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gu=null;function Dp(){return Gu===null?Gu=function(){return 268435456+Math.round(2147483648*Math.random())}():Gu++,"0x"+Gu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep="RestConnection",YA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ZA{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${o}`,this.wo=this.databaseId.database===yh?`project_id=${n}`:`project_id=${n}&database_id=${o}`}bo(e,t,n,o,a){const l=Dp(),u=this.So(e,t.toUriEncodedString());ae(ep,`Sending RPC '${e}' ${l}:`,u,n);const d={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(d,o,a),this.vo(e,u,d,n).then(p=>(ae(ep,`Received RPC '${e}' ${l}: `,p),p),p=>{throw Gl(ep,`RPC '${e}' ${l} failed with error: `,p,"url: ",u,"request:",n),p})}Co(e,t,n,o,a,l){return this.bo(e,t,n,o,a)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ja}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,a)=>e[a]=o),n&&n.headers.forEach((o,a)=>e[a]=o)}So(e,t){const n=YA[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Ko(e){this.ko(e)}Uo(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn="WebChannelConnection";class eN extends ZA{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,o){const a=Dp();return new Promise((l,u)=>{const d=new L0;d.setWithCredentials(!0),d.listenOnce(B0.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Xu.NO_ERROR:const g=d.getResponseJson();ae(Cn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),l(g);break;case Xu.TIMEOUT:ae(Cn,`RPC '${e}' ${a} timed out`),u(new Ce(oe.DEADLINE_EXCEEDED,"Request time out"));break;case Xu.HTTP_ERROR:const v=d.getStatus();if(ae(Cn,`RPC '${e}' ${a} failed with status:`,v,"response text:",d.getResponseText()),v>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T==null?void 0:T.error;if(S&&S.status&&S.message){const C=function(V){const q=V.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(q)>=0?q:oe.UNKNOWN}(S.status);u(new Ce(C,S.message))}else u(new Ce(oe.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Ce(oe.UNAVAILABLE,"Connection failed."));break;default:Ae()}}finally{ae(Cn,`RPC '${e}' ${a} completed.`)}});const p=JSON.stringify(o);ae(Cn,`RPC '${e}' ${a} sending request:`,o),d.send(t,"POST",p,n,15)})}Wo(e,t,n){const o=Dp(),a=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=$0(),u=U0(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Do(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const g=a.join("");ae(Cn,`Creating RPC '${e}' stream ${o}: ${g}`,d);const v=l.createWebChannel(g,d);let T=!1,S=!1;const C=new JA({Fo:V=>{S?ae(Cn,`Not sending because RPC '${e}' stream ${o} is closed:`,V):(T||(ae(Cn,`Opening RPC '${e}' stream ${o} transport.`),v.open(),T=!0),ae(Cn,`RPC '${e}' stream ${o} sending:`,V),v.send(V))},Mo:()=>v.close()}),D=(V,q,L)=>{V.listen(q,U=>{try{L(U)}catch(X){setTimeout(()=>{throw X},0)}})};return D(v,Dl.EventType.OPEN,()=>{S||(ae(Cn,`RPC '${e}' stream ${o} transport opened.`),C.Qo())}),D(v,Dl.EventType.CLOSE,()=>{S||(S=!0,ae(Cn,`RPC '${e}' stream ${o} transport closed`),C.Ko())}),D(v,Dl.EventType.ERROR,V=>{S||(S=!0,Gl(Cn,`RPC '${e}' stream ${o} transport errored:`,V),C.Ko(new Ce(oe.UNAVAILABLE,"The operation could not be completed")))}),D(v,Dl.EventType.MESSAGE,V=>{var q;if(!S){const L=V.data[0];be(!!L);const U=L,X=(U==null?void 0:U.error)||((q=U[0])===null||q===void 0?void 0:q.error);if(X){ae(Cn,`RPC '${e}' stream ${o} received error:`,X);const O=X.status;let B=function(N){const P=qt[N];if(P!==void 0)return Mw(P)}(O),A=X.message;B===void 0&&(B=oe.INTERNAL,A="Unknown error status: "+O+" with message "+X.message),S=!0,C.Ko(new Ce(B,A)),v.close()}else ae(Cn,`RPC '${e}' stream ${o} received:`,L),C.Uo(L)}}),D(u,z0.STAT_EVENT,V=>{V.stat===dp.PROXY?ae(Cn,`RPC '${e}' stream ${o} detected buffering proxy`):V.stat===dp.NOPROXY&&ae(Cn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{C.$o()},0),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(){return typeof window<"u"?window:null}function sh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(r){return new oA(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t,n=1e3,o=1.5,a=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=o,this.jo=a,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),o=Math.max(0,t-n);o>0&&ae("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,o,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w_="PersistentStream";class xE{constructor(e,t,n,o,a,l,u,d){this.Ti=e,this.n_=n,this.r_=o,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new SE(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===oe.RESOURCE_EXHAUSTED?(Ft(t.toString()),Ft("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,o])=>{this.i_===t&&this.V_(n,o)},n=>{e(()=>{const o=new Ce(oe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(o)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(o=>{n(()=>this.m_(o))}),this.stream.onMessage(o=>{n(()=>++this.__==1?this.g_(o):this.onNext(o))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return ae(w_,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(ae(w_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tN extends xE{constructor(e,t,n,o,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,o,l),this.serializer=a}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=cA(this.serializer,e),n=function(a){if(!("targetChange"in a))return Ve.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Ve.min():l.readTime?Bn(l.readTime):Ve.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Cp(this.serializer),t.addTarget=function(a,l){let u;const d=l.target;if(u=_h(d)?{documents:$w(a,d)}:{query:qw(a,d).ht},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=iA(a,l.resumeToken);const p=Sp(a,l.expectedCount);p!==null&&(u.expectedCount=p)}else if(l.snapshotVersion.compareTo(Ve.min())>0){u.readTime=Eh(a,l.snapshotVersion.toTimestamp());const p=Sp(a,l.expectedCount);p!==null&&(u.expectedCount=p)}return u}(this.serializer,e);const n=hA(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Cp(this.serializer),t.removeTarget=e,this.I_(t)}}class nN extends xE{constructor(e,t,n,o,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,o,l),this.serializer=a}get b_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.b_&&this.S_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return be(!!e.streamToken),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=uA(e.writeResults,e.commitTime),n=Bn(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Cp(this.serializer),this.I_(e)}S_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Ih(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{}class sN extends rN{constructor(e,t,n,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=o,this.F_=!1}M_(){if(this.F_)throw new Ce(oe.FAILED_PRECONDITION,"The client has already been terminated.")}bo(e,t,n,o){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.bo(e,xp(t,n),o,a,l)).catch(a=>{throw a.name==="FirebaseError"?(a.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ce(oe.UNKNOWN,a.toString())})}Co(e,t,n,o,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,u])=>this.connection.Co(e,xp(t,n),o,l,u,a)).catch(l=>{throw l.name==="FirebaseError"?(l.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ce(oe.UNKNOWN,l.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class oN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Ft(t),this.N_=!1):ae("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi="RemoteStore";class iN{constructor(e,t,n,o,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=a,this.z_.To(l=>{n.enqueueAndForget(async()=>{Ei(this)&&(ae(vi,"Restarting streams for network reachability change."),await async function(d){const p=ke(d);p.W_.add(4),await gc(p),p.j_.set("Unknown"),p.W_.delete(4),await nd(p)}(this))})}),this.j_=new oN(n,o)}}async function nd(r){if(Ei(r))for(const e of r.G_)await e(!0)}async function gc(r){for(const e of r.G_)await e(!1)}function rd(r,e){const t=ke(r);t.U_.has(e.targetId)||(t.U_.set(e.targetId,e),Im(t)?Tm(t):Ba(t).c_()&&Em(t,e))}function Da(r,e){const t=ke(r),n=Ba(t);t.U_.delete(e),n.c_()&&CE(t,e),t.U_.size===0&&(n.c_()?n.P_():Ei(t)&&t.j_.set("Unknown"))}function Em(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ba(r).y_(e)}function CE(r,e){r.H_.Ne(e),Ba(r).w_(e)}function Tm(r){r.H_=new tA({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.U_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),Ba(r).start(),r.j_.B_()}function Im(r){return Ei(r)&&!Ba(r).u_()&&r.U_.size>0}function Ei(r){return ke(r).W_.size===0}function AE(r){r.H_=void 0}async function aN(r){r.j_.set("Online")}async function lN(r){r.U_.forEach((e,t)=>{Em(r,e)})}async function cN(r,e){AE(r),Im(r)?(r.j_.q_(e),Tm(r)):r.j_.set("Unknown")}async function uN(r,e,t){if(r.j_.set("Online"),e instanceof Fw&&e.state===2&&e.cause)try{await async function(o,a){const l=a.cause;for(const u of a.targetIds)o.U_.has(u)&&(await o.remoteSyncer.rejectListen(u,l),o.U_.delete(u),o.H_.removeTarget(u))}(r,e)}catch(n){ae(vi,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ph(r,n)}else if(e instanceof rh?r.H_.We(e):e instanceof Ow?r.H_.Ze(e):r.H_.je(e),!t.isEqual(Ve.min()))try{const n=await pE(r.localStore);t.compareTo(n)>=0&&await function(a,l){const u=a.H_.ot(l);return u.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const g=a.U_.get(p);g&&a.U_.set(p,g.withResumeToken(d.resumeToken,l))}}),u.targetMismatches.forEach((d,p)=>{const g=a.U_.get(d);if(!g)return;a.U_.set(d,g.withResumeToken(Lt.EMPTY_BYTE_STRING,g.snapshotVersion)),CE(a,d);const v=new bs(g.target,d,p,g.sequenceNumber);Em(a,v)}),a.remoteSyncer.applyRemoteEvent(u)}(r,t)}catch(n){ae(vi,"Failed to raise snapshot:",n),await Ph(r,n)}}async function Ph(r,e,t){if(!ko(e))throw e;r.W_.add(1),await gc(r),r.j_.set("Offline"),t||(t=()=>pE(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{ae(vi,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await nd(r)})}function NE(r,e){return e().catch(t=>Ph(r,t,e))}async function yc(r){const e=ke(r),t=Ao(e);let n=e.K_.length>0?e.K_[e.K_.length-1].batchId:ci;for(;hN(e);)try{const o=await QA(e.localStore,n);if(o===null){e.K_.length===0&&t.P_();break}n=o.batchId,dN(e,o)}catch(o){await Ph(e,o)}RE(e)&&kE(e)}function hN(r){return Ei(r)&&r.K_.length<10}function dN(r,e){r.K_.push(e);const t=Ao(r);t.c_()&&t.b_&&t.S_(e.mutations)}function RE(r){return Ei(r)&&!Ao(r).u_()&&r.K_.length>0}function kE(r){Ao(r).start()}async function fN(r){Ao(r).C_()}async function pN(r){const e=Ao(r);for(const t of r.K_)e.S_(t.mutations)}async function mN(r,e,t){const n=r.K_.shift(),o=um.from(n,e,t);await NE(r,()=>r.remoteSyncer.applySuccessfulWrite(o)),await yc(r)}async function gN(r,e){e&&Ao(r).b_&&await async function(n,o){if(function(l){return ZC(l)&&l!==oe.ABORTED}(o.code)){const a=n.K_.shift();Ao(n).h_(),await NE(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,o)),await yc(n)}}(r,e),RE(r)&&kE(r)}async function E_(r,e){const t=ke(r);t.asyncQueue.verifyOperationInProgress(),ae(vi,"RemoteStore received new credentials");const n=Ei(t);t.W_.add(3),await gc(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await nd(t)}async function Vp(r,e){const t=ke(r);e?(t.W_.delete(2),await nd(t)):e||(t.W_.add(2),await gc(t),t.j_.set("Unknown"))}function Ba(r){return r.J_||(r.J_=function(t,n,o){const a=ke(t);return a.M_(),new tN(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(r.datastore,r.asyncQueue,{xo:aN.bind(null,r),No:lN.bind(null,r),Lo:cN.bind(null,r),p_:uN.bind(null,r)}),r.G_.push(async e=>{e?(r.J_.h_(),Im(r)?Tm(r):r.j_.set("Unknown")):(await r.J_.stop(),AE(r))})),r.J_}function Ao(r){return r.Y_||(r.Y_=function(t,n,o){const a=ke(t);return a.M_(),new nN(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:fN.bind(null,r),Lo:gN.bind(null,r),D_:pN.bind(null,r),v_:mN.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await yc(r)):(await r.Y_.stop(),r.K_.length>0&&(ae(vi,`Stopping write stream with ${r.K_.length} pending writes`),r.K_=[]))})),r.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,t,n,o,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=o,this.removalCallback=a,this.deferred=new Io,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,o,a){const l=Date.now()+n,u=new Sm(e,t,l,o,a);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function PE(r,e){if(Ft("AsyncQueue",`${e}: ${r}`),ko(r))return new Ce(oe.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{static emptySet(e){return new _a(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||_e.comparator(t.key,n.key):(t,n)=>_e.comparator(t.key,n.key),this.keyedMap=Vl(),this.sortedSet=new Et(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _a)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=n.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new _a;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(){this.Z_=new Et(_e.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):Ae():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}}class Va{constructor(e,t,n,o,a,l,u,d,p){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=o,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,t,n,o,a){const l=[];return t.forEach(u=>{l.push({type:0,doc:u})}),new Va(e,t,_a.emptySet(t),l,n,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==n[o].type||!t[o].doc.isEqual(n[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class vN{constructor(){this.queries=I_(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const o=ke(t),a=o.queries;o.queries=I_(),a.forEach((l,u)=>{for(const d of u.ta)d.onError(n)})})(this,new Ce(oe.ABORTED,"Firestore shutting down"))}}function I_(){return new js(r=>Sw(r),Xh)}async function _N(r,e){const t=ke(r);let n=3;const o=e.query;let a=t.queries.get(o);a?!a.na()&&e.ra()&&(n=2):(a=new yN,n=e.ra()?0:1);try{switch(n){case 0:a.ea=await t.onListen(o,!0);break;case 1:a.ea=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(l){const u=PE(l,`Initialization of query '${pa(e.query)}' failed`);return void e.onError(u)}t.queries.set(o,a),a.ta.push(e),e.sa(t.onlineState),a.ea&&e.oa(a.ea)&&xm(t)}async function wN(r,e){const t=ke(r),n=e.query;let o=3;const a=t.queries.get(n);if(a){const l=a.ta.indexOf(e);l>=0&&(a.ta.splice(l,1),a.ta.length===0?o=e.ra()?0:1:!a.na()&&e.ra()&&(o=2))}switch(o){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function EN(r,e){const t=ke(r);let n=!1;for(const o of e){const a=o.query,l=t.queries.get(a);if(l){for(const u of l.ta)u.oa(o)&&(n=!0);l.ea=o}}n&&xm(t)}function TN(r,e,t){const n=ke(r),o=n.queries.get(e);if(o)for(const a of o.ta)a.onError(t);n.queries.delete(e)}function xm(r){r.ia.forEach(e=>{e.next()})}var Mp,S_;(S_=Mp||(Mp={}))._a="default",S_.Cache="cache";class IN{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const o of e.docChanges)o.type!==3&&n.push(o);e=new Va(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=Va.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Mp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e){this.key=e}}class DE{constructor(e){this.key=e}}class SN{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Ge(),this.mutatedKeys=Ge(),this.ya=Cw(e),this.wa=new _a(this.ya)}get ba(){return this.fa}Sa(e,t){const n=t?t.Da:new T_,o=t?t.wa:this.wa;let a=t?t.mutatedKeys:this.mutatedKeys,l=o,u=!1;const d=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,p=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((g,v)=>{const T=o.get(g),S=dc(this.query,v)?v:null,C=!!T&&this.mutatedKeys.has(T.key),D=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let V=!1;T&&S?T.data.isEqual(S.data)?C!==D&&(n.track({type:3,doc:S}),V=!0):this.va(T,S)||(n.track({type:2,doc:S}),V=!0,(d&&this.ya(S,d)>0||p&&this.ya(S,p)<0)&&(u=!0)):!T&&S?(n.track({type:0,doc:S}),V=!0):T&&!S&&(n.track({type:1,doc:T}),V=!0,(d||p)&&(u=!0)),V&&(S?(l=l.add(S),a=D?a.add(g):a.delete(g)):(l=l.delete(g),a=a.delete(g)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),a=a.delete(g.key),n.track({type:1,doc:g})}return{wa:l,Da:n,ls:u,mutatedKeys:a}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,o){const a=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const l=e.Da.X_();l.sort((g,v)=>function(S,C){const D=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae()}};return D(S)-D(C)}(g.type,v.type)||this.ya(g.doc,v.doc)),this.Ca(n),o=o!=null&&o;const u=t&&!o?this.Fa():[],d=this.pa.size===0&&this.current&&!o?1:0,p=d!==this.ga;return this.ga=d,l.length!==0||p?{snapshot:new Va(this.query,e.wa,a,l,e.mutatedKeys,d===0,p,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:u}:{Ma:u}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new T_,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Ge(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new DE(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new bE(n))}),t}Oa(e){this.fa=e.gs,this.pa=Ge();const t=this.Sa(e.documents);return this.applyChanges(t,!0)}Na(){return Va.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const za="SyncEngine";class xN{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class CN{constructor(e){this.key=e,this.Ba=!1}}class AN{constructor(e,t,n,o,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.La={},this.ka=new js(u=>Sw(u),Xh),this.qa=new Map,this.Qa=new Set,this.$a=new Et(_e.comparator),this.Ka=new Map,this.Ua=new mm,this.Wa={},this.Ga=new Map,this.za=yi.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function NN(r,e,t=!0){const n=sd(r);let o;const a=n.ka.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),o=a.view.Na()):o=await VE(n,e,t,!0),o}async function RN(r,e){const t=sd(r);await VE(t,e,!0,!1)}async function VE(r,e,t,n){const o=await Nh(r.localStore,hr(e)),a=o.targetId,l=r.sharedClientState.addLocalQueryTarget(a,t);let u;return n&&(u=await Cm(r,e,a,l==="current",o.resumeToken)),r.isPrimaryClient&&t&&rd(r.remoteStore,o),u}async function Cm(r,e,t,n,o){r.Ha=(v,T,S)=>async function(D,V,q,L){let U=V.view.Sa(q);U.ls&&(U=await Pp(D.localStore,V.query,!1).then(({documents:A})=>V.view.Sa(A,U)));const X=L&&L.targetChanges.get(V.targetId),O=L&&L.targetMismatches.get(V.targetId)!=null,B=V.view.applyChanges(U,D.isPrimaryClient,X,O);return Op(D,V.targetId,B.Ma),B.snapshot}(r,v,T,S);const a=await Pp(r.localStore,e,!0),l=new SN(e,a.gs),u=l.Sa(a.documents),d=mc.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",o),p=l.applyChanges(u,r.isPrimaryClient,d);Op(r,t,p.Ma);const g=new xN(e,t,l);return r.ka.set(e,g),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),p.snapshot}async function kN(r,e,t){const n=ke(r),o=n.ka.get(e),a=n.qa.get(o.targetId);if(a.length>1)return n.qa.set(o.targetId,a.filter(l=>!Xh(l,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(o.targetId),n.sharedClientState.isActiveQueryTarget(o.targetId)||await ba(n.localStore,o.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(o.targetId),t&&Da(n.remoteStore,o.targetId),Ma(n,o.targetId)}).catch(Ro)):(Ma(n,o.targetId),await ba(n.localStore,o.targetId,!0))}async function PN(r,e){const t=ke(r),n=t.ka.get(e),o=t.qa.get(n.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Da(t.remoteStore,n.targetId))}async function ME(r,e){const t=ke(r);try{const n=await HA(t.localStore,e);e.targetChanges.forEach((o,a)=>{const l=t.Ka.get(a);l&&(be(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1),o.addedDocuments.size>0?l.Ba=!0:o.modifiedDocuments.size>0?be(l.Ba):o.removedDocuments.size>0&&(be(l.Ba),l.Ba=!1))}),await Ti(t,n,e)}catch(n){await Ro(n)}}function x_(r,e,t){const n=ke(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const o=[];n.ka.forEach((a,l)=>{const u=l.view.sa(e);u.snapshot&&o.push(u.snapshot)}),function(l,u){const d=ke(l);d.onlineState=u;let p=!1;d.queries.forEach((g,v)=>{for(const T of v.ta)T.sa(u)&&(p=!0)}),p&&xm(d)}(n.eventManager,e),o.length&&n.La.p_(o),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function bN(r,e,t){const n=ke(r);n.sharedClientState.updateQueryState(e,"rejected",t);const o=n.Ka.get(e),a=o&&o.key;if(a){let l=new Et(_e.comparator);l=l.insert(a,bt.newNoDocument(a,Ve.min()));const u=Ge().add(a),d=new pc(Ve.min(),new Map,new Et(ze),l,u);await ME(n,d),n.$a=n.$a.remove(a),n.Ka.delete(e),Rm(n)}else await ba(n.localStore,e,!1).then(()=>Ma(n,e,t)).catch(Ro)}async function DN(r,e){const t=ke(r),n=e.batch.batchId;try{const o=await GA(t.localStore,e);Nm(t,n,null),Am(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Ti(t,o)}catch(o){await Ro(o)}}async function VN(r,e,t){const n=ke(r);try{const o=await function(l,u){const d=ke(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let g;return d.mutationQueue.lookupMutationBatch(p,u).next(v=>(be(v!==null),g=v.keys(),d.mutationQueue.removeMutationBatch(p,v))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,g,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g)).next(()=>d.localDocuments.getDocuments(p,g))})}(n.localStore,e);Nm(n,e,t),Am(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Ti(n,o)}catch(o){await Ro(o)}}function Am(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function Nm(r,e,t){const n=ke(r);let o=n.Wa[n.currentUser.toKey()];if(o){const a=o.get(e);a&&(t?a.reject(t):a.resolve(),o=o.remove(e)),n.Wa[n.currentUser.toKey()]=o}}function Ma(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ua.Sr(e).forEach(n=>{r.Ua.containsKey(n)||OE(r,n)})}function OE(r,e){r.Qa.delete(e.path.canonicalString());const t=r.$a.get(e);t!==null&&(Da(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ka.delete(t),Rm(r))}function Op(r,e,t){for(const n of t)n instanceof bE?(r.Ua.addReference(n.key,e),MN(r,n)):n instanceof DE?(ae(za,"Document no longer in limbo: "+n.key),r.Ua.removeReference(n.key,e),r.Ua.containsKey(n.key)||OE(r,n.key)):Ae()}function MN(r,e){const t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(ae(za,"New document in limbo: "+t),r.Qa.add(n),Rm(r))}function Rm(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){const e=r.Qa.values().next().value;r.Qa.delete(e);const t=new _e(gt.fromString(e)),n=r.za.next();r.Ka.set(n,new CN(t)),r.$a=r.$a.insert(t,n),rd(r.remoteStore,new bs(hr(Qh(t.path)),n,"TargetPurposeLimboResolution",Jn.ae))}}async function Ti(r,e,t){const n=ke(r),o=[],a=[],l=[];n.ka.isEmpty()||(n.ka.forEach((u,d)=>{l.push(n.Ha(d,e,t).then(p=>{var g;if((p||t)&&n.isPrimaryClient){const v=p?!p.fromCache:(g=t==null?void 0:t.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(d.targetId,v?"current":"not-current")}if(p){o.push(p);const v=vm.Yi(d.targetId,p);a.push(v)}}))}),await Promise.all(l),n.La.p_(o),await async function(d,p){const g=ke(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>W.forEach(p,T=>W.forEach(T.Hi,S=>g.persistence.referenceDelegate.addReference(v,T.targetId,S)).next(()=>W.forEach(T.Ji,S=>g.persistence.referenceDelegate.removeReference(v,T.targetId,S)))))}catch(v){if(!ko(v))throw v;ae(_m,"Failed to update sequence numbers: "+v)}for(const v of p){const T=v.targetId;if(!v.fromCache){const S=g.Ts.get(T),C=S.snapshotVersion,D=S.withLastLimboFreeSnapshotVersion(C);g.Ts=g.Ts.insert(T,D)}}}(n.localStore,a))}async function ON(r,e){const t=ke(r);if(!t.currentUser.isEqual(e)){ae(za,"User change. New user:",e.toKey());const n=await fE(t.localStore,e);t.currentUser=e,function(a,l){a.Ga.forEach(u=>{u.forEach(d=>{d.reject(new Ce(oe.CANCELLED,l))})}),a.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ti(t,n.Rs)}}function FN(r,e){const t=ke(r),n=t.Ka.get(e);if(n&&n.Ba)return Ge().add(n.key);{let o=Ge();const a=t.qa.get(e);if(!a)return o;for(const l of a){const u=t.ka.get(l);o=o.unionWith(u.view.ba)}return o}}async function jN(r,e){const t=ke(r),n=await Pp(t.localStore,e.query,!0),o=e.view.Oa(n);return t.isPrimaryClient&&Op(t,e.targetId,o.Ma),o}async function LN(r,e){const t=ke(r);return gE(t.localStore,e).then(n=>Ti(t,n))}async function BN(r,e,t,n){const o=ke(r),a=await function(u,d){const p=ke(u),g=ke(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",v=>g.Ln(v,d).next(T=>T?p.localDocuments.getDocuments(v,T):W.resolve(null)))}(o.localStore,e);a!==null?(t==="pending"?await yc(o.remoteStore):t==="acknowledged"||t==="rejected"?(Nm(o,e,n||null),Am(o,e),function(u,d){ke(ke(u).mutationQueue).qn(d)}(o.localStore,e)):Ae(),await Ti(o,a)):ae(za,"Cannot apply mutation batch with id: "+e)}async function zN(r,e){const t=ke(r);if(sd(t),jE(t),e===!0&&t.ja!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),o=await C_(t,n.toArray());t.ja=!0,await Vp(t.remoteStore,!0);for(const a of o)rd(t.remoteStore,a)}else if(e===!1&&t.ja!==!1){const n=[];let o=Promise.resolve();t.qa.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?n.push(l):o=o.then(()=>(Ma(t,l),ba(t.localStore,l,!0))),Da(t.remoteStore,l)}),await o,await C_(t,n),function(l){const u=ke(l);u.Ka.forEach((d,p)=>{Da(u.remoteStore,p)}),u.Ua.Dr(),u.Ka=new Map,u.$a=new Et(_e.comparator)}(t),t.ja=!1,await Vp(t.remoteStore,!1)}}async function C_(r,e,t){const n=ke(r),o=[],a=[];for(const l of e){let u;const d=n.qa.get(l);if(d&&d.length!==0){u=await Nh(n.localStore,hr(d[0]));for(const p of d){const g=n.ka.get(p),v=await jN(n,g);v.snapshot&&a.push(v.snapshot)}}else{const p=await mE(n.localStore,l);u=await Nh(n.localStore,p),await Cm(n,FE(p),l,!1,u.resumeToken)}o.push(u)}return n.La.p_(a),o}function FE(r){return Iw(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function UN(r){return function(t){return ke(ke(t).persistence).zi()}(ke(r).localStore)}async function $N(r,e,t,n){const o=ke(r);if(o.ja)return void ae(za,"Ignoring unexpected query state notification.");const a=o.qa.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await gE(o.localStore,xw(a[0])),u=pc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Lt.EMPTY_BYTE_STRING);await Ti(o,l,u);break}case"rejected":await ba(o.localStore,e,!0),Ma(o,e,n);break;default:Ae()}}async function qN(r,e,t){const n=sd(r);if(n.ja){for(const o of e){if(n.qa.has(o)&&n.sharedClientState.isActiveQueryTarget(o)){ae(za,"Adding an already active target "+o);continue}const a=await mE(n.localStore,o),l=await Nh(n.localStore,a);await Cm(n,FE(a),l.targetId,!1,l.resumeToken),rd(n.remoteStore,l)}for(const o of t)n.qa.has(o)&&await ba(n.localStore,o,!1).then(()=>{Da(n.remoteStore,o),Ma(n,o)}).catch(Ro)}}function sd(r){const e=ke(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=ME.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=FN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bN.bind(null,e),e.La.p_=EN.bind(null,e.eventManager),e.La.Ja=TN.bind(null,e.eventManager),e}function jE(r){const e=ke(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=DN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VN.bind(null,e),e}class sc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=IE(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return dE(this.persistence,new hE,e.initialUser,this.serializer)}Xa(e){return new gm(td.ri,this.serializer)}Za(e){return new EE}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sc.provider={build:()=>new sc};class WN extends sc{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){be(this.persistence.referenceDelegate instanceof Ah);const n=this.persistence.referenceDelegate.garbageCollector;return new oE(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new gm(n=>Ah.ri(n,t),this.serializer)}}class LE extends sc{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await jE(this.ru.syncEngine),await yc(this.ru.remoteStore),await this.persistence.Ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}eu(e){return dE(this.persistence,new hE,e.initialUser,this.serializer)}tu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new oE(n,e.asyncQueue,t)}nu(e,t){const n=new Hx(t,this.persistence);return new Gx(e.asyncQueue,n)}Xa(e){const t=uE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new ym(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,TE(),sh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new EE}}class GN extends LE{constructor(e,t){super(e,t,!1),this.ru=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.ru.syncEngine;this.sharedClientState instanceof Jf&&(this.sharedClientState.syncEngine={uo:BN.bind(null,t),co:$N.bind(null,t),lo:qN.bind(null,t),zi:UN.bind(null,t),ao:LN.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ci(async n=>{await zN(this.ru.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}Za(e){const t=TE();if(!Jf.D(t))throw new Ce(oe.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=uE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jf(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class oc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>x_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=ON.bind(null,this.syncEngine),await Vp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vN}()}createDatastore(e){const t=IE(e.databaseInfo.databaseId),n=function(a){return new eN(a)}(e.databaseInfo);return function(a,l,u,d){return new sN(a,l,u,d)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,o,a,l,u){return new iN(n,o,a,l,u)}(this.localStore,this.datastore,e.asyncQueue,t=>x_(this.syncEngine,t,0),function(){return __.D()?new __:new XA}())}createSyncEngine(e,t){return function(o,a,l,u,d,p,g){const v=new AN(o,a,l,u,d,p);return g&&(v.ja=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const a=ke(o);ae(vi,"RemoteStore shutting down."),a.W_.add(5),await gc(a),a.z_.shutdown(),a.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}oc.provider={build:()=>new oc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):Ft("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="FirestoreClient";class KN{constructor(e,t,n,o,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=o,this.user=An.UNAUTHENTICATED,this.clientId=q0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async l=>{ae(No,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>(ae(No,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Io;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=PE(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function tp(r,e){r.asyncQueue.verifyOperationInProgress(),ae(No,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async o=>{n.isEqual(o)||(await fE(e.localStore,o),n=o)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function A_(r,e){r.asyncQueue.verifyOperationInProgress();const t=await QN(r);ae(No,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>E_(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,o)=>E_(e.remoteStore,o)),r._onlineComponents=e}async function QN(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){ae(No,"Using user provided OfflineComponentProvider");try{await tp(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===oe.FAILED_PRECONDITION||o.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Gl("Error using user provided cache. Falling back to memory cache: "+t),await tp(r,new sc)}}else ae(No,"Using default OfflineComponentProvider"),await tp(r,new WN(void 0));return r._offlineComponents}async function XN(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(ae(No,"Using user provided OnlineComponentProvider"),await A_(r,r._uninitializedComponentsProvider._online)):(ae(No,"Using default OnlineComponentProvider"),await A_(r,new oc))),r._onlineComponents}async function YN(r){const e=await XN(r),t=e.eventManager;return t.onListen=NN.bind(null,e.syncEngine),t.onUnlisten=kN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=RN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=PN.bind(null,e.syncEngine),t}function ZN(r,e,t={}){const n=new Io;return r.asyncQueue.enqueueAndForget(async()=>function(a,l,u,d,p){const g=new HN({next:T=>{g.su(),l.enqueueAndForget(()=>wN(a,v));const S=T.docs.has(u);!S&&T.fromCache?p.reject(new Ce(oe.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&T.fromCache&&d&&d.source==="server"?p.reject(new Ce(oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new IN(Qh(u.path),g,{includeMetadataChanges:!0,Ta:!0});return _N(a,v)}(await YN(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(r,e,t){if(!t)throw new Ce(oe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function eR(r,e,t,n){if(e===!0&&n===!0)throw new Ce(oe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function R_(r){if(!_e.isDocumentKey(r))throw new Ce(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function tR(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ae()}function k_(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Ce(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tR(r);throw new Ce(oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR="firestore.googleapis.com",P_=!0;class b_{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nR,this.ssl=P_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:P_;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<sE)throw new Ce(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=BE((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ce(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ce(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ce(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,o){return n.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zE{constructor(e,t,n,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Fx;switch(n.type){case"firstParty":return new Bx(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ce(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=N_.get(t);n&&(ae("ComponentProvider","Removing Datastore"),N_.delete(t),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new km(this.firestore,e,this._query)}}class Ds{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ic(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ds(this.firestore,e,this._key)}}class ic extends km{constructor(e,t,n){super(e,t,Qh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ds(this.firestore,null,new _e(e))}withConverter(e){return new ic(this.firestore,e,this._path)}}function rR(r,e,...t){if(r=N0(r),arguments.length===1&&(e=q0.newId()),JN("doc","path",e),r instanceof zE){const n=gt.fromString(e,...t);return R_(n),new Ds(r,null,new _e(n))}{if(!(r instanceof Ds||r instanceof ic))throw new Ce(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(gt.fromString(e,...t));return R_(n),new Ds(r.firestore,r instanceof ic?r.converter:null,new _e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_="AsyncQueue";class V_{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new SE(this,"async_queue_retry"),this.bu=()=>{const n=sh();n&&ae(D_,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.Su=e;const t=sh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.bu)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=sh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.bu)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new Io;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!ko(e))throw e;ae(D_,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.Su.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const o=function(l){let u=l.message||"";return l.stack&&(u=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),u}(n);throw Ft("INTERNAL UNHANDLED ERROR: ",o),n}).then(n=>(this.pu=!1,n))));return this.Su=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const o=Sm.createAndSchedule(this,e,t,n,a=>this.Fu(a));return this.fu.push(o),o}Du(){this.gu&&Ae()}verifyOperationInProgress(){}async Mu(){let e;do e=this.Su,await e;while(e!==this.Su)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}class UE extends zE{constructor(e,t,n,o){super(e,t,n,o),this.type="firestore",this._queue=new V_,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new V_(e),this._firestoreClient=void 0,await e}}}function sR(r,e,t){t||(t=yh);const n=b0(r,"firestore");if(n.isInitialized(t)){const o=n.getImmediate({identifier:t}),a=n.getOptions(t);if(ch(a,e))return o;throw new Ce(oe.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ce(oe.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<sE)throw new Ce(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return n.initialize({options:e,instanceIdentifier:t})}function oR(r){if(r._terminated)throw new Ce(oe.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||iR(r),r._firestoreClient}function iR(r){var e,t,n;const o=r._freezeSettings(),a=function(u,d,p,g){return new IC(u,d,p,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,BE(g.experimentalLongPollingOptions),g.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,o);r._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=o.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),r._firestoreClient=new KN(r._authCredentials,r._appCheckCredentials,r._queue,a,r._componentsProvider&&function(u){const d=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(d),_online:d}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new bh(Lt.fromBase64String(e))}catch(t){throw new Ce(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new bh(Lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,o){if(n.length!==o.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==o[a])return!1;return!0}(this._values,e._values)}}const cR=new RegExp("[~\\*/\\[\\]]");function uR(r,e,t){if(e.search(cR)>=0)throw M_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r);try{return new $E(...e.split("."))._internalPath}catch{throw M_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r)}}function M_(r,e,t,n,o){let a=`Function ${e}() called with invalid data`;a+=". ";let l="";return new Ce(oe.INVALID_ARGUMENT,a+r+l)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,t,n,o,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ds(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new hR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(WE("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class hR extends qE{data(){return super.data()}}function WE(r,e){return typeof e=="string"?uR(r,e):e instanceof $E?e._internalPath:e._delegate._internalPath}class dR{convertValue(e,t="none"){switch(xo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return uc(e,(o,a)=>{n[o]=this.convertValue(a,t)}),n}convertVectorValue(e){var t,n,o;const a=(o=(n=(t=e.fields)===null||t===void 0?void 0:t[Jl].arrayValue)===null||n===void 0?void 0:n.values)===null||o===void 0?void 0:o.map(l=>xt(l.doubleValue));return new lR(a)}convertGeoPoint(e){return new aR(xt(e.latitude),xt(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Gh(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Zl(e));default:return null}}convertTimestamp(e){const t=Os(e);return new cn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=gt.fromString(e);be(Kw(n));const o=new fi(n.get(1),n.get(3)),a=new _e(n.popFirst(5));return o.isEqual(t)||Ft(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class GE extends qE{constructor(e,t,n,o,a,l){super(e,t,n,o,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new pR(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(WE("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class pR extends GE{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(r){r=k_(r,Ds);const e=k_(r.firestore,UE);return ZN(oR(e),r._key).then(t=>yR(e,r,t))}class gR extends dR{constructor(e){super(),this.firestore=e}convertBytes(e){return new bh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ds(this.firestore,null,t)}}function yR(r,e,t){const n=t.docs.get(e._key),o=new gR(r);return new GE(r,o,e._key,n,new fR(t.hasPendingWrites,t.fromCache),e.converter)}class vR{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=TR(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function _R(r){return new vR(r)}class wR{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=oc.provider,this._offlineComponentProvider={build:t=>new LE(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class ER{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=oc.provider,this._offlineComponentProvider={build:t=>new GN(t,e==null?void 0:e.cacheSizeBytes)}}}function TR(r){return new wR(void 0)}function IR(){return new ER}(function(e,t=!0){(function(o){ja=o})(V0),ql(new wa("firestore",(n,{instanceIdentifier:o,options:a})=>{const l=n.getProvider("app").getImmediate(),u=new UE(new jx(n.getProvider("auth-internal")),new zx(l,n.getProvider("app-check-internal")),function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ce(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fi(p.options.projectId,g)}(l,o),l);return a=Object.assign({useFetchStreams:t},a),u._setSettings(a),u},"PUBLIC").setMultipleInstances(!0)),Eo(vv,_v,e),Eo(vv,_v,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="firebasestorage.googleapis.com",SR="storageBucket",xR=2*60*1e3,CR=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends wi{constructor(e,t,n=0){super(np(e),`Firebase Storage: ${t} (${np(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return np(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var us;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(us||(us={}));function np(r){return"storage/"+r}function AR(){const r="An unknown error occurred, please check the error payload for server response.";return new ds(us.UNKNOWN,r)}function NR(){return new ds(us.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function RR(){return new ds(us.CANCELED,"User canceled the upload/download.")}function kR(r){return new ds(us.INVALID_URL,"Invalid URL '"+r+"'.")}function PR(r){return new ds(us.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function O_(r){return new ds(us.INVALID_ARGUMENT,r)}function KE(){return new ds(us.APP_DELETED,"The Firebase app was deleted.")}function bR(r){return new ds(us.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=qr.makeFromUrl(e,t)}catch{return new qr(e,"")}if(n.path==="")return n;throw PR(e)}static makeFromUrl(e,t){let n=null;const o="([A-Za-z0-9.\\-_]+)";function a(X){X.path.charAt(X.path.length-1)==="/"&&(X.path_=X.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+o+l,"i"),d={bucket:1,path:3};function p(X){X.path_=decodeURIComponent(X.path)}const g="v[A-Za-z0-9_]+",v=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",S=new RegExp(`^https?://${v}/${g}/b/${o}/o${T}`,"i"),C={bucket:1,path:3},D=t===HE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",q=new RegExp(`^https?://${D}/${o}/${V}`,"i"),U=[{regex:u,indices:d,postModify:a},{regex:S,indices:C,postModify:p},{regex:q,indices:{bucket:1,path:2},postModify:p}];for(let X=0;X<U.length;X++){const O=U[X],B=O.regex.exec(e);if(B){const A=B[O.indices.bucket];let I=B[O.indices.path];I||(I=""),n=new qr(A,I),O.postModify(n);break}}if(n==null)throw kR(e);return n}}class DR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(r,e,t){let n=1,o=null,a=null,l=!1,u=0;function d(){return u===2}let p=!1;function g(...V){p||(p=!0,e.apply(null,V))}function v(V){o=setTimeout(()=>{o=null,r(S,d())},V)}function T(){a&&clearTimeout(a)}function S(V,...q){if(p){T();return}if(V){T(),g.call(null,V,...q);return}if(d()||l){T(),g.call(null,V,...q);return}n<64&&(n*=2);let U;u===1?(u=2,U=0):U=(n+Math.random())*1e3,v(U)}let C=!1;function D(V){C||(C=!0,T(),!p&&(o!==null?(V||(u=2),clearTimeout(o),v(0)):V||(u=1)))}return v(0),a=setTimeout(()=>{l=!0,D(!0)},t),D}function MR(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(r){return r!==void 0}function F_(r,e,t,n){if(n<e)throw O_(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw O_(`Invalid value for '${r}'. Expected ${t} or less.`)}function FR(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const o=e(n)+"="+e(r[n]);t=t+o+"&"}return t=t.slice(0,-1),t}var Dh;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(Dh||(Dh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(r,e){const t=r>=500&&r<600,o=[408,429].indexOf(r)!==-1,a=e.indexOf(r)!==-1;return t||o||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e,t,n,o,a,l,u,d,p,g,v,T=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=o,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=d,this.timeout_=p,this.progressCallback_=g,this.connectionFactory_=v,this.retry=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,C)=>{this.resolve_=S,this.reject_=C,this.start_()})}start_(){const e=(n,o)=>{if(o){n(!1,new Hu(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const l=u=>{const d=u.loaded,p=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,p)};this.progressCallback_!==null&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const u=a.getErrorCode()===Dh.NO_ERROR,d=a.getStatus();if(!u||jR(d,this.additionalRetryCodes_)&&this.retry){const g=a.getErrorCode()===Dh.ABORT;n(!1,new Hu(!1,null,g));return}const p=this.successCodes_.indexOf(d)!==-1;n(!0,new Hu(p,a))})},t=(n,o)=>{const a=this.resolve_,l=this.reject_,u=o.connection;if(o.wasSuccessCode)try{const d=this.callback_(u,u.getResponse());OR(d)?a(d):a()}catch(d){l(d)}else if(u!==null){const d=AR();d.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,d)):l(d)}else if(o.canceled){const d=this.appDelete_?KE():RR();l(d)}else{const d=NR();l(d)}};this.canceled_?t(!1,new Hu(!1,null,!0)):this.backoffId_=VR(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&MR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Hu{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function BR(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function zR(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function UR(r,e){e&&(r["X-Firebase-GMPID"]=e)}function $R(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function qR(r,e,t,n,o,a,l=!0){const u=FR(r.urlParams),d=r.url+u,p=Object.assign({},r.headers);return UR(p,e),BR(p,t),zR(p,a),$R(p,n),new LR(d,r.method,p,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function GR(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t){this._service=e,t instanceof qr?this._location=t:this._location=qr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Vh(e,t)}get root(){const e=new qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return GR(this._location.path)}get storage(){return this._service}get parent(){const e=WR(this._location.path);if(e===null)return null;const t=new qr(this._location.bucket,e);return new Vh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw bR(e)}}function j_(r,e){const t=e==null?void 0:e[SR];return t==null?null:qr.makeFromBucketSpec(t,r)}function HR(r,e,t,n={}){r.host=`${e}:${t}`,r._protocol="http";const{mockUserToken:o}=n;o&&(r._overrideAuthToken=typeof o=="string"?o:_S(o,r.app.options.projectId))}class KR{constructor(e,t,n,o,a){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=o,this._firebaseVersion=a,this._bucket=null,this._host=HE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=xR,this._maxUploadRetryTime=CR,this._requests=new Set,o!=null?this._bucket=qr.makeFromBucketSpec(o,this._host):this._bucket=j_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qr.makeFromBucketSpec(this._url,e):this._bucket=j_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){F_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){F_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(D0(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Vh(this,e)}_makeRequest(e,t,n,o,a=!0){if(this._deleted)return new DR(KE());{const l=qR(e,this._appId,n,o,t,this._firebaseVersion,a);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[n,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,o).getPromise()}}const L_="@firebase/storage",B_="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE="storage";function QR(r=Ix(),e){r=N0(r);const n=b0(r,QE).getImmediate({identifier:e}),o=yS("storage");return o&&XR(n,...o),n}function XR(r,e,t,n={}){HR(r,e,t,n)}function YR(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),o=r.getProvider("app-check-internal");return new KR(t,n,o,e,V0)}function ZR(){ql(new wa(QE,YR,"PUBLIC").setMultipleInstances(!0)),Eo(L_,B_,""),Eo(L_,B_,"esm2017")}ZR();const JR={apiKey:"AIzaSyAlv8DyWdhTjJjZYPqkghZUyEupG5g8SFk",authDomain:"groove-slider.firebaseapp.com",projectId:"groove-slider",storageBucket:"groove-slider.appspot.com",messagingSenderId:"87433841566",appId:"1:87433841566:web:da11fb420a121cc700248f",measurementId:"G-X0QJM954YF"},XE=M0(JR),rp=sR(XE,{localCache:_R({tabManager:IR()})});QR(XE);function e2(r,e){return new Promise((t,n)=>{try{const o=t2();o.onmessage=a=>{a.data.type==="complete"?(t(a.data.file),o.terminate()):a.data.type==="error"&&(n(new Error(a.data.error)),o.terminate())},o.onerror=a=>{n(a),o.terminate()},o.postMessage({data:r,config:e})}catch(o){n(o)}})}function t2(){const r=`
    self.onmessage = async (event) => {
      const { data, config } = event.data;
      
      try {
        // Basic export processing
        const exportedFile = await processExport(data, config);
        
        self.postMessage({ 
          type: 'complete', 
          file: exportedFile 
        });
      } catch (error) {
        self.postMessage({ 
          type: 'error', 
          error: error.message 
        });
      }
    };
    
    async function processExport(data, config) {
      console.log('Processing export', data, config);
      return data; // Temporary return
    }
  `,e=new Blob([r],{type:"application/javascript"});return new Worker(URL.createObjectURL(e))}const z_=r=>/^[a-zA-Z0-9 _\-\.]+$/.test(r)&&r.trim()!=="",n2=({value:r,onChange:e})=>{var l;const[t,n]=ne.useState(!1),o=[{value:"720x1280",label:"720p"},{value:"1080x1920",label:"1080p"}],a=u=>{e(u),n(!1)};return w.jsxs("div",{className:"custom-resolution-dropdown",children:[w.jsxs("div",{className:"dropdown-header",onClick:()=>n(!t),children:[((l=o.find(u=>u.value===r))==null?void 0:l.label)||r,t?w.jsx(p1,{size:16}):w.jsx(u1,{size:16})]}),t&&w.jsx("div",{className:"dropdown-list",children:o.map(u=>w.jsx("div",{className:"dropdown-item",onClick:()=>a(u.value),children:u.label},u.value))})]})},r2=({isOpen:r,progress:e,message:t,onClose:n,onExport:o,isExporting:a,storyData:l,stories:u,duration:d,stopPlayback:p,cancelExport:g})=>{const[v,T]=ne.useState("1080x1920"),[S,C]=ne.useState(!1),[D,V]=ne.useState(1),[q,L]=ne.useState(null),[U,X]=ne.useState(!1),[O,B]=ne.useState(""),[A,I]=ne.useState(!1),N=u&&d?u.length*d:0,P=N*(S?D:1),b=P>180,[M,R]=ne.useState("contain"),ue=K=>{const j=Math.floor(K/60),Q=Math.floor(K%60);return`${j}:${Q.toString().padStart(2,"0")}`},ye=K=>{const j=parseInt(K)||1;if(j<1){V(1);return}if(N*j>180){const ve=Math.floor(180/N);V(Math.max(1,ve))}else V(j)},pe=()=>{if(b){L("Export duration exceeds the 3-minute limit. Please reduce loop count.");return}X(!0),B(""),I(!1)},ce=K=>{const j=K.target.value;B(j),I(z_(j))},Z=async()=>{if(!z_(O))return;p&&typeof p=="function"&&p();const K={resolution:v,isExportLoopEnabled:S,exportLoopDuration:S?P:0,fileName:`${O}.mp4`,imageFitMode:"contain"};try{const j={storyData:l||u,resolution:v,isExportLoopEnabled:S,exportLoopDuration:S?P:0,fileName:`${O}.mp4`,imageFitMode:"contain"};console.log("Exporting with fit mode: contain");const Q=await e2(j,K);X(!1),o(Q)}catch(j){console.error("Export failed",j),L(j.message||"Export failed. Please try again.")}},ee=()=>{X(!1),B(""),I(!1)};return r?U?w.jsx("div",{className:"modal-overlay",children:w.jsxs("div",{className:"modal-content file-name-prompt",children:[w.jsx("button",{className:"modal-close",onClick:ee,children:w.jsx(ur,{size:20})}),w.jsx("h3",{children:"Name Your Export"}),w.jsx("p",{children:"Choose a name for your exported video"}),w.jsxs("div",{className:"file-name-input",children:[w.jsx("input",{type:"text",value:O,onChange:ce,placeholder:"Enter file name",className:!A&&O?"input-error":""}),!A&&O&&w.jsx("div",{className:"error-message",children:"Invalid characters. Use letters, numbers, spaces, and ._-"}),w.jsx("small",{children:"Letters, numbers, spaces, hyphens, underscores allowed only"})]}),w.jsxs("div",{className:"file-name-actions",children:[w.jsx("button",{className:"cancel-button",onClick:ee,children:"Cancel"}),w.jsx("button",{className:"continue-button",onClick:Z,disabled:!A||!O,children:"Continue"})]})]})}):w.jsx("div",{className:"modal-overlay",children:w.jsxs("div",{className:"modal-content export-modal",children:[w.jsx("button",{className:"modal-close",onClick:n,children:w.jsx(ur,{size:20})}),a?w.jsxs("div",{className:"loading-container",children:[w.jsx("h3",{children:"Exporting Video"}),w.jsx("p",{children:t}),w.jsxs("div",{className:"progress-container",children:[w.jsx("div",{className:"progress-bar",children:w.jsx("div",{className:"progress-fill",style:{width:`${e}%`}})}),w.jsxs("span",{className:"progress-text",children:[Math.round(e),"%"]})]}),w.jsx("p",{className:"export-note",children:"This may take several minutes. Please keep the app open."}),w.jsx("button",{onClick:g,style:{backgroundColor:"#e74c3c",color:"white",border:"none",borderRadius:"5px",padding:"10px 20px",fontSize:"15px",fontWeight:"500",cursor:"pointer",display:"block",margin:"0 auto",boxShadow:"0 2px 5px rgba(0,0,0,0.2)",zIndex:1e4},children:"Cancel Export"})]}):w.jsxs(w.Fragment,{children:[w.jsx("h3",{className:"modal-title",children:"Export Settings"}),w.jsxs("div",{className:"resolution-selector",children:[w.jsx("label",{children:"Resolution:"}),w.jsx(n2,{value:v,onChange:T})]}),w.jsxs("div",{className:"duration-info",children:[w.jsxs("div",{className:"info-row",children:[w.jsx("span",{children:"Current slideshow length:"}),w.jsx("span",{className:"info-value",children:ue(N)})]}),S&&w.jsxs("div",{className:"info-row",children:[w.jsxs("span",{children:["With looping (",D,"×):"]}),w.jsx("span",{className:"info-value",children:ue(P)})]}),w.jsx("div",{className:"info-row",children:w.jsx("span",{style:{fontSize:"0.90em",color:"orange"},children:"Note: Max export duration is 3 minutes. Looping Max is up to 3mins"})}),b&&w.jsxs("div",{className:"duration-warning",children:[w.jsx(oS,{size:16}),w.jsx("span",{children:"Export duration exceeds 3 minute limit"})]})]}),w.jsxs("div",{className:"export-loop-settings",children:[w.jsx("div",{className:"loop-toggle",children:w.jsxs("label",{children:[w.jsx("span",{children:"Loop Slideshow"}),w.jsx("input",{type:"checkbox",checked:S,onChange:()=>C(!S)})]})}),S&&w.jsxs("div",{className:"loop-control",children:[w.jsx("label",{children:"Loop Count:"}),w.jsxs("div",{className:"loop-counter",children:[w.jsx("button",{onClick:()=>ye(D-1),disabled:D<=1,className:"counter-button",children:"-"}),w.jsx("input",{type:"number",value:D,onChange:K=>ye(K.target.value),min:"1",className:"loop-count-input"}),w.jsx("button",{onClick:()=>ye(D+1),disabled:N*(D+1)>180,className:"counter-button",children:"+"}),w.jsx("span",{className:"loop-unit",children:"×"})]}),b&&w.jsxs("div",{className:"loop-warning",children:[w.jsx(b1,{size:14}),w.jsx("span",{children:"Maximum export duration is 3 minutes"})]})]})]}),q&&w.jsx("div",{className:"export-error-message",children:q}),w.jsx("div",{className:"export-actions",children:w.jsxs("button",{className:"action-button download",onClick:pe,disabled:b,style:{opacity:b?.5:1,cursor:b?"not-allowed":"pointer"},children:[w.jsx(Gp,{className:"button-icon"}),"Export"]})})]})]})}):null},s2=({isOpen:r,onClose:e,onSave:t})=>{const[n,o]=ne.useState(""),[a,l]=ne.useState(!1),[u,d]=ne.useState(null);if(!r)return null;const p=async g=>{if(g.preventDefault(),!n.trim()){d("Please enter a session name");return}try{l(!0),d(null),await t(n),o(""),e()}catch(v){console.error("Error saving session:",v),d("Failed to save session: "+v.message)}finally{l(!1)}};return w.jsx("div",{className:"modal-overlay",children:w.jsxs("div",{className:"modal-content save-session-modal",children:[w.jsx("button",{className:"modal-close",onClick:e,children:w.jsx(ur,{size:20})}),w.jsx("h3",{className:"modal-title",children:"Save Session"}),w.jsxs("form",{onSubmit:p,children:[w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"session-name",children:"Session Name:"}),w.jsx("input",{type:"text",id:"session-name",value:n,onChange:g=>o(g.target.value),placeholder:"Enter a name for your session",autoFocus:!0,maxLength:50,className:"session-name-input"})]}),u&&w.jsx("div",{className:"save-error",children:u}),w.jsxs("div",{className:"modal-actions",children:[w.jsx("button",{type:"button",className:"cancel-button",onClick:e,disabled:a,children:"Cancel"}),w.jsx("button",{type:"submit",className:"save-button",disabled:a,children:a?w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"spinner small"}),"Saving..."]}):w.jsxs(w.Fragment,{children:[w.jsx(w0,{size:16}),"Save Session"]})})]})]})]})})},Ku={name:"GrooveGalleryDB",version:3,stores:{sessions:{keyPath:"id",autoIncrement:!0},images:{keyPath:"id",autoIncrement:!0,indexes:[{name:"sessionId",keyPath:"sessionId",unique:!1}]},music:{keyPath:"id",autoIncrement:!0,indexes:[{name:"sessionId",keyPath:"sessionId",unique:!1}]},bpmValues:{keyPath:"audioUrl"}}},o2=r=>{r.forEach(e=>{if(e&&typeof e=="string")try{URL.revokeObjectURL(e)}catch(t){console.warn("Error revoking object URL:",t)}})},Ua=()=>new Promise((r,e)=>{const t=indexedDB.open(Ku.name,Ku.version);t.onupgradeneeded=n=>{const o=n.target.result;console.log("Database upgrade in progress. Current version:",n.oldVersion),console.log("Configured stores:",Object.keys(Ku.stores)),Object.entries(Ku.stores).forEach(([a,l])=>{if(o.objectStoreNames.contains(a)&&a!=="sessions"&&(o.deleteObjectStore(a),console.log(`Deleted existing object store: ${a} for rebuild`)),o.objectStoreNames.contains(a)){if(console.log(`Object store ${a} already exists`),l.indexes&&a!=="sessions"){const d=n.target.transaction.objectStore(a);l.indexes.forEach(p=>{d.indexNames.contains(p.name)||(d.createIndex(p.name,p.keyPath,{unique:p.unique||!1}),console.log(`Added missing index: ${p.name} to existing store: ${a}`))})}}else{console.log(`Creating object store: ${a}`);const u=o.createObjectStore(a,{keyPath:l.keyPath,autoIncrement:l.autoIncrement||!1});l.indexes&&l.indexes.forEach(d=>{u.createIndex(d.name,d.keyPath,{unique:d.unique||!1}),console.log(`Created index: ${d.name} on store: ${a}`)}),a==="bpmValues"&&(u.createIndex("audioUrl","audioUrl",{unique:!0}),u.createIndex("timestamp","timestamp",{unique:!1}),console.log("Created indexes for bpmValues store")),console.log(`Object store ${a} created successfully`)}})},t.onsuccess=n=>{const o=n.target.result;console.log("Database opened successfully. Available stores:",Array.from(o.objectStoreNames)),r(o)},t.onerror=n=>{console.error("IndexedDB initialization error:",n.target.error),e(n.target.error)}}),i2=async(r,e)=>{try{const t=await Ua();return new Promise((n,o)=>{const u=t.transaction("bpmValues","readwrite").objectStore("bpmValues").put({audioUrl:r,bpm:e,timestamp:new Date().toISOString()});u.onsuccess=()=>{console.log(`BPM value ${e} saved for ${r}`),n(!0)},u.onerror=d=>{console.error("Error saving BPM value:",d.target.error),o(!1)}})}catch(t){return console.error("saveBpmValue error:",t),!1}},a2=async r=>{try{const e=await Ua();return new Promise((t,n)=>{if(!e.objectStoreNames.contains("bpmValues"))return console.error("bpmValues store does not exist in the database"),t(null);try{const o=e.transaction(["bpmValues"],"readonly"),l=o.objectStore("bpmValues").get(r);l.onsuccess=u=>{const d=u.target.result;d?(console.log(`Retrieved cached BPM for ${r}: ${d.bpm}`),t(d.bpm)):(console.log(`No cached BPM found for ${r}`),t(null))},l.onerror=u=>{console.error("Error retrieving BPM value:",u.target.error),t(null)},o.onerror=u=>{console.error("Transaction error:",u.target.error),t(null)}}catch(o){console.error("Transaction creation error:",o),t(null)}})}catch(e){return console.error("getBpmValue error:",e),null}},l2=async r=>{try{const e=[];for(const d of r.stories)try{const g=await(await fetch(d.url)).blob();e.push({type:d.type,blob:g})}catch(p){console.error("Error processing image:",p)}let t=null;if(r.musicUrl)try{t=await(await fetch(r.musicUrl)).blob()}catch(d){console.error("Error processing music:",d)}const o=(await Ua()).transaction(["sessions","images","music"],"readwrite"),a=o.objectStore("sessions"),l={name:r.name,createdAt:new Date,bpm:r.bpm,musicStartPoint:r.musicStartPoint,imageFitMode:r.imageFitMode,duration:r.duration,isLoopingEnabled:r.isLoopingEnabled,currentIndex:r.currentIndex},u=a.add(l);return new Promise((d,p)=>{u.onsuccess=async g=>{const v=g.target.result,T=o.objectStore("images");for(const S of e)T.add({sessionId:v,type:S.type,blob:S.blob});t&&o.objectStore("music").add({sessionId:v,blob:t}),o.oncomplete=()=>{console.log(`Session saved with ID: ${v}`),d(v)},o.onerror=S=>{console.error("Transaction error:",S.target.error),p(S.target.error)}},u.onerror=g=>{console.error("Error adding session:",g.target.error),p(g.target.error)}})}catch(e){throw console.error("saveSession error:",e),e}},c2=async r=>{try{const e=await Ua(),t=await new Promise((u,d)=>{const v=e.transaction("sessions","readonly").objectStore("sessions").get(r);v.onsuccess=T=>{u(T.target.result)},v.onerror=T=>{d(T.target.error)}});if(!t)throw new Error(`Session with ID ${r} not found`);const o=(await new Promise((u,d)=>{const g=e.transaction("images","readonly").objectStore("images");if(!g.indexNames.contains("sessionId")){console.warn("sessionId index not found on images store - falling back to cursor");const S=[],C=g.openCursor();C.onsuccess=D=>{const V=D.target.result;V?(V.value.sessionId===r&&S.push(V.value),V.continue()):u(S)},C.onerror=D=>{d(D.target.error)};return}const T=g.index("sessionId").getAll(r);T.onsuccess=S=>{u(S.target.result)},T.onerror=S=>{d(S.target.error)}})).map(u=>({type:u.type,url:URL.createObjectURL(u.blob)})),a=await new Promise((u,d)=>{const g=e.transaction("music","readonly").objectStore("music");if(!g.indexNames.contains("sessionId")){console.warn("sessionId index not found on music store - falling back to cursor");let S=null;const C=g.openCursor();C.onsuccess=D=>{const V=D.target.result;if(V){if(V.value.sessionId===r){S=V.value,u(S);return}V.continue()}else u(S)},C.onerror=D=>{d(D.target.error)};return}const T=g.index("sessionId").get(r);T.onsuccess=S=>{u(S.target.result)},T.onerror=S=>{d(S.target.error)}});let l=null;return a&&a.blob&&(l=URL.createObjectURL(a.blob)),{...t,stories:o,musicUrl:l,cleanup:()=>{o2([...o.map(u=>u.url),l])}}}catch(e){throw console.error("loadSession error:",e),e}},u2=async()=>{try{const r=await Ua();return new Promise((e,t)=>{const a=r.transaction("sessions","readonly").objectStore("sessions").getAll();a.onsuccess=l=>{e(l.target.result)},a.onerror=l=>{t(l.target.error)}})}catch(r){throw console.error("getAllSessions error:",r),r}},h2=async r=>{try{const t=(await Ua()).transaction(["sessions","images","music"],"readwrite");t.objectStore("sessions").delete(r);const o=t.objectStore("images");if(o.indexNames.contains("sessionId")){const u=o.index("sessionId").openCursor(IDBKeyRange.only(r));u.onsuccess=d=>{const p=d.target.result;p&&(p.delete(),p.continue())}}else{const l=o.openCursor();l.onsuccess=u=>{const d=u.target.result;d&&(d.value.sessionId===r&&d.delete(),d.continue())}}const a=t.objectStore("music");if(a.indexNames.contains("sessionId")){const u=a.index("sessionId").openCursor(IDBKeyRange.only(r));u.onsuccess=d=>{const p=d.target.result;p&&(p.delete(),p.continue())}}else{const l=a.openCursor();l.onsuccess=u=>{const d=u.target.result;d&&(d.value.sessionId===r&&d.delete(),d.continue())}}return new Promise((l,u)=>{t.oncomplete=()=>{console.log(`Session ${r} deleted successfully`),l()},t.onerror=d=>{console.error("Error deleting session:",d.target.error),u(d.target.error)}})}catch(e){throw console.error("deleteSession error:",e),e}},d2=({onLoadSession:r,visible:e})=>{const[t,n]=ne.useState([]),[o,a]=ne.useState(!0),[l,u]=ne.useState(null);ne.useEffect(()=>{e&&d()},[e]);const d=async()=>{try{a(!0);const T=(await u2()).filter(S=>!S.name.startsWith("auto_save_"));T.sort((S,C)=>new Date(C.createdAt)-new Date(S.createdAt)),n(T),u(null)}catch(v){console.error("Error loading sessions:",v),u("Failed to load saved sessions")}finally{a(!1)}},p=async(v,T)=>{if(v.stopPropagation(),window.confirm("Are you sure you want to delete this session?"))try{await h2(T),n(t.filter(S=>S.id!==T))}catch(S){console.error("Error deleting session:",S),alert("Failed to delete session")}},g=v=>new Date(v).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e?w.jsxs("div",{className:"sessions-list",children:[w.jsx("h3",{className:"sessions-title",children:"Saved Sessions"}),o&&w.jsx("div",{className:"sessions-loading",children:"Loading saved sessions..."}),l&&w.jsx("div",{className:"sessions-error",children:l}),!o&&t.length===0&&w.jsxs("div",{className:"sessions-empty",children:[w.jsx("p",{children:"No saved sessions yet"}),w.jsx("p",{className:"sessions-hint",children:"Create a slideshow and click Save to add one"})]}),!o&&t.length>0&&w.jsx("ul",{className:"sessions-items",children:t.map(v=>w.jsxs("li",{className:"session-item",onClick:()=>r(v.id),children:[w.jsxs("div",{className:"session-info",children:[w.jsx("div",{className:"session-name",children:v.name}),w.jsxs("div",{className:"session-date",children:[w.jsx(_0,{size:12}),w.jsx("span",{children:g(v.createdAt)})]}),w.jsxs("div",{className:"session-details",children:[w.jsxs("span",{children:[v.bpm," BPM"]}),w.jsxs("span",{children:[v.duration.toFixed(1),"s/slide"]})]})]}),w.jsxs("div",{className:"session-actions",children:[w.jsx("button",{className:"session-delete-btn",onClick:T=>p(T,v.id),title:"Delete session",children:w.jsx(E0,{size:16})}),w.jsx(mo,{size:16,className:"session-arrow"})]})]},v.id))})]}):null},vc=()=>new Promise((r,e)=>{const t=indexedDB.open("AudioVisualizerDB",3);t.onerror=n=>e("IndexedDB error: "+n.target.errorCode),t.onupgradeneeded=n=>{const o=n.target.result;o.objectStoreNames.contains("audioPositions")||o.createObjectStore("audioPositions",{keyPath:"audioUrl"}),o.objectStoreNames.contains("visualizerStates")||o.createObjectStore("visualizerStates",{keyPath:"audioUrl"}),o.objectStoreNames.contains("audioBuffers")||o.createObjectStore("audioBuffers",{keyPath:"audioUrl"})},t.onsuccess=n=>r(n.target.result)}),sp=async(r,e)=>{try{const o=(await vc()).transaction(["audioPositions"],"readwrite").objectStore("audioPositions");return new Promise((a,l)=>{const u=o.put({audioUrl:r,...e,timestamp:Date.now()});u.onsuccess=()=>a(!0),u.onerror=()=>l(!1)})}catch(t){return console.error("Error storing audio positions:",t),!1}},U_=async(r,e)=>{try{console.log(`Attempting to store audio buffer for: ${r}`);const t=await vc(),n=new(window.AudioContext||window.webkitAudioContext),o=e.getChannelData(0),a={audioUrl:r,channels:e.numberOfChannels,sampleRate:e.sampleRate,length:e.length,duration:e.duration,channelData:o.buffer,timestamp:Date.now()},u=t.transaction(["audioBuffers"],"readwrite").objectStore("audioBuffers");return new Promise((d,p)=>{const g=u.put(a);g.onsuccess=()=>{console.log(`Successfully stored audio buffer for: ${r}`),d(!0)},g.onerror=v=>{console.error(`Failed to store audio buffer for: ${r}`,v),p(!1)}})}catch(t){return console.error("Error storing audio buffer:",t),!1}},f2=async r=>{try{console.log(`Attempting to retrieve audio buffer for: ${r}`);const n=(await vc()).transaction(["audioBuffers"],"readonly").objectStore("audioBuffers");return new Promise((o,a)=>{const l=n.get(r);l.onsuccess=u=>{const d=u.target.result;if(d){const g=new(window.AudioContext||window.webkitAudioContext)().createBuffer(d.channels,d.length,d.sampleRate);for(let v=0;v<d.channels;v++)g.getChannelData(v).set(new Float32Array(d.channelData));console.log(`Retrieved audio buffer for ${r}`),o({buffer:g})}else o(null)},l.onerror=u=>{console.error(`Error retrieving audio buffer for: ${r}`,u),a(null)}})}catch(e){return console.error("Error retrieving audio buffer:",e),null}},$_=async(r,e)=>{try{const o=(await vc()).transaction(["visualizerStates"],"readwrite").objectStore("visualizerStates");return new Promise((a,l)=>{const u=o.put({audioUrl:r,...e,timestamp:Date.now()});u.onsuccess=()=>a(!0),u.onerror=()=>l(!1)})}catch(t){return console.error("Error storing visualizer state:",t),!1}},q_=async r=>{try{const n=(await vc()).transaction(["visualizerStates"],"readonly").objectStore("visualizerStates");return new Promise((o,a)=>{const l=n.get(r);l.onsuccess=u=>{o(u.target.result||null)},l.onerror=()=>a(null)})}catch(e){return console.error("Error retrieving visualizer state:",e),null}},p2=({audioUrl:r,onStartPointChange:e,audioRef:t,musicStartPoint:n=0})=>{const o=ne.useRef(null),a=ne.useRef(null),[l,u]=ne.useState(null),[d,p]=ne.useState(!0),[g,v]=ne.useState(0),[T,S]=ne.useState(800),[C,D]=ne.useState(0),[V,q]=ne.useState(1),[L,U]=ne.useState(0),[X,O]=ne.useState(!1),[B,A]=ne.useState(!1),[I,N]=ne.useState("initial"),[P,b]=ne.useState(0),[M,R]=ne.useState("Initializing..."),ue=ne.useRef(null),ye=ne.useRef(null),pe=ne.useRef(!1),ce={WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"};ne.useEffect(()=>{if(!r||ue.current===r)return;ue.current=r,p(!0),(async()=>{N("initial"),b(5),R("Initializing...");const se=await f2(r);if(se){N("cached"),b(70),R("Loading from cache..."),setTimeout(()=>{b(90),R("Processing audio data...")},300),setTimeout(()=>{b(90),R("Processing audio data...")},300),setTimeout(async()=>{b(100),R("Ready to play"),u(se.buffer),v(se.buffer.duration);const we=await q_(r);we&&(we.zoomLevel&&q(we.zoomLevel),we.waveformOffset!==void 0&&U(we.waveformOffset),e&&we.startPoint!==void 0&&Math.abs(we.startPoint-n)>.001&&e(we.startPoint)),p(!1)},600);return}N("streaming"),b(10),R("Downloading audio...");try{let we,Ie,Be=0,$e=0;if(r.includes("audius.co/")){const Ye=`https://lingering-surf-27dd.benhayze.workers.dev/${m2(r)}`;try{const ft=await fetch(Ye,{method:"HEAD"});Be=parseInt(ft.headers.get("Content-Length")||"0")}catch{console.log("HEAD request failed, continuing without content length")}b(15),R("Streaming audio..."),we=await fetch(Ye,{headers:{Accept:"audio/mpeg",Range:"bytes=0-500000"}}),Ie=await we.arrayBuffer(),$e=Ie.byteLength,b(30),R("Processing initial audio data...")}else b(15),R("Hang on, Loading & Analyzing your Music"),we=await fetch(r,{headers:{Range:"bytes=0-100000"}}),Ie=await we.arrayBuffer(),$e=Ie.byteLength,b(25),R("Processing audio preview...");b(40),R("Decoding audio data...");const nt=new(window.AudioContext||window.webkitAudioContext),ot=await nt.decodeAudioData(Ie);b(60),R("Generating waveform..."),u(ot),v(ot.duration),N("basic-waveform"),b(75),R("Loading complete data..."),setTimeout(async()=>{b(100),R("Ready to play"),p(!1);const Ht=await q_(r);Ht&&(Ht.zoomLevel&&q(Ht.zoomLevel),Ht.waveformOffset!==void 0&&U(Ht.waveformOffset))},500),R("Downloading full audio in background...");const Dn=await(await fetch(r)).arrayBuffer();R("Processing full audio data...");const Gt=await nt.decodeAudioData(Dn);u(Gt),v(Gt.duration),N("complete"),await U_(r,Gt)}catch(we){console.error("Loading failed:",we),N("error"),b(0),R("Error loading audio"),p(!1)}})()},[r,e,n]),ne.useEffect(()=>{if(!r||!l)return;const re=setTimeout(()=>{Promise.all([$_(r,{zoomLevel:V,waveformOffset:L}),U_(r,l)]).catch(se=>{console.error("Auto-save failed:",se)})},5e3);return()=>clearTimeout(re)},[r,l,V,L]),ne.useEffect(()=>{const re=t==null?void 0:t.current;if(!re)return;const se=()=>{const Ie=re.currentTime;if(D(Ie),pe.current=!re.paused,X&&pe.current){const Be=g/V,$e=L,nt=$e+Be,ot=Be*.2;if(Ie>nt-ot){const Mt=Math.max(0,Math.min(g-Be,Ie-Be*.8));U(Mt)}else if(Ie<$e+ot){const Mt=Math.max(0,Math.min(g-Be,Ie-Be*.2));U(Mt)}}},we=()=>{pe.current&&re&&se(),ye.current=requestAnimationFrame(we)};return we(),re.addEventListener("timeupdate",se),re.addEventListener("play",()=>{pe.current=!0}),re.addEventListener("pause",()=>{pe.current=!1}),re.addEventListener("seeking",se),()=>{re.removeEventListener("timeupdate",se),re.removeEventListener("play",()=>{pe.current=!0}),re.removeEventListener("pause",()=>{pe.current=!1}),re.removeEventListener("seeking",se),ye.current&&cancelAnimationFrame(ye.current)}},[t,X,V,L,g]),ne.useEffect(()=>{if(!l||g===0||!r)return;if(V>1){const se=g/V,we=Math.max(0,Math.min(g-se,n-se/2));U(we)}const re=setTimeout(()=>{sp(r,{startPoint:n}).catch(se=>console.error("Error saving to IndexedDB:",se))},1e3);return()=>clearTimeout(re)},[n,V,l,g,r]);const Z=(re,se=!0)=>{if(isNaN(re))return"00:00.000";const we=Math.floor(re/60),Ie=Math.floor(re%60);if(se){const Be=Math.floor(re%1*1e3);return`${we.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}.${Be.toString().padStart(3,"0")}`}else return`${we.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}`},ee=ne.useCallback(()=>{if(!l||!o.current)return;const re=o.current,se=re.getContext("2d"),we=re.width,Ie=re.height;if(se.clearRect(0,0,we,Ie),d){const it=se.createLinearGradient(0,0,we,Ie);it.addColorStop(0,"#1a1a2a"),it.addColorStop(1,"#1a1a1a"),se.fillStyle=it,se.fillRect(0,0,we,Ie),se.fillStyle="rgba(255, 236, 180, 0.15)";const en=Date.now()*.005;for(let wn=0;wn<we;wn+=5){const Un=Math.sin(wn*.1+en)*(Ie/3)+Math.cos(wn*.05-en)*(Ie/4)+Math.random()*(Ie/5);se.fillRect(wn,Ie/2-Un/2,3,Math.abs(Un))}return}se.fillStyle="#000",se.fillRect(0,0,we,Ie);const Be=l.getChannelData(0),$e=g/V,nt=Math.max(0,Math.min(g-$e,L)),ot=nt+$e,Mt=Be.length,Dn=Math.floor(nt/g*Mt),Ht=Math.floor(ot/g*Mt)-Dn,Ye=1,ft=0,Vn=Math.floor(we/(Ye+ft)),ps=Math.floor(Ht/Vn);se.fillStyle="#ffecb4";for(let it=0;it<Vn;it++){const en=it*(Ye+ft),wn=Dn+Math.floor(it/Vn*Ht);let Un=0;for(let pr=0;pr<ps;pr++){const Rr=wn+pr;if(Rr<Be.length){const hn=Math.abs(Be[Rr]);hn>Un&&(Un=hn)}}const Hr=Math.min(2,Un*.9)*(Ie/2),ms=en,Kr=Ie/2-Hr,fr=Hr*2;se.fillRect(ms,Kr,Ye,fr)}if(se.strokeStyle="rgba(100, 100, 100, 0.3)",se.lineWidth=1,se.beginPath(),se.moveTo(0,Ie/2),se.lineTo(we,Ie/2),se.stroke(),se.beginPath(),se.moveTo(0,Ie/4),se.lineTo(we,Ie/4),se.moveTo(0,3*Ie/4),se.lineTo(we,3*Ie/4),se.stroke(),se.fillStyle="#777",se.font="10px Arial",C>=nt&&C<=ot){const it=(C-nt)/$e*we;se.fillStyle="rgb(255, 132, 0)";const en=B?7:5;se.fillRect(it-Math.floor(en/2),0,en,Ie),se.beginPath(),se.moveTo(it,0),se.lineTo(it-4,-4),se.lineTo(it+4,-4),se.closePath(),se.fill()}if(n>=nt&&n<=ot){const it=(n-nt)/$e*we;se.fillStyle="rgba(61, 255, 8, 0.8)",se.fillRect(it-1,0,5,Ie),se.beginPath(),se.moveTo(it,0),se.lineTo(it-6,-6),se.lineTo(it+6,-6),se.closePath(),se.fill()}const Kt=3;se.fillStyle="rgba(100, 100, 255, 0.5)",se.fillRect(0,Ie-Kt,we*($e/g),Kt)},[l,C,V,L,g,n,T,d]);ne.useEffect(()=>{let re;if(d){const se=()=>{ee(),re=requestAnimationFrame(se)};se()}else l&&!d&&(re=requestAnimationFrame(ee));return()=>{re&&cancelAnimationFrame(re)}},[l,C,V,L,g,n,d,ee]);const K=re=>{if(re.preventDefault(),re.stopPropagation(),!l||!o.current||ge)return;const se=o.current,we=se.getBoundingClientRect(),Be=(re.type.includes("touch")?re.touches?re.touches[0].clientX:re.changedTouches[0].clientX:re.clientX)-we.left,$e=g/V,nt=L,ot=Be/se.width,Mt=nt+ot*$e,Dn=Math.round(Mt*1e3)/1e3,Gt=Math.max(0,Math.min(g,Dn));(t==null?void 0:t.current)&&!t.current.paused?(t.current.pause(),setTimeout(()=>{t.current.currentTime=Gt,D(Gt),setTimeout(()=>{t.current.play().catch(Ye=>console.error("Playback error:",Ye))},30)},20)):(t!=null&&t.current&&(t.current.currentTime=Gt),D(Gt)),console.log({zoomLevel:V,canvasWidth:se.width,clickPosition:Be,clickRatio:ot,visibleStart:nt.toFixed(3),visibleDuration:$e.toFixed(3),calculatedTime:Mt.toFixed(3),finalTime:Gt.toFixed(3)}),r&&$_(r,{zoomLevel:V,waveformOffset:L,startPoint:n}).catch(Ye=>console.error("Save on click failed:",Ye))},j=()=>{q(re=>{if(re>=128)return re;const se=Math.min(128,re*2);if(l){const we=g/re,Ie=L+we/2,Be=g/se,$e=Math.max(0,Math.min(g-Be,Ie-Be/2));U($e)}return se})},Q=()=>{q(re=>{if(re<=1)return 1;const se=Math.max(1,re/2);if(se===1)U(0);else if(l){const we=g/re,Ie=L+we/2,Be=g/se,$e=Math.max(0,Math.min(g-Be,Ie-Be/2));U($e)}return se})},ve=()=>{if(!l)return;const re=g/V,se=Math.max(0,Math.min(g-re,n-re/2));U(se)},De=re=>{if(!l)return;re.preventDefault();const se=g/V,we=Math.max(0,g-se),Ie=.05*se;re.deltaY>0?U(Be=>Math.min(we,Be+Ie)):U(Be=>Math.max(0,Be-Ie))},[ge,Fe]=ne.useState(!1),[Le,fe]=ne.useState(0),Xe=re=>{l&&(re.preventDefault(),Fe(!0),fe(re.clientX),re.currentTarget.style.cursor="grabbing")},dt=re=>{if(!ge||!l)return;const se=re.clientX-Le,we=g/V,Ie=T/we,Be=se/Ie,$e=Math.max(0,g-we);U(nt=>Math.max(0,Math.min($e,nt-Be))),fe(re.clientX)},Wt=re=>{Fe(!1),re.currentTarget.style.cursor="grab"},bn=()=>{if(!(t!=null&&t.current)||!e||!r)return;const re=!t.current.paused;re&&t.current.pause();const se=t.current.currentTime,we=Math.round(se*1e3)/1e3;e(we),console.log(`Setting start point to ${we}`),sp(r,{startPoint:we}).then(()=>{console.log("Start point saved successfully"),re&&setTimeout(()=>{t.current.play().catch(Ie=>console.error("Error resuming playback:",Ie))},50)}).catch(Ie=>{console.error("Failed to save start point:",Ie),re&&setTimeout(()=>{t.current.play().catch(Be=>console.error("Error resuming playback:",Be))},50)})},_n=re=>{if(!l||!e||!r)return;const se=t.current&&!t.current.paused;se&&t.current.pause();const we=re*.001,Ie=Math.max(0,Math.min(g,n+we)),Be=Math.round(Ie*1e3)/1e3;if(e(Be),setTimeout(()=>{t.current&&(t.current.currentTime=Be),se&&setTimeout(()=>{t.current.play().catch($e=>console.error("Error resuming playback:",$e))},30)},20),console.log(`Adjusting start point to ${Be}`),sp(r,{startPoint:Be}).then(()=>{console.log("Adjusted start point saved successfully")}).catch($e=>{console.error("Failed to save adjusted start point:",$e)}),V>1){const $e=g/V,nt=L,ot=nt+$e;if(Ie<nt||Ie>ot){const Mt=Math.max(0,Math.min(g-$e,Ie-$e/2));U(Mt)}}};return w.jsx("div",{className:"waveform-container",ref:a,children:d?w.jsxs("div",{className:"waveform-loading",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"150px",width:"100%",background:"#121212",borderRadius:"8px",padding:"20px"},children:[w.jsx("div",{style:{width:"90%",background:"#333",borderRadius:"4px",overflow:"hidden",height:"15px",margin:"10px 0 15px 0"},children:w.jsx("div",{style:{width:`${P}%`,background:"linear-gradient(to right, #FF8400, #FFD700)",height:"100%",borderRadius:"4px",transition:"width 0.3s ease-in-out"}})}),w.jsx("div",{style:{color:"#FFD700",fontSize:"16px",fontWeight:"500",textAlign:"center"},children:M}),w.jsxs("div",{style:{fontSize:"14px",color:"#AAA",marginTop:"10px"},children:[P,"% Complete"]}),w.jsxs("div",{style:{fontSize:"12px",color:"#888",marginTop:"5px",textAlign:"center",maxWidth:"80%"},children:[I==="cached"&&"Using previously cached audio for faster loading",I==="streaming"&&"Just Catching the Groove, May Take a Moment",I==="basic-waveform"&&"Creating audio visualization",I==="error"&&"There was an error loading the audio. Please try again."]})]}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"waveform-canvas-container",style:{position:"relative",cursor:ge?"grabbing":"grab",touchAction:"pan-x"},onWheel:De,onMouseDown:Xe,onMouseMove:dt,onMouseUp:Wt,onMouseLeave:Wt,onClick:K,onTouchStart:re=>{if(!l)return;const se=re.touches[0],we=o.current.getBoundingClientRect();se.clientX>=we.left&&se.clientX<=we.right&&se.clientY>=we.top&&se.clientY<=we.bottom&&(Fe(!0),fe(se.clientX),re.currentTarget.style.cursor="grabbing")},onTouchMove:re=>{if(!ge||!l)return;const se=re.touches[0],we=se.clientX-Le,Ie=g/V,Be=T/Ie,$e=we/Be,nt=Math.max(0,g-Ie);U(ot=>Math.max(0,Math.min(nt,ot-$e))),fe(se.clientX)},onTouchEnd:re=>{ge||K(re),Fe(!1),re.currentTarget.style.cursor="grab"},onTouchCancel:re=>{Fe(!1),re.currentTarget.style.cursor="grab"},children:[w.jsx("canvas",{ref:o,width:800,height:80,className:"waveform-canvas"}),w.jsx("button",{onClick:ve,style:{position:"absolute",top:"5px",left:"30px",background:"rgba(255, 215, 0, 0.5)",color:"white",border:"none",borderRadius:"3px",padding:"2px 6px",fontSize:"10px",cursor:"pointer"},title:"Focus view on start point",children:"Find Start"}),w.jsxs("div",{style:{position:"absolute",top:"5px",left:"5px",background:"rgba(0, 0, 0, 0.5)",color:"white",borderRadius:"3px",padding:"2px 5px",fontSize:"10px"},children:[V,"x"]})]}),w.jsxs("div",{className:"waveform-timestamps",style:{display:"flex",justifyContent:"space-between",padding:"5px 0",gap:"10px",fontSize:"12px",fontFamily:"monospace"},children:[w.jsxs("span",{children:["Position: ",Z(C)]}),w.jsxs("span",{className:"start-point",style:{...ce,color:"white",fontSize:"14px",border:"solid 2px orange",borderRadius:"3px",padding:"2px 5px",cursor:"pointer"},onClick:ve,title:"Click to focus on start point",children:["Start: ",Z(n)]}),w.jsxs("span",{className:"duration",style:{...ce,color:"white",fontSize:"14px",border:"solid 2px white",borderRadius:"3px",padding:"2px 5px"},children:["Total: ",Z(g)]})]}),w.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"5px 0",margin:"5px 0"},children:w.jsxs("div",{style:{display:"flex",gap:"5px"},children:[w.jsx("button",{onClick:Q,disabled:V<=1,style:{...ce,background:V>=128?"#555":"#222",color:"white",border:"solid 2px white",borderRadius:"3px",padding:"3px 8px",fontSize:"16px",fontFamily:"Arial, sans-serif",cursor:V>=128?"not-allowed":"pointer"},children:w.jsx(B1,{})}),w.jsx("button",{onClick:j,disabled:V>=128,style:{...ce,background:V>=128?"#555":"#222",color:"white",border:"solid 2px white",borderRadius:"3px",padding:"3px 8px",fontSize:"16px",fontFamily:"Arial, sans-serif",cursor:V>=128?"not-allowed":"pointer"},children:w.jsx(W1,{})})]})}),w.jsxs("div",{className:"navigation-controls",style:{display:"flex",justifyContent:"center",gap:"8px",padding:"10px 0"},children:[w.jsx("button",{onClick:()=>_n(-20),style:{...ce,background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px"},children:"-20 ms"}),w.jsx("button",{onClick:()=>_n(-5),style:{...ce,background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px"},children:"-5 ms"}),w.jsx("button",{onClick:()=>_n(5),style:{...ce,background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px"},children:"+5 ms"}),w.jsx("button",{onClick:()=>_n(20),style:{...ce,background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px"},children:"+20 ms"})]}),w.jsx("button",{className:"set-start-point-button",onClick:bn,style:{...ce,background:"#FFD700",border:"none",borderRadius:"4px",padding:"10px",margin:"5px 0",color:"#333",fontSeize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%"},children:"Set Start Point"}),w.jsx("div",{className:"audio-progress",style:{margin:"15px 0 5px 0",width:"100%"},children:w.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:(C-L)/(g/V),onMouseDown:()=>{t!=null&&t.current&&!t.current.paused&&t.current.pause()},onMouseUp:()=>{t!=null&&t.current&&pe.current&&t.current.play().catch(re=>console.error("Resume error:",re))},onChange:re=>{const se=parseFloat(re.target.value),we=g/V,Ie=L+se*we;t!=null&&t.current&&(t.current.currentTime=Ie),D(Ie)},className:"progress-slider",style:{width:"100%",height:"10px",borderRadius:"5px",outline:"none",background:`linear-gradient(to right, rgb(255, 132, 0) ${(C-L)/(g/V)*100}%, rgb(32, 32, 32) ${(C-L)/(g/V)*100}%)`,cursor:"pointer"}})})]})})},m2=r=>{if(r.includes("audius.co/")){const e=r.split("/");return e[e.length-1]}return null},g2=r=>(e,t)=>(r.set(e,t),t),W_=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,YE=536870912,G_=YE*2,y2=(r,e)=>t=>{const n=e.get(t);let o=n===void 0?t.size:n<G_?n+1:0;if(!t.has(o))return r(t,o);if(t.size<YE){for(;t.has(o);)o=Math.floor(Math.random()*G_);return r(t,o)}if(t.size>W_)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;t.has(o);)o=Math.floor(Math.random()*W_);return r(t,o)},ZE=new WeakMap,v2=g2(ZE),_2=y2(v2,ZE),w2=r=>typeof r.start=="function",H_=new WeakMap,E2=r=>({...r,connect:({call:e})=>async()=>{const{port1:t,port2:n}=new MessageChannel,o=await e("connect",{port:t},[t]);return H_.set(n,o),n},disconnect:({call:e})=>async t=>{const n=H_.get(t);if(n===void 0)throw new Error("The given port is not connected.");await e("disconnect",{portId:n})},isSupported:({call:e})=>()=>e("isSupported")}),op=new WeakMap,T2=r=>{if(op.has(r))return op.get(r);const e=new Map;return op.set(r,e),e},I2=r=>{const e=E2(r);return t=>{const n=T2(t);t.addEventListener("message",({data:u})=>{const{id:d}=u;if(d!==null&&n.has(d)){const{reject:p,resolve:g}=n.get(d);n.delete(d),u.error===void 0?g(u.result):p(new Error(u.error.message))}}),w2(t)&&t.start();const o=(u,d=null,p=[])=>new Promise((g,v)=>{const T=_2(n);n.set(T,{reject:v,resolve:g}),d===null?t.postMessage({id:T,method:u},p):t.postMessage({id:T,method:u,params:d},p)}),a=(u,d,p=[])=>{t.postMessage({id:null,method:u,params:d},p)};let l={};for(const[u,d]of Object.entries(e))l={...l,[u]:d({call:o,notify:a})};return{...l}}},K_=(r,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:r}),Q_=(r,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:r}),Fp=(r,e)=>({startTime:e,type:"setValue",value:r}),JE=(r,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:r}),eT=(r,e,{startTime:t,target:n,timeConstant:o})=>n+(e-n)*Math.exp((t-r)/o),va=r=>r.type==="exponentialRampToValue",Mh=r=>r.type==="linearRampToValue",go=r=>va(r)||Mh(r),Pm=r=>r.type==="setValue",ks=r=>r.type==="setValueCurve",Oh=(r,e,t,n)=>{const o=r[e];return o===void 0?n:go(o)||Pm(o)?o.value:ks(o)?o.values[o.values.length-1]:eT(t,Oh(r,e-1,o.startTime,n),o)},X_=(r,e,t,n,o)=>t===void 0?[n.insertTime,o]:go(t)?[t.endTime,t.value]:Pm(t)?[t.startTime,t.value]:ks(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,Oh(r,e-1,t.startTime,o)],jp=r=>r.type==="cancelAndHold",Lp=r=>r.type==="cancelScheduledValues",po=r=>jp(r)||Lp(r)?r.cancelTime:va(r)||Mh(r)?r.endTime:r.startTime,Y_=(r,e,t,{endTime:n,value:o})=>t===o?o:0<t&&0<o||t<0&&o<0?t*(o/t)**((r-e)/(n-e)):0,Z_=(r,e,t,{endTime:n,value:o})=>t+(r-e)/(n-e)*(o-t),S2=(r,e)=>{const t=Math.floor(e),n=Math.ceil(e);return t===n?r[t]:(1-(e-t))*r[t]+(1-(n-e))*r[n]},x2=(r,{duration:e,startTime:t,values:n})=>{const o=(r-t)/e*(n.length-1);return S2(n,o)},Qu=r=>r.type==="setTarget";class C2{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=po(e);if(jp(e)||Lp(e)){const n=this._automationEvents.findIndex(a=>Lp(e)&&ks(a)?a.startTime+a.duration>=t:po(a)>=t),o=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),jp(e)){const a=this._automationEvents[this._automationEvents.length-1];if(o!==void 0&&go(o)){if(a!==void 0&&Qu(a))throw new Error("The internal list is malformed.");const l=a===void 0?o.insertTime:ks(a)?a.startTime+a.duration:po(a),u=a===void 0?this._defaultValue:ks(a)?a.values[a.values.length-1]:a.value,d=va(o)?Y_(t,l,u,o):Z_(t,l,u,o),p=va(o)?K_(d,t,this._currenTime):Q_(d,t,this._currenTime);this._automationEvents.push(p)}if(a!==void 0&&Qu(a)&&this._automationEvents.push(Fp(this.getValue(t),t)),a!==void 0&&ks(a)&&a.startTime+a.duration>t){const l=t-a.startTime,u=(a.values.length-1)/a.duration,d=Math.max(2,1+Math.ceil(l*u)),p=l/(d-1)*u,g=a.values.slice(0,d);if(p<1)for(let v=1;v<d;v+=1){const T=p*v%1;g[v]=a.values[v-1]*(1-T)+a.values[v]*T}this._automationEvents[this._automationEvents.length-1]=JE(g,a.startTime,l)}}}else{const n=this._automationEvents.findIndex(l=>po(l)>t),o=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(o!==void 0&&ks(o)&&po(o)+o.duration>t)return!1;const a=va(e)?K_(e.value,e.endTime,this._currenTime):Mh(e)?Q_(e.value,t,this._currenTime):e;if(n===-1)this._automationEvents.push(a);else{if(ks(e)&&t+e.duration>po(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,a)}}return!0}flush(e){const t=this._automationEvents.findIndex(n=>po(n)>e);if(t>1){const n=this._automationEvents.slice(t-1),o=n[0];Qu(o)&&n.unshift(Fp(Oh(this._automationEvents,t-2,o.startTime,this._defaultValue),o.startTime)),this._automationEvents=n}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(l=>po(l)>e),n=this._automationEvents[t],o=(t===-1?this._automationEvents.length:t)-1,a=this._automationEvents[o];if(a!==void 0&&Qu(a)&&(n===void 0||!go(n)||n.insertTime>e))return eT(e,Oh(this._automationEvents,o-1,a.startTime,this._defaultValue),a);if(a!==void 0&&Pm(a)&&(n===void 0||!go(n)))return a.value;if(a!==void 0&&ks(a)&&(n===void 0||!go(n)||a.startTime+a.duration>e))return e<a.startTime+a.duration?x2(e,a):a.values[a.values.length-1];if(a!==void 0&&go(a)&&(n===void 0||!go(n)))return a.value;if(n!==void 0&&va(n)){const[l,u]=X_(this._automationEvents,o,a,n,this._defaultValue);return Y_(e,l,u,n)}if(n!==void 0&&Mh(n)){const[l,u]=X_(this._automationEvents,o,a,n,this._defaultValue);return Z_(e,l,u,n)}return this._defaultValue}}const A2=r=>({cancelTime:r,type:"cancelAndHold"}),N2=r=>({cancelTime:r,type:"cancelScheduledValues"}),R2=(r,e)=>({endTime:e,type:"exponentialRampToValue",value:r}),k2=(r,e)=>({endTime:e,type:"linearRampToValue",value:r}),P2=(r,e,t)=>({startTime:e,target:r,timeConstant:t,type:"setTarget"}),b2=()=>new DOMException("","AbortError"),D2=r=>(e,t,[n,o,a],l)=>{r(e[o],[t,n,a],u=>u[0]===t&&u[1]===n,l)},V2=r=>(e,t,n)=>{const o=[];for(let a=0;a<n.numberOfInputs;a+=1)o.push(new Set);r.set(e,{activeInputs:o,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},M2=r=>(e,t)=>{r.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Oa=new WeakSet,tT=new WeakMap,nT=new WeakMap,rT=new WeakMap,sT=new WeakMap,oT=new WeakMap,iT=new WeakMap,Bp=new WeakMap,J_=new WeakMap,aT={construct(){return aT}},O2=r=>{try{const e=new Proxy(r,aT);new e}catch{return!1}return!0},e0=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,t0=(r,e)=>{const t=[];let n=r.replace(/^[\s]+/,""),o=n.match(e0);for(;o!==null;){const a=o[1].slice(1,-1),l=o[0].replace(/([\s]+)?;?$/,"").replace(a,new URL(a,e).toString());t.push(l),n=n.slice(o[0].length).replace(/^[\s]+/,""),o=n.match(e0)}return[t.join(";"),n]},n0=r=>{if(r!==void 0&&!Array.isArray(r))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},r0=r=>{if(!O2(r))throw new TypeError("The given value for processorCtor should be a constructor.");if(r.prototype===null||typeof r.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},F2=(r,e,t,n,o,a,l,u,d,p,g,v,T)=>{let S=0;return(C,D,V={credentials:"omit"})=>{const q=g.get(C);if(q!==void 0&&q.has(D))return Promise.resolve();const L=p.get(C);if(L!==void 0){const O=L.get(D);if(O!==void 0)return O}const U=a(C),X=U.audioWorklet===void 0?o(D).then(([O,B])=>{const[A,I]=t0(O,B),N=`${A};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${I}
})})(window,'_AWGS')`;return t(N)}).then(()=>{const O=T._AWGS.pop();if(O===void 0)throw new SyntaxError;n(U.currentTime,U.sampleRate,()=>O(class{},void 0,(B,A)=>{if(B.trim()==="")throw e();const I=J_.get(U);if(I!==void 0){if(I.has(B))throw e();r0(A),n0(A.parameterDescriptors),I.set(B,A)}else r0(A),n0(A.parameterDescriptors),J_.set(U,new Map([[B,A]]))},U.sampleRate,void 0,void 0))}):Promise.all([o(D),Promise.resolve(r(v,v))]).then(([[O,B],A])=>{const I=S+1;S=I;const[N,P]=t0(O,B),ue=`${N};((AudioWorkletProcessor,registerProcessor)=>{${P}
})(${A?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${A?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${A?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${I}',class extends AudioWorkletProcessor{process(){return !1}})`,ye=new Blob([ue],{type:"application/javascript; charset=utf-8"}),pe=URL.createObjectURL(ye);return U.audioWorklet.addModule(pe,V).then(()=>{if(u(U))return U;const ce=l(U);return ce.audioWorklet.addModule(pe,V).then(()=>ce)}).then(ce=>{if(d===null)throw new SyntaxError;try{new d(ce,`__sac${I}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(pe))});return L===void 0?p.set(C,new Map([[D,X]])):L.set(D,X),X.then(()=>{const O=g.get(C);O===void 0?g.set(C,new Set([D])):O.add(D)}).finally(()=>{const O=p.get(C);O!==void 0&&O.delete(D)}),X}},Po=(r,e)=>{const t=r.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},od=(r,e)=>{const t=Array.from(r).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[n]=t;return r.delete(n),n},lT=(r,e,t,n)=>{const o=Po(r,e),a=od(o,l=>l[0]===t&&l[1]===n);return o.size===0&&r.delete(e),a},_c=r=>Po(iT,r),Fa=r=>{if(Oa.has(r))throw new Error("The AudioNode is already stored.");Oa.add(r),_c(r).forEach(e=>e(!0))},cT=r=>"port"in r,wc=r=>{if(!Oa.has(r))throw new Error("The AudioNode is not stored.");Oa.delete(r),_c(r).forEach(e=>e(!1))},zp=(r,e)=>{!cT(r)&&e.every(t=>t.size===0)&&wc(r)},j2=(r,e,t,n,o,a,l,u,d,p,g,v,T)=>{const S=new WeakMap;return(C,D,V,q,L)=>{const{activeInputs:U,passiveInputs:X}=a(D),{outputs:O}=a(C),B=u(C),A=I=>{const N=d(D),P=d(C);if(I){const b=lT(X,C,V,q);r(U,C,b,!1),!L&&!v(C)&&t(P,N,V,q),T(D)&&Fa(D)}else{const b=n(U,C,V,q);e(X,q,b,!1),!L&&!v(C)&&o(P,N,V,q);const M=l(D);if(M===0)g(D)&&zp(D,U);else{const R=S.get(D);R!==void 0&&clearTimeout(R),S.set(D,setTimeout(()=>{g(D)&&zp(D,U)},M*1e3))}}};return p(O,[D,V,q],I=>I[0]===D&&I[1]===V&&I[2]===q,!0)?(B.add(A),g(C)?r(U,C,[V,q,A],!0):e(X,q,[C,V,A],!0),!0):!1}},L2=r=>(e,t,[n,o,a],l)=>{const u=e.get(n);u===void 0?e.set(n,new Set([[o,t,a]])):r(u,[o,t,a],d=>d[0]===o&&d[1]===t,l)},B2=r=>(e,t)=>{const n=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const o=()=>{t.removeEventListener("ended",o),t.disconnect(n),n.disconnect()};t.addEventListener("ended",o)},z2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},U2=(r,e,t,n,o,a)=>class extends r{constructor(u,d){const p=o(u),g={...z2,...d},v=n(p,g),T=a(p)?e():null;super(u,!1,v,T),this._nativeAnalyserNode=v}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(u){this._nativeAnalyserNode.fftSize=u}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(u){const d=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=u,!(u>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=d,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(u){const d=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=u,!(this._nativeAnalyserNode.maxDecibels>u))throw this._nativeAnalyserNode.minDecibels=d,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(u){this._nativeAnalyserNode.smoothingTimeConstant=u}getByteFrequencyData(u){this._nativeAnalyserNode.getByteFrequencyData(u)}getByteTimeDomainData(u){this._nativeAnalyserNode.getByteTimeDomainData(u)}getFloatFrequencyData(u){this._nativeAnalyserNode.getFloatFrequencyData(u)}getFloatTimeDomainData(u){this._nativeAnalyserNode.getFloatTimeDomainData(u)}},zn=(r,e)=>r.context===e,$2=(r,e,t)=>()=>{const n=new WeakMap,o=async(a,l)=>{let u=e(a);if(!zn(u,l)){const p={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,fftSize:u.fftSize,maxDecibels:u.maxDecibels,minDecibels:u.minDecibels,smoothingTimeConstant:u.smoothingTimeConstant};u=r(l,p)}return n.set(l,u),await t(a,l,u),u};return{render(a,l){const u=n.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Fh=r=>{try{r.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Ii=()=>new DOMException("","IndexSizeError"),bm=r=>{r.getChannelData=(e=>t=>{try{return e.call(r,t)}catch(n){throw n.code===12?Ii():n}})(r.getChannelData)},q2={numberOfChannels:1},W2=(r,e,t,n,o,a,l,u)=>{let d=null;return class uT{constructor(g){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:v,numberOfChannels:T,sampleRate:S}={...q2,...g};d===null&&(d=new o(1,1,44100));const C=n!==null&&e(a,a)?new n({length:v,numberOfChannels:T,sampleRate:S}):d.createBuffer(T,v,S);if(C.numberOfChannels===0)throw t();return typeof C.copyFromChannel!="function"?(l(C),bm(C)):e(Fh,()=>Fh(C))||u(C),r.add(C),C}static[Symbol.hasInstance](g){return g!==null&&typeof g=="object"&&Object.getPrototypeOf(g)===uT.prototype||r.has(g)}}},xr=-34028234663852886e22,Zn=34028234663852886e22,Vs=r=>Oa.has(r),G2={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},H2=(r,e,t,n,o,a,l,u)=>class extends r{constructor(p,g){const v=a(p),T={...G2,...g},S=o(v,T),C=l(v),D=C?e():null;super(p,!1,S,D),this._audioBufferSourceNodeRenderer=D,this._isBufferNullified=!1,this._isBufferSet=T.buffer!==null,this._nativeAudioBufferSourceNode=S,this._onended=null,this._playbackRate=t(this,C,S.playbackRate,Zn,xr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(p){if(this._nativeAudioBufferSourceNode.buffer=p,p!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(p){this._nativeAudioBufferSourceNode.loop=p}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(p){this._nativeAudioBufferSourceNode.loopEnd=p}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(p){this._nativeAudioBufferSourceNode.loopStart=p}get onended(){return this._onended}set onended(p){const g=typeof p=="function"?u(this,p):null;this._nativeAudioBufferSourceNode.onended=g;const v=this._nativeAudioBufferSourceNode.onended;this._onended=v!==null&&v===g?p:v}get playbackRate(){return this._playbackRate}start(p=0,g=0,v){if(this._nativeAudioBufferSourceNode.start(p,g,v),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=v===void 0?[p,g]:[p,g,v]),this.context.state!=="closed"){Fa(this);const T=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",T),Vs(this)&&wc(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",T)}}stop(p=0){this._nativeAudioBufferSourceNode.stop(p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=p)}},K2=(r,e,t,n,o)=>()=>{const a=new WeakMap;let l=null,u=null;const d=async(p,g)=>{let v=t(p);const T=zn(v,g);if(!T){const S={buffer:v.buffer,channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,loop:v.loop,loopEnd:v.loopEnd,loopStart:v.loopStart,playbackRate:v.playbackRate.value};v=e(g,S),l!==null&&v.start(...l),u!==null&&v.stop(u)}return a.set(g,v),T?await r(g,p.playbackRate,v.playbackRate):await n(g,p.playbackRate,v.playbackRate),await o(p,g,v),v};return{set start(p){l=p},set stop(p){u=p},render(p,g){const v=a.get(g);return v!==void 0?Promise.resolve(v):d(p,g)}}},Q2=r=>"playbackRate"in r,X2=r=>"frequency"in r&&"gain"in r,Y2=r=>"offset"in r,Z2=r=>!("frequency"in r)&&"gain"in r,J2=r=>"detune"in r&&"frequency"in r&&!("gain"in r),ek=r=>"pan"in r,cr=r=>Po(tT,r),Ec=r=>Po(rT,r),Up=(r,e)=>{const{activeInputs:t}=cr(r);t.forEach(o=>o.forEach(([a])=>{e.includes(r)||Up(a,[...e,r])}));const n=Q2(r)?[r.playbackRate]:cT(r)?Array.from(r.parameters.values()):X2(r)?[r.Q,r.detune,r.frequency,r.gain]:Y2(r)?[r.offset]:Z2(r)?[r.gain]:J2(r)?[r.detune,r.frequency]:ek(r)?[r.pan]:[];for(const o of n){const a=Ec(o);a!==void 0&&a.activeInputs.forEach(([l])=>Up(l,e))}Vs(r)&&wc(r)},tk=r=>{Up(r.destination,[])},nk=(r,e,t,n,o,a,l,u)=>class extends r{constructor(p,g){const v=a(p),T=l(v),S=o(v,g,T),C=T?e(u):null;super(p,!1,S,C),this._isNodeOfNativeOfflineAudioContext=T,this._nativeAudioDestinationNode=S}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(p>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=p}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=p}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},rk=r=>{const e=new WeakMap,t=async(n,o)=>{const a=o.destination;return e.set(o,a),await r(n,o,a),a};return{render(n,o){const a=e.get(o);return a!==void 0?Promise.resolve(a):t(n,o)}}},sk=(r,e,t,n,o,a,l,u)=>(d,p)=>{const g=p.listener,v=()=>{const O=new Float32Array(1),B=e(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),A=l(p);let I=!1,N=[0,0,-1,0,1,0],P=[0,0,0];const b=()=>{if(I)return;I=!0;const ye=n(p,256,9,0);ye.onaudioprocess=({inputBuffer:pe})=>{const ce=[a(pe,O,0),a(pe,O,1),a(pe,O,2),a(pe,O,3),a(pe,O,4),a(pe,O,5)];ce.some((ee,K)=>ee!==N[K])&&(g.setOrientation(...ce),N=ce);const Z=[a(pe,O,6),a(pe,O,7),a(pe,O,8)];Z.some((ee,K)=>ee!==P[K])&&(g.setPosition(...Z),P=Z)},B.connect(ye)},M=ye=>pe=>{pe!==N[ye]&&(N[ye]=pe,g.setOrientation(...N))},R=ye=>pe=>{pe!==P[ye]&&(P[ye]=pe,g.setPosition(...P))},ue=(ye,pe,ce)=>{const Z=t(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:pe});Z.connect(B,0,ye),Z.start(),Object.defineProperty(Z.offset,"defaultValue",{get(){return pe}});const ee=r({context:d},A,Z.offset,Zn,xr);return u(ee,"value",K=>()=>K.call(ee),K=>j=>{try{K.call(ee,j)}catch(Q){if(Q.code!==9)throw Q}b(),A&&ce(j)}),ee.cancelAndHoldAtTime=(K=>A?()=>{throw o()}:(...j)=>{const Q=K.apply(ee,j);return b(),Q})(ee.cancelAndHoldAtTime),ee.cancelScheduledValues=(K=>A?()=>{throw o()}:(...j)=>{const Q=K.apply(ee,j);return b(),Q})(ee.cancelScheduledValues),ee.exponentialRampToValueAtTime=(K=>A?()=>{throw o()}:(...j)=>{const Q=K.apply(ee,j);return b(),Q})(ee.exponentialRampToValueAtTime),ee.linearRampToValueAtTime=(K=>A?()=>{throw o()}:(...j)=>{const Q=K.apply(ee,j);return b(),Q})(ee.linearRampToValueAtTime),ee.setTargetAtTime=(K=>A?()=>{throw o()}:(...j)=>{const Q=K.apply(ee,j);return b(),Q})(ee.setTargetAtTime),ee.setValueAtTime=(K=>A?()=>{throw o()}:(...j)=>{const Q=K.apply(ee,j);return b(),Q})(ee.setValueAtTime),ee.setValueCurveAtTime=(K=>A?()=>{throw o()}:(...j)=>{const Q=K.apply(ee,j);return b(),Q})(ee.setValueCurveAtTime),ee};return{forwardX:ue(0,0,M(0)),forwardY:ue(1,0,M(1)),forwardZ:ue(2,-1,M(2)),positionX:ue(6,0,R(0)),positionY:ue(7,0,R(1)),positionZ:ue(8,0,R(2)),upX:ue(3,0,M(3)),upY:ue(4,1,M(4)),upZ:ue(5,0,M(5))}},{forwardX:T,forwardY:S,forwardZ:C,positionX:D,positionY:V,positionZ:q,upX:L,upY:U,upZ:X}=g.forwardX===void 0?v():g;return{get forwardX(){return T},get forwardY(){return S},get forwardZ(){return C},get positionX(){return D},get positionY(){return V},get positionZ(){return q},get upX(){return L},get upY(){return U},get upZ(){return X}}},jh=r=>"context"in r,Tc=r=>jh(r[0]),Si=(r,e,t,n)=>{for(const o of r)if(t(o)){if(n)return!1;throw Error("The set contains at least one similar element.")}return r.add(e),!0},s0=(r,e,[t,n],o)=>{Si(r,[e,t,n],a=>a[0]===e&&a[1]===t,o)},o0=(r,[e,t,n],o)=>{const a=r.get(e);a===void 0?r.set(e,new Set([[t,n]])):Si(a,[t,n],l=>l[0]===t,o)},$a=r=>"inputs"in r,Lh=(r,e,t,n)=>{if($a(e)){const o=e.inputs[n];return r.connect(o,t,0),[o,t,0]}return r.connect(e,t,n),[e,t,n]},hT=(r,e,t)=>{for(const n of r)if(n[0]===e&&n[1]===t)return r.delete(n),n;return null},ok=(r,e,t)=>od(r,n=>n[0]===e&&n[1]===t),dT=(r,e)=>{if(!_c(r).delete(e))throw new Error("Missing the expected event listener.")},fT=(r,e,t)=>{const n=Po(r,e),o=od(n,a=>a[0]===t);return n.size===0&&r.delete(e),o},Bh=(r,e,t,n)=>{$a(e)?r.disconnect(e.inputs[n],t,0):r.disconnect(e,t,n)},kt=r=>Po(nT,r),ac=r=>Po(sT,r),_i=r=>Bp.has(r),oh=r=>!Oa.has(r),i0=(r,e)=>new Promise(t=>{if(e!==null)t(!0);else{const n=r.createScriptProcessor(256,1,1),o=r.createGain(),a=r.createBuffer(1,2,44100),l=a.getChannelData(0);l[0]=1,l[1]=1;const u=r.createBufferSource();u.buffer=a,u.loop=!0,u.connect(n).connect(r.destination),u.connect(o),u.disconnect(o),n.onaudioprocess=d=>{const p=d.inputBuffer.getChannelData(0);Array.prototype.some.call(p,g=>g===1)?t(!0):t(!1),u.stop(),n.onaudioprocess=null,u.disconnect(n),n.disconnect(r.destination)},u.start()}}),ip=(r,e)=>{const t=new Map;for(const n of r)for(const o of n){const a=t.get(o);t.set(o,a===void 0?1:a+1)}t.forEach((n,o)=>e(o,n))},a0=r=>"context"in r,ik=r=>{const e=new Map;r.connect=(t=>(n,o=0,a=0)=>{const l=a0(n)?t(n,o,a):t(n,o),u=e.get(n);return u===void 0?e.set(n,[{input:a,output:o}]):u.every(d=>d.input!==a||d.output!==o)&&u.push({input:a,output:o}),l})(r.connect.bind(r)),r.disconnect=(t=>(n,o,a)=>{if(t.apply(r),n===void 0)e.clear();else if(typeof n=="number")for(const[l,u]of e){const d=u.filter(p=>p.output!==n);d.length===0?e.delete(l):e.set(l,d)}else if(e.has(n))if(o===void 0)e.delete(n);else{const l=e.get(n);if(l!==void 0){const u=l.filter(d=>d.output!==o&&(d.input!==a||a===void 0));u.length===0?e.delete(n):e.set(n,u)}}for(const[l,u]of e)u.forEach(d=>{a0(l)?r.connect(l,d.output,d.input):r.connect(l,d.output)})})(r.disconnect)},ak=(r,e,t,n)=>{const{activeInputs:o,passiveInputs:a}=Ec(e),{outputs:l}=cr(r),u=_c(r),d=p=>{const g=kt(r),v=ac(e);if(p){const T=fT(a,r,t);s0(o,r,T,!1),!n&&!_i(r)&&g.connect(v,t)}else{const T=ok(o,r,t);o0(a,T,!1),!n&&!_i(r)&&g.disconnect(v,t)}};return Si(l,[e,t],p=>p[0]===e&&p[1]===t,!0)?(u.add(d),Vs(r)?s0(o,r,[t,d],!0):o0(a,[r,t,d],!0),!0):!1},lk=(r,e,t,n)=>{const{activeInputs:o,passiveInputs:a}=cr(e),l=hT(o[n],r,t);return l===null?[lT(a,r,t,n)[2],!1]:[l[2],!0]},ck=(r,e,t)=>{const{activeInputs:n,passiveInputs:o}=Ec(e),a=hT(n,r,t);return a===null?[fT(o,r,t)[1],!1]:[a[2],!0]},Dm=(r,e,t,n,o)=>{const[a,l]=lk(r,t,n,o);if(a!==null&&(dT(r,a),l&&!e&&!_i(r)&&Bh(kt(r),kt(t),n,o)),Vs(t)){const{activeInputs:u}=cr(t);zp(t,u)}},Vm=(r,e,t,n)=>{const[o,a]=ck(r,t,n);o!==null&&(dT(r,o),a&&!e&&!_i(r)&&kt(r).disconnect(ac(t),n))},uk=(r,e)=>{const t=cr(r),n=[];for(const o of t.outputs)Tc(o)?Dm(r,e,...o):Vm(r,e,...o),n.push(o[0]);return t.outputs.clear(),n},hk=(r,e,t)=>{const n=cr(r),o=[];for(const a of n.outputs)a[1]===t&&(Tc(a)?Dm(r,e,...a):Vm(r,e,...a),o.push(a[0]),n.outputs.delete(a));return o},dk=(r,e,t,n,o)=>{const a=cr(r);return Array.from(a.outputs).filter(l=>l[0]===t&&(n===void 0||l[1]===n)&&(o===void 0||l[2]===o)).map(l=>(Tc(l)?Dm(r,e,...l):Vm(r,e,...l),a.outputs.delete(l),l[0]))},fk=(r,e,t,n,o,a,l,u,d,p,g,v,T,S,C,D)=>class extends p{constructor(q,L,U,X){super(U),this._context=q,this._nativeAudioNode=U;const O=g(q);v(O)&&t(i0,()=>i0(O,D))!==!0&&ik(U),nT.set(this,U),iT.set(this,new Set),q.state!=="closed"&&L&&Fa(this),r(this,X,U)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(q){this._nativeAudioNode.channelCount=q}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(q){this._nativeAudioNode.channelCountMode=q}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(q){this._nativeAudioNode.channelInterpretation=q}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(q,L=0,U=0){if(L<0||L>=this._nativeAudioNode.numberOfOutputs)throw o();const X=g(this._context),O=C(X);if(T(q)||S(q))throw a();if(jh(q)){const I=kt(q);try{const P=Lh(this._nativeAudioNode,I,L,U),b=oh(this);(O||b)&&this._nativeAudioNode.disconnect(...P),this.context.state!=="closed"&&!b&&oh(q)&&Fa(q)}catch(P){throw P.code===12?a():P}if(e(this,q,L,U,O)){const P=d([this],q);ip(P,n(O))}return q}const B=ac(q);if(B.name==="playbackRate"&&B.maxValue===1024)throw l();try{this._nativeAudioNode.connect(B,L),(O||oh(this))&&this._nativeAudioNode.disconnect(B,L)}catch(I){throw I.code===12?a():I}if(ak(this,q,L,O)){const I=d([this],q);ip(I,n(O))}}disconnect(q,L,U){let X;const O=g(this._context),B=C(O);if(q===void 0)X=uk(this,B);else if(typeof q=="number"){if(q<0||q>=this.numberOfOutputs)throw o();X=hk(this,B,q)}else{if(L!==void 0&&(L<0||L>=this.numberOfOutputs)||jh(q)&&U!==void 0&&(U<0||U>=q.numberOfInputs))throw o();if(X=dk(this,B,q,L,U),X.length===0)throw a()}for(const A of X){const I=d([this],A);ip(I,u)}}},pk=(r,e,t,n,o,a,l,u,d,p,g,v,T)=>(S,C,D,V=null,q=null)=>{const L=D.value,U=new C2(L),X=C?n(U):null,O={get defaultValue(){return L},get maxValue(){return V===null?D.maxValue:V},get minValue(){return q===null?D.minValue:q},get value(){return D.value},set value(B){D.value=B,O.setValueAtTime(B,S.context.currentTime)},cancelAndHoldAtTime(B){if(typeof D.cancelAndHoldAtTime=="function")X===null&&U.flush(S.context.currentTime),U.add(o(B)),D.cancelAndHoldAtTime(B);else{const A=Array.from(U).pop();X===null&&U.flush(S.context.currentTime),U.add(o(B));const I=Array.from(U).pop();D.cancelScheduledValues(B),A!==I&&I!==void 0&&(I.type==="exponentialRampToValue"?D.exponentialRampToValueAtTime(I.value,I.endTime):I.type==="linearRampToValue"?D.linearRampToValueAtTime(I.value,I.endTime):I.type==="setValue"?D.setValueAtTime(I.value,I.startTime):I.type==="setValueCurve"&&D.setValueCurveAtTime(I.values,I.startTime,I.duration))}return O},cancelScheduledValues(B){return X===null&&U.flush(S.context.currentTime),U.add(a(B)),D.cancelScheduledValues(B),O},exponentialRampToValueAtTime(B,A){if(B===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;const I=S.context.currentTime;return X===null&&U.flush(I),Array.from(U).length===0&&(U.add(p(L,I)),D.setValueAtTime(L,I)),U.add(l(B,A)),D.exponentialRampToValueAtTime(B,A),O},linearRampToValueAtTime(B,A){const I=S.context.currentTime;return X===null&&U.flush(I),Array.from(U).length===0&&(U.add(p(L,I)),D.setValueAtTime(L,I)),U.add(u(B,A)),D.linearRampToValueAtTime(B,A),O},setTargetAtTime(B,A,I){return X===null&&U.flush(S.context.currentTime),U.add(d(B,A,I)),D.setTargetAtTime(B,A,I),O},setValueAtTime(B,A){return X===null&&U.flush(S.context.currentTime),U.add(p(B,A)),D.setValueAtTime(B,A),O},setValueCurveAtTime(B,A,I){const N=B instanceof Float32Array?B:new Float32Array(B);if(v!==null&&v.name==="webkitAudioContext"){const P=A+I,b=S.context.sampleRate,M=Math.ceil(A*b),R=Math.floor(P*b),ue=R-M,ye=new Float32Array(ue);for(let ce=0;ce<ue;ce+=1){const Z=(N.length-1)/I*((M+ce)/b-A),ee=Math.floor(Z),K=Math.ceil(Z);ye[ce]=ee===K?N[ee]:(1-(Z-ee))*N[ee]+(1-(K-Z))*N[K]}X===null&&U.flush(S.context.currentTime),U.add(g(ye,A,I)),D.setValueCurveAtTime(ye,A,I);const pe=R/b;pe<P&&T(O,ye[ye.length-1],pe),T(O,N[N.length-1],P)}else X===null&&U.flush(S.context.currentTime),U.add(g(N,A,I)),D.setValueCurveAtTime(N,A,I);return O}};return t.set(O,D),e.set(O,S),r(O,X),O},mk=r=>({replay(e){for(const t of r)if(t.type==="exponentialRampToValue"){const{endTime:n,value:o}=t;e.exponentialRampToValueAtTime(o,n)}else if(t.type==="linearRampToValue"){const{endTime:n,value:o}=t;e.linearRampToValueAtTime(o,n)}else if(t.type==="setTarget"){const{startTime:n,target:o,timeConstant:a}=t;e.setTargetAtTime(o,n,a)}else if(t.type==="setValue"){const{startTime:n,value:o}=t;e.setValueAtTime(o,n)}else if(t.type==="setValueCurve"){const{duration:n,startTime:o,values:a}=t;e.setValueCurveAtTime(a,o,n)}else throw new Error("Can't apply an unknown automation.")}}),gk=(r,e,t,n,o,a,l,u,d,p,g,v,T,S,C,D,V,q,L,U)=>class extends C{constructor(O,B){super(O,B),this._nativeContext=O,this._audioWorklet=r===void 0?void 0:{addModule:(A,I)=>r(this,A,I)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new o(this)}createBuffer(O,B,A){return new t({length:B,numberOfChannels:O,sampleRate:A})}createBufferSource(){return new n(this)}createChannelMerger(O=6){return new a(this,{numberOfInputs:O})}createChannelSplitter(O=6){return new l(this,{numberOfOutputs:O})}createConstantSource(){return new u(this)}createConvolver(){return new d(this)}createDelay(O=1){return new g(this,{maxDelayTime:O})}createDynamicsCompressor(){return new v(this)}createGain(){return new T(this)}createIIRFilter(O,B){return new S(this,{feedback:B,feedforward:O})}createOscillator(){return new D(this)}createPanner(){return new V(this)}createPeriodicWave(O,B,A={disableNormalization:!1}){return new q(this,{...A,imag:B,real:O})}createStereoPanner(){return new L(this)}createWaveShaper(){return new U(this)}decodeAudioData(O,B,A){return p(this._nativeContext,O).then(I=>(typeof B=="function"&&B(I),I),I=>{throw typeof A=="function"&&A(I),I})}},yk={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},vk=(r,e,t,n,o,a,l,u)=>class extends r{constructor(p,g){const v=a(p),T={...yk,...g},S=o(v,T),C=l(v),D=C?t():null;super(p,!1,S,D),this._Q=e(this,C,S.Q,Zn,xr),this._detune=e(this,C,S.detune,1200*Math.log2(Zn),-1200*Math.log2(Zn)),this._frequency=e(this,C,S.frequency,p.sampleRate/2,0),this._gain=e(this,C,S.gain,40*Math.log10(Zn),xr),this._nativeBiquadFilterNode=S,u(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(p){this._nativeBiquadFilterNode.type=p}getFrequencyResponse(p,g,v){try{this._nativeBiquadFilterNode.getFrequencyResponse(p,g,v)}catch(T){throw T.code===11?n():T}if(p.length!==g.length||g.length!==v.length)throw n()}},_k=(r,e,t,n,o)=>()=>{const a=new WeakMap,l=async(u,d)=>{let p=t(u);const g=zn(p,d);if(!g){const v={Q:p.Q.value,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,gain:p.gain.value,type:p.type};p=e(d,v)}return a.set(d,p),g?(await r(d,u.Q,p.Q),await r(d,u.detune,p.detune),await r(d,u.frequency,p.frequency),await r(d,u.gain,p.gain)):(await n(d,u.Q,p.Q),await n(d,u.detune,p.detune),await n(d,u.frequency,p.frequency),await n(d,u.gain,p.gain)),await o(u,d,p),p};return{render(u,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):l(u,d)}}},wk=(r,e)=>(t,n)=>{const o=e.get(t);if(o!==void 0)return o;const a=r.get(t);if(a!==void 0)return a;try{const l=n();return l instanceof Promise?(r.set(t,l),l.catch(()=>!1).then(u=>(r.delete(t),e.set(t,u),u))):(e.set(t,l),l)}catch{return e.set(t,!1),!1}},Ek={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Tk=(r,e,t,n,o)=>class extends r{constructor(l,u){const d=n(l),p={...Ek,...u},g=t(d,p),v=o(d)?e():null;super(l,!1,g,v)}},Ik=(r,e,t)=>()=>{const n=new WeakMap,o=async(a,l)=>{let u=e(a);if(!zn(u,l)){const p={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfInputs:u.numberOfInputs};u=r(l,p)}return n.set(l,u),await t(a,l,u),u};return{render(a,l){const u=n.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Sk={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},xk=(r,e,t,n,o,a)=>class extends r{constructor(u,d){const p=n(u),g=a({...Sk,...d}),v=t(p,g),T=o(p)?e():null;super(u,!1,v,T)}},Ck=(r,e,t)=>()=>{const n=new WeakMap,o=async(a,l)=>{let u=e(a);if(!zn(u,l)){const p={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfOutputs:u.numberOfOutputs};u=r(l,p)}return n.set(l,u),await t(a,l,u),u};return{render(a,l){const u=n.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Ak=r=>(e,t,n)=>r(t,e,n),Nk=r=>(e,t)=>{const n=r(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=e.createBuffer(1,2,44100);return n.buffer=o,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},Rk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},kk=(r,e,t,n,o,a,l)=>class extends r{constructor(d,p){const g=o(d),v={...Rk,...p},T=n(g,v),S=a(g),C=S?t():null;super(d,!1,T,C),this._constantSourceNodeRenderer=C,this._nativeConstantSourceNode=T,this._offset=e(this,S,T.offset,Zn,xr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(d){const p=typeof d=="function"?l(this,d):null;this._nativeConstantSourceNode.onended=p;const g=this._nativeConstantSourceNode.onended;this._onended=g!==null&&g===p?d:g}start(d=0){if(this._nativeConstantSourceNode.start(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=d),this.context.state!=="closed"){Fa(this);const p=()=>{this._nativeConstantSourceNode.removeEventListener("ended",p),Vs(this)&&wc(this)};this._nativeConstantSourceNode.addEventListener("ended",p)}}stop(d=0){this._nativeConstantSourceNode.stop(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=d)}},Pk=(r,e,t,n,o)=>()=>{const a=new WeakMap;let l=null,u=null;const d=async(p,g)=>{let v=t(p);const T=zn(v,g);if(!T){const S={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,offset:v.offset.value};v=e(g,S),l!==null&&v.start(l),u!==null&&v.stop(u)}return a.set(g,v),T?await r(g,p.offset,v.offset):await n(g,p.offset,v.offset),await o(p,g,v),v};return{set start(p){l=p},set stop(p){u=p},render(p,g){const v=a.get(g);return v!==void 0?Promise.resolve(v):d(p,g)}}},bk=r=>e=>(r[0]=e,r[0]),Dk={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Vk=(r,e,t,n,o,a)=>class extends r{constructor(u,d){const p=n(u),g={...Dk,...d},v=t(p,g),S=o(p)?e():null;super(u,!1,v,S),this._isBufferNullified=!1,this._nativeConvolverNode=v,g.buffer!==null&&a(this,g.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(u){if(this._nativeConvolverNode.buffer=u,u===null&&this._nativeConvolverNode.buffer!==null){const d=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=d.createBuffer(1,1,d.sampleRate),this._isBufferNullified=!0,a(this,0)}else this._isBufferNullified=!1,a(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(u){this._nativeConvolverNode.normalize=u}},Mk=(r,e,t)=>()=>{const n=new WeakMap,o=async(a,l)=>{let u=e(a);if(!zn(u,l)){const p={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,disableNormalization:!u.normalize};u=r(l,p)}return n.set(l,u),$a(u)?await t(a,l,u.inputs[0]):await t(a,l,u),u};return{render(a,l){const u=n.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Ok=(r,e)=>(t,n,o)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,o)}catch(a){throw a.name==="SyntaxError"?r():a}},Fk=()=>new DOMException("","DataCloneError"),l0=r=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const o=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>o();try{e.postMessage(r,[r])}catch{}finally{o()}})},jk=(r,e,t,n,o,a,l,u,d,p,g)=>(v,T)=>{const S=l(v)?v:a(v);if(o.has(T)){const C=t();return Promise.reject(C)}try{o.add(T)}catch{}return e(d,()=>d(S))?S.decodeAudioData(T).then(C=>(l0(T).catch(()=>{}),e(u,()=>u(C))||g(C),r.add(C),C)):new Promise((C,D)=>{const V=async()=>{try{await l0(T)}catch{}},q=L=>{D(L),V()};try{S.decodeAudioData(T,L=>{typeof L.copyFromChannel!="function"&&(p(L),bm(L)),r.add(L),V().then(()=>C(L))},L=>{q(L===null?n():L)})}catch(L){q(L)}})},Lk=(r,e,t,n,o,a,l,u)=>(d,p)=>{const g=e.get(d);if(g===void 0)throw new Error("Missing the expected cycle count.");const v=a(d.context),T=u(v);if(g===p){if(e.delete(d),!T&&l(d)){const S=n(d),{outputs:C}=t(d);for(const D of C)if(Tc(D)){const V=n(D[0]);r(S,V,D[1],D[2])}else{const V=o(D[0]);S.connect(V,D[1])}}}else e.set(d,g-p)},Bk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},zk=(r,e,t,n,o,a,l)=>class extends r{constructor(d,p){const g=o(d),v={...Bk,...p},T=n(g,v),S=a(g),C=S?t(v.maxDelayTime):null;super(d,!1,T,C),this._delayTime=e(this,S,T.delayTime),l(this,v.maxDelayTime)}get delayTime(){return this._delayTime}},Uk=(r,e,t,n,o)=>a=>{const l=new WeakMap,u=async(d,p)=>{let g=t(d);const v=zn(g,p);if(!v){const T={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,delayTime:g.delayTime.value,maxDelayTime:a};g=e(p,T)}return l.set(p,g),v?await r(p,d.delayTime,g.delayTime):await n(p,d.delayTime,g.delayTime),await o(d,p,g),g};return{render(d,p){const g=l.get(p);return g!==void 0?Promise.resolve(g):u(d,p)}}},$k=r=>(e,t,n,o)=>r(e[o],a=>a[0]===t&&a[1]===n),qk=r=>"delayTime"in r,Wk=(r,e,t)=>function n(o,a){const l=jh(a)?a:t(r,a);if(qk(l))return[];if(o[0]===l)return[o];if(o.includes(l))return[];const{outputs:u}=e(l);return Array.from(u).map(d=>n([...o,l],d[0])).reduce((d,p)=>d.concat(p),[])},Gk={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Hk=(r,e,t,n,o,a,l,u)=>class extends r{constructor(p,g){const v=a(p),T={...Gk,...g},S=n(v,T),C=l(v),D=C?t():null;super(p,!1,S,D),this._attack=e(this,C,S.attack),this._knee=e(this,C,S.knee),this._nativeDynamicsCompressorNode=S,this._ratio=e(this,C,S.ratio),this._release=e(this,C,S.release),this._threshold=e(this,C,S.threshold),u(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(p){const g=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=p,p>2)throw this._nativeDynamicsCompressorNode.channelCount=g,o()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(p){const g=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=p,p==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=g,o()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Kk=(r,e,t,n,o)=>()=>{const a=new WeakMap,l=async(u,d)=>{let p=t(u);const g=zn(p,d);if(!g){const v={attack:p.attack.value,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,knee:p.knee.value,ratio:p.ratio.value,release:p.release.value,threshold:p.threshold.value};p=e(d,v)}return a.set(d,p),g?(await r(d,u.attack,p.attack),await r(d,u.knee,p.knee),await r(d,u.ratio,p.ratio),await r(d,u.release,p.release),await r(d,u.threshold,p.threshold)):(await n(d,u.attack,p.attack),await n(d,u.knee,p.knee),await n(d,u.ratio,p.ratio),await n(d,u.release,p.release),await n(d,u.threshold,p.threshold)),await o(u,d,p),p};return{render(u,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):l(u,d)}}},Qk=()=>new DOMException("","EncodingError"),Xk=r=>e=>new Promise((t,n)=>{if(r===null){n(new SyntaxError);return}const o=r.document.head;if(o===null)n(new SyntaxError);else{const a=r.document.createElement("script"),l=new Blob([e],{type:"application/javascript"}),u=URL.createObjectURL(l),d=r.onerror,p=()=>{r.onerror=d,URL.revokeObjectURL(u)};r.onerror=(g,v,T,S,C)=>{if(v===u||v===r.location.href&&T===1&&S===1)return p(),n(C),!1;if(d!==null)return d(g,v,T,S,C)},a.onerror=()=>{p(),n(new SyntaxError)},a.onload=()=>{p(),t()},a.src=u,a.type="module",o.appendChild(a)}}),Yk=r=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,o){if(n!==null){let a=this._listeners.get(n);a===void 0&&(a=r(this,n),typeof n=="function"&&this._listeners.set(n,a)),this._nativeEventTarget.addEventListener(t,a,o)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,o){const a=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,a===void 0?null:a,o)}},Zk=r=>(e,t,n)=>{Object.defineProperties(r,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return n()}finally{r!==null&&(delete r.currentFrame,delete r.currentTime)}},Jk=r=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw r()},eP={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},tP=(r,e,t,n,o,a)=>class extends r{constructor(u,d){const p=o(u),g={...eP,...d},v=n(p,g),T=a(p),S=T?t():null;super(u,!1,v,S),this._gain=e(this,T,v.gain,Zn,xr)}get gain(){return this._gain}},nP=(r,e,t,n,o)=>()=>{const a=new WeakMap,l=async(u,d)=>{let p=t(u);const g=zn(p,d);if(!g){const v={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:p.gain.value};p=e(d,v)}return a.set(d,p),g?await r(d,u.gain,p.gain):await n(d,u.gain,p.gain),await o(u,d,p),p};return{render(u,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):l(u,d)}}},rP=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},sP=r=>e=>{var t;return(t=r.get(e))!==null&&t!==void 0?t:0},oP=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},er=()=>new DOMException("","InvalidStateError"),iP=r=>e=>{const t=r.get(e);if(t===void 0)throw er();return t},aP=(r,e)=>t=>{let n=r.get(t);if(n!==void 0)return n;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),r.set(t,n),n},lP=r=>e=>{const t=r.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},id=()=>new DOMException("","InvalidAccessError"),cP=r=>{r.getFrequencyResponse=(e=>(t,n,o)=>{if(t.length!==n.length||n.length!==o.length)throw id();return e.call(r,t,n,o)})(r.getFrequencyResponse)},uP={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},hP=(r,e,t,n,o,a)=>class extends r{constructor(u,d){const p=n(u),g=o(p),v={...uP,...d},T=e(p,g?null:u.baseLatency,v),S=g?t(v.feedback,v.feedforward):null;super(u,!1,T,S),cP(T),this._nativeIIRFilterNode=T,a(this,1)}getFrequencyResponse(u,d,p){return this._nativeIIRFilterNode.getFrequencyResponse(u,d,p)}},pT=(r,e,t,n,o,a,l,u,d,p,g)=>{const v=p.length;let T=u;for(let S=0;S<v;S+=1){let C=t[0]*p[S];for(let D=1;D<o;D+=1){const V=T-D&d-1;C+=t[D]*a[V],C-=r[D]*l[V]}for(let D=o;D<n;D+=1)C+=t[D]*a[T-D&d-1];for(let D=o;D<e;D+=1)C-=r[D]*l[T-D&d-1];a[T]=p[S],l[T]=C,T=T+1&d-1,g[S]=C}return T},dP=(r,e,t,n)=>{const o=t instanceof Float64Array?t:new Float64Array(t),a=n instanceof Float64Array?n:new Float64Array(n),l=o.length,u=a.length,d=Math.min(l,u);if(o[0]!==1){for(let C=0;C<l;C+=1)a[C]/=o[0];for(let C=1;C<u;C+=1)o[C]/=o[0]}const p=32,g=new Float32Array(p),v=new Float32Array(p),T=e.createBuffer(r.numberOfChannels,r.length,r.sampleRate),S=r.numberOfChannels;for(let C=0;C<S;C+=1){const D=r.getChannelData(C),V=T.getChannelData(C);g.fill(0),v.fill(0),pT(o,l,a,u,d,g,v,0,p,D,V)}return T},fP=(r,e,t,n,o)=>(a,l)=>{const u=new WeakMap;let d=null;const p=async(g,v)=>{let T=null,S=e(g);const C=zn(S,v);if(v.createIIRFilter===void 0?T=r(v,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):C||(S=v.createIIRFilter(l,a)),u.set(v,T===null?S:T),T!==null){if(d===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const V=new t(g.context.destination.channelCount,g.context.length,v.sampleRate);d=(async()=>{await n(g,V,V.destination);const q=await o(V);return dP(q,v,a,l)})()}const D=await d;return T.buffer=D,T.start(0),T}return await n(g,v,S),S};return{render(g,v){const T=u.get(v);return T!==void 0?Promise.resolve(T):p(g,v)}}},pP=(r,e,t,n,o,a)=>l=>(u,d)=>{const p=r.get(u);if(p===void 0){if(!l&&a(u)){const g=n(u),{outputs:v}=t(u);for(const T of v)if(Tc(T)){const S=n(T[0]);e(g,S,T[1],T[2])}else{const S=o(T[0]);g.disconnect(S,T[1])}}r.set(u,d)}else r.set(u,p+d)},mP=r=>e=>r!==null&&e instanceof r,gP=r=>e=>r!==null&&typeof r.AudioNode=="function"&&e instanceof r.AudioNode,yP=r=>e=>r!==null&&typeof r.AudioParam=="function"&&e instanceof r.AudioParam,vP=(r,e)=>t=>r(t)||e(t),_P=r=>e=>r!==null&&e instanceof r,wP=r=>r!==null&&r.isSecureContext,EP=(r,e,t,n,o,a)=>class extends t{constructor(u,d){super(u),this._nativeContext=u,oT.set(this,u),n(u)&&o.set(u,new Set),this._destination=new r(this,d),this._listener=e(this,u),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(u){const d=typeof u=="function"?a(this,u):null;this._nativeContext.onstatechange=d;const p=this._nativeContext.onstatechange;this._onstatechange=p!==null&&p===d?u:p}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},lc=r=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=r.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},TP=(r,e)=>(t,n,o)=>{const a=new Set;return t.connect=(l=>(u,d=0,p=0)=>{const g=a.size===0;if(e(u))return l.call(t,u,d,p),r(a,[u,d,p],v=>v[0]===u&&v[1]===d&&v[2]===p,!0),g&&n(),u;l.call(t,u,d),r(a,[u,d],v=>v[0]===u&&v[1]===d,!0),g&&n()})(t.connect),t.disconnect=(l=>(u,d,p)=>{const g=a.size>0;if(u===void 0)l.apply(t),a.clear();else if(typeof u=="number"){l.call(t,u);for(const T of a)T[1]===u&&a.delete(T)}else{e(u)?l.call(t,u,d,p):l.call(t,u,d);for(const T of a)T[0]===u&&(d===void 0||T[1]===d)&&(p===void 0||T[2]===p)&&a.delete(T)}const v=a.size===0;g&&v&&o()})(t.disconnect),t},Ct=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t]&&(r[t]=n)},un=(r,e)=>{Ct(r,e,"channelCount"),Ct(r,e,"channelCountMode"),Ct(r,e,"channelInterpretation")},c0=r=>typeof r.getFloatTimeDomainData=="function",IP=r=>{r.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);r.getByteTimeDomainData(t);const n=Math.max(t.length,r.fftSize);for(let o=0;o<n;o+=1)e[o]=(t[o]-128)*.0078125;return e}},SP=(r,e)=>(t,n)=>{const o=t.createAnalyser();if(un(o,n),!(n.maxDecibels>n.minDecibels))throw e();return Ct(o,n,"fftSize"),Ct(o,n,"maxDecibels"),Ct(o,n,"minDecibels"),Ct(o,n,"smoothingTimeConstant"),r(c0,()=>c0(o))||IP(o),o},xP=r=>r===null?null:r.hasOwnProperty("AudioBuffer")?r.AudioBuffer:null,Dt=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t].value&&(r[t].value=n)},CP=r=>{r.start=(e=>{let t=!1;return(n=0,o=0,a)=>{if(t)throw er();e.call(r,n,o,a),t=!0}})(r.start)},Mm=r=>{r.start=(e=>(t=0,n=0,o)=>{if(typeof o=="number"&&o<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(r,t,n,o)})(r.start)},Om=r=>{r.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(r,t)})(r.stop)},AP=(r,e,t,n,o,a,l,u,d,p,g)=>(v,T)=>{const S=v.createBufferSource();return un(S,T),Dt(S,T,"playbackRate"),Ct(S,T,"buffer"),Ct(S,T,"loop"),Ct(S,T,"loopEnd"),Ct(S,T,"loopStart"),e(t,()=>t(v))||CP(S),e(n,()=>n(v))||d(S),e(o,()=>o(v))||p(S,v),e(a,()=>a(v))||Mm(S),e(l,()=>l(v))||g(S,v),e(u,()=>u(v))||Om(S),r(v,S),S},NP=r=>r===null?null:r.hasOwnProperty("AudioContext")?r.AudioContext:r.hasOwnProperty("webkitAudioContext")?r.webkitAudioContext:null,RP=(r,e)=>(t,n,o)=>{const a=t.destination;if(a.channelCount!==n)try{a.channelCount=n}catch{}o&&a.channelCountMode!=="explicit"&&(a.channelCountMode="explicit"),a.maxChannelCount===0&&Object.defineProperty(a,"maxChannelCount",{value:n});const l=r(t,{channelCount:n,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return e(l,"channelCount",u=>()=>u.call(l),u=>d=>{u.call(l,d);try{a.channelCount=d}catch(p){if(d>a.maxChannelCount)throw p}}),e(l,"channelCountMode",u=>()=>u.call(l),u=>d=>{u.call(l,d),a.channelCountMode=d}),e(l,"channelInterpretation",u=>()=>u.call(l),u=>d=>{u.call(l,d),a.channelInterpretation=d}),Object.defineProperty(l,"maxChannelCount",{get:()=>a.maxChannelCount}),l.connect(a),l},kP=r=>r===null?null:r.hasOwnProperty("AudioWorkletNode")?r.AudioWorkletNode:null,PP=(r,e)=>r===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(r*e))))),mT=(r,e)=>{const t=r.createBiquadFilter();return un(t,e),Dt(t,e,"Q"),Dt(t,e,"detune"),Dt(t,e,"frequency"),Dt(t,e,"gain"),Ct(t,e,"type"),t},bP=(r,e)=>(t,n)=>{const o=t.createChannelMerger(n.numberOfInputs);return r!==null&&r.name==="webkitAudioContext"&&e(t,o),un(o,n),o},DP=r=>{const e=r.numberOfOutputs;Object.defineProperty(r,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw er()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw er()}}),Object.defineProperty(r,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw er()}})},Fm=(r,e)=>{const t=r.createChannelSplitter(e.numberOfOutputs);return un(t,e),DP(t),t},VP=(r,e,t,n,o)=>(a,l)=>{if(a.createConstantSource===void 0)return t(a,l);const u=a.createConstantSource();return un(u,l),Dt(u,l,"offset"),e(n,()=>n(a))||Mm(u),e(o,()=>o(a))||Om(u),r(a,u),u},qa=(r,e)=>(r.connect=e.connect.bind(e),r.disconnect=e.disconnect.bind(e),r),MP=(r,e,t,n)=>(o,{offset:a,...l})=>{const u=o.createBuffer(1,2,44100),d=e(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),p=t(o,{...l,gain:a}),g=u.getChannelData(0);g[0]=1,g[1]=1,d.buffer=u,d.loop=!0;const v={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(C){p.channelCount=C},get channelCountMode(){return p.channelCountMode},set channelCountMode(C){p.channelCountMode=C},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(C){p.channelInterpretation=C},get context(){return p.context},get inputs(){return[]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get offset(){return p.gain},get onended(){return d.onended},set onended(C){d.onended=C},addEventListener(...C){return d.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return d.dispatchEvent(C[0])},removeEventListener(...C){return d.removeEventListener(C[0],C[1],C[2])},start(C=0){d.start.call(d,C)},stop(C=0){d.stop.call(d,C)}},T=()=>d.connect(p),S=()=>d.disconnect(p);return r(o,d),n(qa(v,p),T,S)},OP=(r,e)=>(t,n)=>{const o=t.createConvolver();if(un(o,n),n.disableNormalization===o.normalize&&(o.normalize=!n.disableNormalization),Ct(o,n,"buffer"),n.channelCount>2||(e(o,"channelCount",a=>()=>a.call(o),a=>l=>{if(l>2)throw r();return a.call(o,l)}),n.channelCountMode==="max"))throw r();return e(o,"channelCountMode",a=>()=>a.call(o),a=>l=>{if(l==="max")throw r();return a.call(o,l)}),o},gT=(r,e)=>{const t=r.createDelay(e.maxDelayTime);return un(t,e),Dt(t,e,"delayTime"),t},FP=r=>(e,t)=>{const n=e.createDynamicsCompressor();if(un(n,t),t.channelCount>2||t.channelCountMode==="max")throw r();return Dt(n,t,"attack"),Dt(n,t,"knee"),Dt(n,t,"ratio"),Dt(n,t,"release"),Dt(n,t,"threshold"),n},Wr=(r,e)=>{const t=r.createGain();return un(t,e),Dt(t,e,"gain"),t},jP=r=>(e,t,n)=>{if(e.createIIRFilter===void 0)return r(e,t,n);const o=e.createIIRFilter(n.feedforward,n.feedback);return un(o,n),o};function LP(r,e){const t=e[0]*e[0]+e[1]*e[1];return[(r[0]*e[0]+r[1]*e[1])/t,(r[1]*e[0]-r[0]*e[1])/t]}function BP(r,e){return[r[0]*e[0]-r[1]*e[1],r[0]*e[1]+r[1]*e[0]]}function u0(r,e){let t=[0,0];for(let n=r.length-1;n>=0;n-=1)t=BP(t,e),t[0]+=r[n];return t}const zP=(r,e,t,n)=>(o,a,{channelCount:l,channelCountMode:u,channelInterpretation:d,feedback:p,feedforward:g})=>{const v=PP(a,o.sampleRate),T=p instanceof Float64Array?p:new Float64Array(p),S=g instanceof Float64Array?g:new Float64Array(g),C=T.length,D=S.length,V=Math.min(C,D);if(C===0||C>20)throw n();if(T[0]===0)throw e();if(D===0||D>20)throw n();if(S[0]===0)throw e();if(T[0]!==1){for(let I=0;I<D;I+=1)S[I]/=T[0];for(let I=1;I<C;I+=1)T[I]/=T[0]}const q=t(o,v,l,l);q.channelCount=l,q.channelCountMode=u,q.channelInterpretation=d;const L=32,U=[],X=[],O=[];for(let I=0;I<l;I+=1){U.push(0);const N=new Float32Array(L),P=new Float32Array(L);N.fill(0),P.fill(0),X.push(N),O.push(P)}q.onaudioprocess=I=>{const N=I.inputBuffer,P=I.outputBuffer,b=N.numberOfChannels;for(let M=0;M<b;M+=1){const R=N.getChannelData(M),ue=P.getChannelData(M);U[M]=pT(T,C,S,D,V,X[M],O[M],U[M],L,R,ue)}};const B=o.sampleRate/2;return qa({get bufferSize(){return v},get channelCount(){return q.channelCount},set channelCount(I){q.channelCount=I},get channelCountMode(){return q.channelCountMode},set channelCountMode(I){q.channelCountMode=I},get channelInterpretation(){return q.channelInterpretation},set channelInterpretation(I){q.channelInterpretation=I},get context(){return q.context},get inputs(){return[q]},get numberOfInputs(){return q.numberOfInputs},get numberOfOutputs(){return q.numberOfOutputs},addEventListener(...I){return q.addEventListener(I[0],I[1],I[2])},dispatchEvent(...I){return q.dispatchEvent(I[0])},getFrequencyResponse(I,N,P){if(I.length!==N.length||N.length!==P.length)throw r();const b=I.length;for(let M=0;M<b;M+=1){const R=-Math.PI*(I[M]/B),ue=[Math.cos(R),Math.sin(R)],ye=u0(S,ue),pe=u0(T,ue),ce=LP(ye,pe);N[M]=Math.sqrt(ce[0]*ce[0]+ce[1]*ce[1]),P[M]=Math.atan2(ce[1],ce[0])}},removeEventListener(...I){return q.removeEventListener(I[0],I[1],I[2])}},q)},UP=r=>r===null?null:r.hasOwnProperty("OfflineAudioContext")?r.OfflineAudioContext:r.hasOwnProperty("webkitOfflineAudioContext")?r.webkitOfflineAudioContext:null,$P=(r,e,t,n,o,a)=>(l,u)=>{const d=l.createOscillator();return un(d,u),Dt(d,u,"detune"),Dt(d,u,"frequency"),u.periodicWave!==void 0?d.setPeriodicWave(u.periodicWave):Ct(d,u,"type"),e(t,()=>t(l))||Mm(d),e(n,()=>n(l))||a(d,l),e(o,()=>o(l))||Om(d),r(l,d),d},qP=r=>(e,t)=>{const n=e.createPanner();return n.orientationX===void 0?r(e,t):(un(n,t),Dt(n,t,"orientationX"),Dt(n,t,"orientationY"),Dt(n,t,"orientationZ"),Dt(n,t,"positionX"),Dt(n,t,"positionY"),Dt(n,t,"positionZ"),Ct(n,t,"coneInnerAngle"),Ct(n,t,"coneOuterAngle"),Ct(n,t,"coneOuterGain"),Ct(n,t,"distanceModel"),Ct(n,t,"maxDistance"),Ct(n,t,"panningModel"),Ct(n,t,"refDistance"),Ct(n,t,"rolloffFactor"),n)},WP=(r,e,t,n,o,a,l,u,d,p)=>(g,{coneInnerAngle:v,coneOuterAngle:T,coneOuterGain:S,distanceModel:C,maxDistance:D,orientationX:V,orientationY:q,orientationZ:L,panningModel:U,positionX:X,positionY:O,positionZ:B,refDistance:A,rolloffFactor:I,...N})=>{const P=g.createPanner();if(N.channelCount>2||N.channelCountMode==="max")throw l();un(P,N);const b={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},M=t(g,{...b,channelInterpretation:"speakers",numberOfInputs:6}),R=n(g,{...N,gain:1}),ue=n(g,{...b,gain:1}),ye=n(g,{...b,gain:0}),pe=n(g,{...b,gain:0}),ce=n(g,{...b,gain:0}),Z=n(g,{...b,gain:0}),ee=n(g,{...b,gain:0}),K=o(g,256,6,1),j=a(g,{...b,curve:new Float32Array([1,1]),oversample:"none"});let Q=[V,q,L],ve=[X,O,B];const De=new Float32Array(1);K.onaudioprocess=({inputBuffer:fe})=>{const Xe=[d(fe,De,0),d(fe,De,1),d(fe,De,2)];Xe.some((Wt,bn)=>Wt!==Q[bn])&&(P.setOrientation(...Xe),Q=Xe);const dt=[d(fe,De,3),d(fe,De,4),d(fe,De,5)];dt.some((Wt,bn)=>Wt!==ve[bn])&&(P.setPosition(...dt),ve=dt)},Object.defineProperty(ye.gain,"defaultValue",{get:()=>0}),Object.defineProperty(pe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ce.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0});const ge={get bufferSize(){},get channelCount(){return P.channelCount},set channelCount(fe){if(fe>2)throw l();R.channelCount=fe,P.channelCount=fe},get channelCountMode(){return P.channelCountMode},set channelCountMode(fe){if(fe==="max")throw l();R.channelCountMode=fe,P.channelCountMode=fe},get channelInterpretation(){return P.channelInterpretation},set channelInterpretation(fe){R.channelInterpretation=fe,P.channelInterpretation=fe},get coneInnerAngle(){return P.coneInnerAngle},set coneInnerAngle(fe){P.coneInnerAngle=fe},get coneOuterAngle(){return P.coneOuterAngle},set coneOuterAngle(fe){P.coneOuterAngle=fe},get coneOuterGain(){return P.coneOuterGain},set coneOuterGain(fe){if(fe<0||fe>1)throw e();P.coneOuterGain=fe},get context(){return P.context},get distanceModel(){return P.distanceModel},set distanceModel(fe){P.distanceModel=fe},get inputs(){return[R]},get maxDistance(){return P.maxDistance},set maxDistance(fe){if(fe<0)throw new RangeError;P.maxDistance=fe},get numberOfInputs(){return P.numberOfInputs},get numberOfOutputs(){return P.numberOfOutputs},get orientationX(){return ue.gain},get orientationY(){return ye.gain},get orientationZ(){return pe.gain},get panningModel(){return P.panningModel},set panningModel(fe){P.panningModel=fe},get positionX(){return ce.gain},get positionY(){return Z.gain},get positionZ(){return ee.gain},get refDistance(){return P.refDistance},set refDistance(fe){if(fe<0)throw new RangeError;P.refDistance=fe},get rolloffFactor(){return P.rolloffFactor},set rolloffFactor(fe){if(fe<0)throw new RangeError;P.rolloffFactor=fe},addEventListener(...fe){return R.addEventListener(fe[0],fe[1],fe[2])},dispatchEvent(...fe){return R.dispatchEvent(fe[0])},removeEventListener(...fe){return R.removeEventListener(fe[0],fe[1],fe[2])}};v!==ge.coneInnerAngle&&(ge.coneInnerAngle=v),T!==ge.coneOuterAngle&&(ge.coneOuterAngle=T),S!==ge.coneOuterGain&&(ge.coneOuterGain=S),C!==ge.distanceModel&&(ge.distanceModel=C),D!==ge.maxDistance&&(ge.maxDistance=D),V!==ge.orientationX.value&&(ge.orientationX.value=V),q!==ge.orientationY.value&&(ge.orientationY.value=q),L!==ge.orientationZ.value&&(ge.orientationZ.value=L),U!==ge.panningModel&&(ge.panningModel=U),X!==ge.positionX.value&&(ge.positionX.value=X),O!==ge.positionY.value&&(ge.positionY.value=O),B!==ge.positionZ.value&&(ge.positionZ.value=B),A!==ge.refDistance&&(ge.refDistance=A),I!==ge.rolloffFactor&&(ge.rolloffFactor=I),(Q[0]!==1||Q[1]!==0||Q[2]!==0)&&P.setOrientation(...Q),(ve[0]!==0||ve[1]!==0||ve[2]!==0)&&P.setPosition(...ve);const Fe=()=>{R.connect(P),r(R,j,0,0),j.connect(ue).connect(M,0,0),j.connect(ye).connect(M,0,1),j.connect(pe).connect(M,0,2),j.connect(ce).connect(M,0,3),j.connect(Z).connect(M,0,4),j.connect(ee).connect(M,0,5),M.connect(K).connect(g.destination)},Le=()=>{R.disconnect(P),u(R,j,0,0),j.disconnect(ue),ue.disconnect(M),j.disconnect(ye),ye.disconnect(M),j.disconnect(pe),pe.disconnect(M),j.disconnect(ce),ce.disconnect(M),j.disconnect(Z),Z.disconnect(M),j.disconnect(ee),ee.disconnect(M),M.disconnect(K),K.disconnect(g.destination)};return p(qa(ge,P),Fe,Le)},GP=r=>(e,{disableNormalization:t,imag:n,real:o})=>{const a=n instanceof Float32Array?n:new Float32Array(n),l=o instanceof Float32Array?o:new Float32Array(o),u=e.createPeriodicWave(l,a,{disableNormalization:t});if(Array.from(n).length<2)throw r();return u},ad=(r,e,t,n)=>r.createScriptProcessor(e,t,n),HP=(r,e)=>(t,n)=>{const o=n.channelCountMode;if(o==="clamped-max")throw e();if(t.createStereoPanner===void 0)return r(t,n);const a=t.createStereoPanner();return un(a,n),Dt(a,n,"pan"),Object.defineProperty(a,"channelCountMode",{get:()=>o,set:l=>{if(l!==o)throw e()}}),a},KP=(r,e,t,n,o,a)=>{const u=new Float32Array([1,1]),d=Math.PI/2,p={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},g={...p,oversample:"none"},v=(C,D,V,q)=>{const L=new Float32Array(16385),U=new Float32Array(16385);for(let N=0;N<16385;N+=1){const P=N/16384*d;L[N]=Math.cos(P),U[N]=Math.sin(P)}const X=t(C,{...p,gain:0}),O=n(C,{...g,curve:L}),B=n(C,{...g,curve:u}),A=t(C,{...p,gain:0}),I=n(C,{...g,curve:U});return{connectGraph(){D.connect(X),D.connect(B.inputs===void 0?B:B.inputs[0]),D.connect(A),B.connect(V),V.connect(O.inputs===void 0?O:O.inputs[0]),V.connect(I.inputs===void 0?I:I.inputs[0]),O.connect(X.gain),I.connect(A.gain),X.connect(q,0,0),A.connect(q,0,1)},disconnectGraph(){D.disconnect(X),D.disconnect(B.inputs===void 0?B:B.inputs[0]),D.disconnect(A),B.disconnect(V),V.disconnect(O.inputs===void 0?O:O.inputs[0]),V.disconnect(I.inputs===void 0?I:I.inputs[0]),O.disconnect(X.gain),I.disconnect(A.gain),X.disconnect(q,0,0),A.disconnect(q,0,1)}}},T=(C,D,V,q)=>{const L=new Float32Array(16385),U=new Float32Array(16385),X=new Float32Array(16385),O=new Float32Array(16385),B=Math.floor(16385/2);for(let ce=0;ce<16385;ce+=1)if(ce>B){const Z=(ce-B)/(16384-B)*d;L[ce]=Math.cos(Z),U[ce]=Math.sin(Z),X[ce]=0,O[ce]=1}else{const Z=ce/(16384-B)*d;L[ce]=1,U[ce]=0,X[ce]=Math.cos(Z),O[ce]=Math.sin(Z)}const A=e(C,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),I=t(C,{...p,gain:0}),N=n(C,{...g,curve:L}),P=t(C,{...p,gain:0}),b=n(C,{...g,curve:U}),M=n(C,{...g,curve:u}),R=t(C,{...p,gain:0}),ue=n(C,{...g,curve:X}),ye=t(C,{...p,gain:0}),pe=n(C,{...g,curve:O});return{connectGraph(){D.connect(A),D.connect(M.inputs===void 0?M:M.inputs[0]),A.connect(I,0),A.connect(P,0),A.connect(R,1),A.connect(ye,1),M.connect(V),V.connect(N.inputs===void 0?N:N.inputs[0]),V.connect(b.inputs===void 0?b:b.inputs[0]),V.connect(ue.inputs===void 0?ue:ue.inputs[0]),V.connect(pe.inputs===void 0?pe:pe.inputs[0]),N.connect(I.gain),b.connect(P.gain),ue.connect(R.gain),pe.connect(ye.gain),I.connect(q,0,0),R.connect(q,0,0),P.connect(q,0,1),ye.connect(q,0,1)},disconnectGraph(){D.disconnect(A),D.disconnect(M.inputs===void 0?M:M.inputs[0]),A.disconnect(I,0),A.disconnect(P,0),A.disconnect(R,1),A.disconnect(ye,1),M.disconnect(V),V.disconnect(N.inputs===void 0?N:N.inputs[0]),V.disconnect(b.inputs===void 0?b:b.inputs[0]),V.disconnect(ue.inputs===void 0?ue:ue.inputs[0]),V.disconnect(pe.inputs===void 0?pe:pe.inputs[0]),N.disconnect(I.gain),b.disconnect(P.gain),ue.disconnect(R.gain),pe.disconnect(ye.gain),I.disconnect(q,0,0),R.disconnect(q,0,0),P.disconnect(q,0,1),ye.disconnect(q,0,1)}}},S=(C,D,V,q,L)=>{if(D===1)return v(C,V,q,L);if(D===2)return T(C,V,q,L);throw o()};return(C,{channelCount:D,channelCountMode:V,pan:q,...L})=>{if(V==="max")throw o();const U=r(C,{...L,channelCount:1,channelCountMode:V,numberOfInputs:2}),X=t(C,{...L,channelCount:D,channelCountMode:V,gain:1}),O=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:q});let{connectGraph:B,disconnectGraph:A}=S(C,D,X,O,U);Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"maxValue",{get:()=>1}),Object.defineProperty(O.gain,"minValue",{get:()=>-1});const I={get bufferSize(){},get channelCount(){return X.channelCount},set channelCount(M){X.channelCount!==M&&(N&&A(),{connectGraph:B,disconnectGraph:A}=S(C,M,X,O,U),N&&B()),X.channelCount=M},get channelCountMode(){return X.channelCountMode},set channelCountMode(M){if(M==="clamped-max"||M==="max")throw o();X.channelCountMode=M},get channelInterpretation(){return X.channelInterpretation},set channelInterpretation(M){X.channelInterpretation=M},get context(){return X.context},get inputs(){return[X]},get numberOfInputs(){return X.numberOfInputs},get numberOfOutputs(){return X.numberOfOutputs},get pan(){return O.gain},addEventListener(...M){return X.addEventListener(M[0],M[1],M[2])},dispatchEvent(...M){return X.dispatchEvent(M[0])},removeEventListener(...M){return X.removeEventListener(M[0],M[1],M[2])}};let N=!1;const P=()=>{B(),N=!0},b=()=>{A(),N=!1};return a(qa(I,U),P,b)}},QP=(r,e,t,n,o,a,l)=>(u,d)=>{const p=u.createWaveShaper();if(a!==null&&a.name==="webkitAudioContext"&&u.createGain().gain.automationRate===void 0)return t(u,d);un(p,d);const g=d.curve===null||d.curve instanceof Float32Array?d.curve:new Float32Array(d.curve);if(g!==null&&g.length<2)throw e();Ct(p,{curve:g},"curve"),Ct(p,d,"oversample");let v=null,T=!1;return l(p,"curve",D=>()=>D.call(p),D=>V=>(D.call(p,V),T&&(n(V)&&v===null?v=r(u,p):!n(V)&&v!==null&&(v(),v=null)),V)),o(p,()=>{T=!0,n(p.curve)&&(v=r(u,p))},()=>{T=!1,v!==null&&(v(),v=null)})},XP=(r,e,t,n,o)=>(a,{curve:l,oversample:u,...d})=>{const p=a.createWaveShaper(),g=a.createWaveShaper();un(p,d),un(g,d);const v=t(a,{...d,gain:1}),T=t(a,{...d,gain:-1}),S=t(a,{...d,gain:1}),C=t(a,{...d,gain:-1});let D=null,V=!1,q=null;const L={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(O){v.channelCount=O,T.channelCount=O,p.channelCount=O,S.channelCount=O,g.channelCount=O,C.channelCount=O},get channelCountMode(){return p.channelCountMode},set channelCountMode(O){v.channelCountMode=O,T.channelCountMode=O,p.channelCountMode=O,S.channelCountMode=O,g.channelCountMode=O,C.channelCountMode=O},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(O){v.channelInterpretation=O,T.channelInterpretation=O,p.channelInterpretation=O,S.channelInterpretation=O,g.channelInterpretation=O,C.channelInterpretation=O},get context(){return p.context},get curve(){return q},set curve(O){if(O!==null&&O.length<2)throw e();if(O===null)p.curve=O,g.curve=O;else{const B=O.length,A=new Float32Array(B+2-B%2),I=new Float32Array(B+2-B%2);A[0]=O[0],I[0]=-O[B-1];const N=Math.ceil((B+1)/2),P=(B+1)/2-1;for(let b=1;b<N;b+=1){const M=b/N*P,R=Math.floor(M),ue=Math.ceil(M);A[b]=R===ue?O[R]:(1-(M-R))*O[R]+(1-(ue-M))*O[ue],I[b]=R===ue?-O[B-1-R]:-((1-(M-R))*O[B-1-R])-(1-(ue-M))*O[B-1-ue]}A[N]=B%2===1?O[N-1]:(O[N-2]+O[N-1])/2,p.curve=A,g.curve=I}q=O,V&&(n(q)&&D===null?D=r(a,v):D!==null&&(D(),D=null))},get inputs(){return[v]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get oversample(){return p.oversample},set oversample(O){p.oversample=O,g.oversample=O},addEventListener(...O){return v.addEventListener(O[0],O[1],O[2])},dispatchEvent(...O){return v.dispatchEvent(O[0])},removeEventListener(...O){return v.removeEventListener(O[0],O[1],O[2])}};l!==null&&(L.curve=l instanceof Float32Array?l:new Float32Array(l)),u!==L.oversample&&(L.oversample=u);const U=()=>{v.connect(p).connect(S),v.connect(T).connect(g).connect(C).connect(S),V=!0,n(q)&&(D=r(a,v))},X=()=>{v.disconnect(p),p.disconnect(S),v.disconnect(T),T.disconnect(g),g.disconnect(C),C.disconnect(S),V=!1,D!==null&&(D(),D=null)};return o(qa(L,S),U,X)},Nr=()=>new DOMException("","NotSupportedError"),YP={numberOfChannels:1},ZP=(r,e,t,n,o)=>class extends r{constructor(l,u,d){let p;if(typeof l=="number"&&u!==void 0&&d!==void 0)p={length:u,numberOfChannels:l,sampleRate:d};else if(typeof l=="object")p=l;else throw new Error("The given parameters are not valid.");const{length:g,numberOfChannels:v,sampleRate:T}={...YP,...p},S=n(v,g,T);e(lc,()=>lc(S))||S.addEventListener("statechange",(()=>{let C=0;const D=V=>{this._state==="running"&&(C>0?(S.removeEventListener("statechange",D),V.stopImmediatePropagation(),this._waitForThePromiseToSettle(V)):C+=1)};return D})()),super(S,v),this._length=g,this._nativeOfflineAudioContext=S,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,tk(this)}))}_waitForThePromiseToSettle(l){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(l):setTimeout(()=>this._waitForThePromiseToSettle(l))}},JP={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},eb=(r,e,t,n,o,a,l)=>class extends r{constructor(d,p){const g=o(d),v={...JP,...p},T=t(g,v),S=a(g),C=S?n():null,D=d.sampleRate/2;super(d,!1,T,C),this._detune=e(this,S,T.detune,153600,-153600),this._frequency=e(this,S,T.frequency,D,-D),this._nativeOscillatorNode=T,this._onended=null,this._oscillatorNodeRenderer=C,this._oscillatorNodeRenderer!==null&&v.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=v.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(d){const p=typeof d=="function"?l(this,d):null;this._nativeOscillatorNode.onended=p;const g=this._nativeOscillatorNode.onended;this._onended=g!==null&&g===p?d:g}get type(){return this._nativeOscillatorNode.type}set type(d){this._nativeOscillatorNode.type=d,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(d){this._nativeOscillatorNode.setPeriodicWave(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=d)}start(d=0){if(this._nativeOscillatorNode.start(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=d),this.context.state!=="closed"){Fa(this);const p=()=>{this._nativeOscillatorNode.removeEventListener("ended",p),Vs(this)&&wc(this)};this._nativeOscillatorNode.addEventListener("ended",p)}}stop(d=0){this._nativeOscillatorNode.stop(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=d)}},tb=(r,e,t,n,o)=>()=>{const a=new WeakMap;let l=null,u=null,d=null;const p=async(g,v)=>{let T=t(g);const S=zn(T,v);if(!S){const C={channelCount:T.channelCount,channelCountMode:T.channelCountMode,channelInterpretation:T.channelInterpretation,detune:T.detune.value,frequency:T.frequency.value,periodicWave:l===null?void 0:l,type:T.type};T=e(v,C),u!==null&&T.start(u),d!==null&&T.stop(d)}return a.set(v,T),S?(await r(v,g.detune,T.detune),await r(v,g.frequency,T.frequency)):(await n(v,g.detune,T.detune),await n(v,g.frequency,T.frequency)),await o(g,v,T),T};return{set periodicWave(g){l=g},set start(g){u=g},set stop(g){d=g},render(g,v){const T=a.get(v);return T!==void 0?Promise.resolve(T):p(g,v)}}},nb={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},rb=(r,e,t,n,o,a,l)=>class extends r{constructor(d,p){const g=o(d),v={...nb,...p},T=t(g,v),S=a(g),C=S?n():null;super(d,!1,T,C),this._nativePannerNode=T,this._orientationX=e(this,S,T.orientationX,Zn,xr),this._orientationY=e(this,S,T.orientationY,Zn,xr),this._orientationZ=e(this,S,T.orientationZ,Zn,xr),this._positionX=e(this,S,T.positionX,Zn,xr),this._positionY=e(this,S,T.positionY,Zn,xr),this._positionZ=e(this,S,T.positionZ,Zn,xr),l(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(d){this._nativePannerNode.coneInnerAngle=d}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(d){this._nativePannerNode.coneOuterAngle=d}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(d){this._nativePannerNode.coneOuterGain=d}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(d){this._nativePannerNode.distanceModel=d}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(d){this._nativePannerNode.maxDistance=d}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(d){this._nativePannerNode.panningModel=d}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(d){this._nativePannerNode.refDistance=d}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(d){this._nativePannerNode.rolloffFactor=d}},sb=(r,e,t,n,o,a,l,u,d,p)=>()=>{const g=new WeakMap;let v=null;const T=async(S,C)=>{let D=null,V=a(S);const q={channelCount:V.channelCount,channelCountMode:V.channelCountMode,channelInterpretation:V.channelInterpretation},L={...q,coneInnerAngle:V.coneInnerAngle,coneOuterAngle:V.coneOuterAngle,coneOuterGain:V.coneOuterGain,distanceModel:V.distanceModel,maxDistance:V.maxDistance,panningModel:V.panningModel,refDistance:V.refDistance,rolloffFactor:V.rolloffFactor},U=zn(V,C);if("bufferSize"in V)D=n(C,{...q,gain:1});else if(!U){const X={...L,orientationX:V.orientationX.value,orientationY:V.orientationY.value,orientationZ:V.orientationZ.value,positionX:V.positionX.value,positionY:V.positionY.value,positionZ:V.positionZ.value};V=o(C,X)}if(g.set(C,D===null?V:D),D!==null){if(v===null){if(l===null)throw new Error("Missing the native OfflineAudioContext constructor.");const b=new l(6,S.context.length,C.sampleRate),M=e(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});M.connect(b.destination),v=(async()=>{const R=await Promise.all([S.orientationX,S.orientationY,S.orientationZ,S.positionX,S.positionY,S.positionZ].map(async(ue,ye)=>{const pe=t(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ye===0?1:0});return await u(b,ue,pe.offset),pe}));for(let ue=0;ue<6;ue+=1)R[ue].connect(M,0,ue),R[ue].start(0);return p(b)})()}const X=await v,O=n(C,{...q,gain:1});await d(S,C,O);const B=[];for(let b=0;b<X.numberOfChannels;b+=1)B.push(X.getChannelData(b));let A=[B[0][0],B[1][0],B[2][0]],I=[B[3][0],B[4][0],B[5][0]],N=n(C,{...q,gain:1}),P=o(C,{...L,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:I[0],positionY:I[1],positionZ:I[2]});O.connect(N).connect(P.inputs[0]),P.connect(D);for(let b=128;b<X.length;b+=128){const M=[B[0][b],B[1][b],B[2][b]],R=[B[3][b],B[4][b],B[5][b]];if(M.some((ue,ye)=>ue!==A[ye])||R.some((ue,ye)=>ue!==I[ye])){A=M,I=R;const ue=b/C.sampleRate;N.gain.setValueAtTime(0,ue),N=n(C,{...q,gain:0}),P=o(C,{...L,orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:I[0],positionY:I[1],positionZ:I[2]}),N.gain.setValueAtTime(1,ue),O.connect(N).connect(P.inputs[0]),P.connect(D)}}return D}return U?(await r(C,S.orientationX,V.orientationX),await r(C,S.orientationY,V.orientationY),await r(C,S.orientationZ,V.orientationZ),await r(C,S.positionX,V.positionX),await r(C,S.positionY,V.positionY),await r(C,S.positionZ,V.positionZ)):(await u(C,S.orientationX,V.orientationX),await u(C,S.orientationY,V.orientationY),await u(C,S.orientationZ,V.orientationZ),await u(C,S.positionX,V.positionX),await u(C,S.positionY,V.positionY),await u(C,S.positionZ,V.positionZ)),$a(V)?await d(S,C,V.inputs[0]):await d(S,C,V),V};return{render(S,C){const D=g.get(C);return D!==void 0?Promise.resolve(D):T(S,C)}}},ob={disableNormalization:!1},ib=(r,e,t,n)=>class yT{constructor(a,l){const u=e(a),d=n({...ob,...l}),p=r(u,d);return t.add(p),p}static[Symbol.hasInstance](a){return a!==null&&typeof a=="object"&&Object.getPrototypeOf(a)===yT.prototype||t.has(a)}},ab=(r,e)=>(t,n,o)=>(r(n).replay(o),e(n,t,o)),lb=(r,e,t)=>async(n,o,a)=>{const l=r(n);await Promise.all(l.activeInputs.map((u,d)=>Array.from(u).map(async([p,g])=>{const T=await e(p).render(p,o),S=n.context.destination;!t(p)&&(n!==S||!t(n))&&T.connect(a,g,d)})).reduce((u,d)=>[...u,...d],[]))},cb=(r,e,t)=>async(n,o,a)=>{const l=e(n);await Promise.all(Array.from(l.activeInputs).map(async([u,d])=>{const g=await r(u).render(u,o);t(u)||g.connect(a,d)}))},ub=(r,e,t,n)=>o=>r(lc,()=>lc(o))?Promise.resolve(r(n,n)).then(a=>{if(!a){const l=t(o,512,0,1);o.oncomplete=()=>{l.onaudioprocess=null,l.disconnect()},l.onaudioprocess=()=>o.currentTime,l.connect(o.destination)}return o.startRendering()}):new Promise(a=>{const l=e(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});o.oncomplete=u=>{l.disconnect(),a(u.renderedBuffer)},l.connect(o.destination),o.startRendering()}),hb=r=>(e,t)=>r.set(e,t),db=(r,e,t,n,o,a,l,u)=>(d,p)=>t(d).render(d,p).then(()=>Promise.all(Array.from(n(p)).map(g=>t(g).render(g,p)))).then(()=>o(p)).then(g=>(typeof g.copyFromChannel!="function"?(l(g),bm(g)):e(a,()=>a(g))||u(g),r.add(g),g)),fb={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},pb=(r,e,t,n,o,a)=>class extends r{constructor(u,d){const p=o(u),g={...fb,...d},v=t(p,g),T=a(p),S=T?n():null;super(u,!1,v,S),this._pan=e(this,T,v.pan)}get pan(){return this._pan}},mb=(r,e,t,n,o)=>()=>{const a=new WeakMap,l=async(u,d)=>{let p=t(u);const g=zn(p,d);if(!g){const v={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,pan:p.pan.value};p=e(d,v)}return a.set(d,p),g?await r(d,u.pan,p.pan):await n(d,u.pan,p.pan),$a(p)?await o(u,d,p.inputs[0]):await o(u,d,p),p};return{render(u,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):l(u,d)}}},gb=r=>()=>{if(r===null)return!1;try{new r({length:1,sampleRate:44100})}catch{return!1}return!0},yb=(r,e)=>async()=>{if(r===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),o=URL.createObjectURL(t);let a=!1,l=!1;try{await n.audioWorklet.addModule(o);const u=new r(n,"a",{numberOfOutputs:0}),d=n.createOscillator();u.port.onmessage=()=>a=!0,u.onprocessorerror=()=>l=!0,d.connect(u),d.start(0),await n.startRendering(),await new Promise(p=>setTimeout(p))}catch{}finally{URL.revokeObjectURL(o)}return a&&!l},vb=(r,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),n=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(o=>{t.oncomplete=()=>{n.disconnect(),o(t.currentTime!==0)},t.startRendering()})},_b={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},wb=(r,e,t,n,o,a,l)=>class extends r{constructor(d,p){const g=o(d),v={..._b,...p},T=t(g,v),C=a(g)?n():null;super(d,!0,T,C),this._isCurveNullified=!1,this._nativeWaveShaperNode=T,l(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(d){if(d===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(d.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=d}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(d){this._nativeWaveShaperNode.oversample=d}},Eb=(r,e,t)=>()=>{const n=new WeakMap,o=async(a,l)=>{let u=e(a);if(!zn(u,l)){const p={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,curve:u.curve,oversample:u.oversample};u=r(l,p)}return n.set(l,u),$a(u)?await t(a,l,u.inputs[0]):await t(a,l,u),u};return{render(a,l){const u=n.get(l);return u!==void 0?Promise.resolve(u):o(a,l)}}},Tb=()=>typeof window>"u"?null:window,Ib=(r,e)=>t=>{t.copyFromChannel=(n,o,a=0)=>{const l=r(a),u=r(o);if(u>=t.numberOfChannels)throw e();const d=t.length,p=t.getChannelData(u),g=n.length;for(let v=l<0?-l:0;v+l<d&&v<g;v+=1)n[v]=p[v+l]},t.copyToChannel=(n,o,a=0)=>{const l=r(a),u=r(o);if(u>=t.numberOfChannels)throw e();const d=t.length,p=t.getChannelData(u),g=n.length;for(let v=l<0?-l:0;v+l<d&&v<g;v+=1)p[v+l]=n[v]}},Sb=r=>e=>{e.copyFromChannel=(t=>(n,o,a=0)=>{const l=r(a),u=r(o);if(l<e.length)return t.call(e,n,u,l)})(e.copyFromChannel),e.copyToChannel=(t=>(n,o,a=0)=>{const l=r(a),u=r(o);if(l<e.length)return t.call(e,n,u,l)})(e.copyToChannel)},xb=r=>(e,t)=>{const n=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=n),r(e,"buffer",o=>()=>{const a=o.call(e);return a===n?null:a},o=>a=>o.call(e,a===null?n:a))},Cb=(r,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw r()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw r()}});const o=t.createBufferSource();e(n,()=>{const u=n.numberOfInputs;for(let d=0;d<u;d+=1)o.connect(n,0,d)},()=>o.disconnect(n))},vT=(r,e,t)=>r.copyFromChannel===void 0?r.getChannelData(t)[0]:(r.copyFromChannel(e,t),e[0]),_T=r=>{if(r===null)return!1;const e=r.length;return e%2!==0?r[Math.floor(e/2)]!==0:r[e/2-1]+r[e/2]!==0},Ic=(r,e,t,n)=>{let o=r;for(;!o.hasOwnProperty(e);)o=Object.getPrototypeOf(o);const{get:a,set:l}=Object.getOwnPropertyDescriptor(o,e);Object.defineProperty(r,e,{get:t(a),set:n(l)})},Ab=r=>({...r,channelCount:r.numberOfOutputs}),Nb=r=>{const{imag:e,real:t}=r;return e===void 0?t===void 0?{...r,imag:[0,0],real:[0,0]}:{...r,imag:Array.from(t,()=>0),real:t}:t===void 0?{...r,imag:e,real:Array.from(e,()=>0)}:{...r,imag:e,real:t}},wT=(r,e,t)=>{try{r.setValueAtTime(e,t)}catch(n){if(n.code!==9)throw n;wT(r,e,t+1e-7)}},Rb=r=>{const e=r.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},kb=r=>{const e=r.createBufferSource(),t=r.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},Pb=r=>{const e=r.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},jm=r=>{const e=r.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ET=r=>{const e=r.createBuffer(1,1,44100),t=r.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Lm=r=>{const e=r.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},bb=r=>{r.start=(e=>(t=0,n=0,o)=>{const a=r.buffer,l=a===null?n:Math.min(a.duration,n);a!==null&&l>a.duration-.5/r.context.sampleRate?e.call(r,t,0,0):e.call(r,t,l,o)})(r.start)},TT=(r,e)=>{const t=e.createGain();r.connect(t);const n=(o=>()=>{o.call(r,t),r.removeEventListener("ended",n)})(r.disconnect);r.addEventListener("ended",n),qa(r,t),r.stop=(o=>{let a=!1;return(l=0)=>{if(a)try{o.call(r,l)}catch{t.gain.setValueAtTime(0,l)}else o.call(r,l),a=!0}})(r.stop)},Sc=(r,e)=>t=>{const n={value:r};return Object.defineProperties(t,{currentTarget:n,target:n}),typeof e=="function"?e.call(r,t):e.handleEvent.call(r,t)},Db=D2(Si),Vb=L2(Si),Mb=$k(od),IT=new WeakMap,Ob=sP(IT),Gr=wk(new Map,new WeakMap),hs=Tb(),ST=SP(Gr,Ii),Bm=rP(cr),kn=lb(cr,Bm,_i),Fb=$2(ST,kt,kn),Bt=iP(oT),bo=UP(hs),Vt=_P(bo),xT=new WeakMap,CT=Yk(Sc),ld=NP(hs),AT=mP(ld),NT=gP(hs),jb=yP(hs),$p=kP(hs),Pn=fk(V2(tT),j2(Db,Vb,Lh,Mb,Bh,cr,Ob,_c,kt,Si,Vs,_i,oh),Gr,pP(Bp,Bh,cr,kt,ac,Vs),Ii,id,Nr,Lk(Lh,Bp,cr,kt,ac,Bt,Vs,Vt),Wk(xT,cr,Po),CT,Bt,AT,NT,jb,Vt,$p),Lb=U2(Pn,Fb,Ii,ST,Bt,Vt),zm=new WeakSet,h0=xP(hs),RT=bk(new Uint32Array(1)),Um=Ib(RT,Ii),$m=Sb(RT),Bb=W2(zm,Gr,Nr,h0,bo,gb(h0),Um,$m),cd=B2(Wr),kT=cb(Bm,Ec,_i),Ls=Ak(kT),xc=AP(cd,Gr,Rb,kb,Pb,jm,ET,Lm,bb,xb(Ic),TT),Bs=ab(oP(Ec),kT),zb=K2(Ls,xc,kt,Bs,kn),fs=pk(M2(rT),xT,sT,mk,A2,N2,R2,k2,P2,Fp,JE,ld,wT),Ub=H2(Pn,zb,fs,er,xc,Bt,Vt,Sc),$b=nk(Pn,rk,Ii,er,RP(Wr,Ic),Bt,Vt,kn),qb=_k(Ls,mT,kt,Bs,kn),xi=hb(IT),Wb=vk(Pn,fs,qb,id,mT,Bt,Vt,xi),Wa=TP(Si,NT),Gb=Cb(er,Wa),Ga=bP(ld,Gb),Hb=Ik(Ga,kt,kn),Kb=Tk(Pn,Hb,Ga,Bt,Vt),Qb=Ck(Fm,kt,kn),Xb=xk(Pn,Qb,Fm,Bt,Vt,Ab),Yb=MP(cd,xc,Wr,Wa),ud=VP(cd,Gr,Yb,jm,Lm),Zb=Pk(Ls,ud,kt,Bs,kn),Jb=kk(Pn,fs,Zb,ud,Bt,Vt,Sc),PT=OP(Nr,Ic),eD=Mk(PT,kt,kn),tD=Vk(Pn,eD,PT,Bt,Vt,xi),nD=Uk(Ls,gT,kt,Bs,kn),rD=zk(Pn,fs,nD,gT,Bt,Vt,xi),bT=FP(Nr),sD=Kk(Ls,bT,kt,Bs,kn),oD=Hk(Pn,fs,sD,bT,Nr,Bt,Vt,xi),iD=nP(Ls,Wr,kt,Bs,kn),aD=tP(Pn,fs,iD,Wr,Bt,Vt),lD=zP(id,er,ad,Nr),qm=ub(Gr,Wr,ad,vb(Wr,bo)),cD=fP(xc,kt,bo,kn,qm),uD=jP(lD),hD=hP(Pn,uD,cD,Bt,Vt,xi),dD=sk(fs,Ga,ud,ad,Nr,vT,Vt,Ic),DT=new WeakMap,fD=EP($b,dD,CT,Vt,DT,Sc),VT=$P(cd,Gr,jm,ET,Lm,TT),pD=tb(Ls,VT,kt,Bs,kn),mD=eb(Pn,fs,VT,pD,Bt,Vt,Sc),MT=Nk(xc),gD=XP(MT,er,Wr,_T,Wa),hd=QP(MT,er,gD,_T,Wa,ld,Ic),yD=WP(Lh,er,Ga,Wr,ad,hd,Nr,Bh,vT,Wa),OT=qP(yD),vD=sb(Ls,Ga,ud,Wr,OT,kt,bo,Bs,kn,qm),_D=rb(Pn,fs,OT,vD,Bt,Vt,xi),wD=GP(Ii),ED=ib(wD,Bt,new WeakSet,Nb),TD=KP(Ga,Fm,Wr,hd,Nr,Wa),FT=HP(TD,Nr),ID=mb(Ls,FT,kt,Bs,kn),SD=pb(Pn,fs,FT,ID,Bt,Vt),xD=Eb(hd,kt,kn),CD=wb(Pn,er,hd,xD,Bt,Vt,xi),AD=wP(hs),ND=Zk(hs),RD=new WeakMap,kD=aP(RD,bo),PD=AD?F2(Gr,Nr,Xk(hs),ND,Jk(b2),Bt,kD,Vt,$p,new WeakMap,new WeakMap,yb($p,bo),hs):void 0,bD=vP(AT,Vt),DD=jk(zm,Gr,Fk,Qk,new WeakSet,Bt,bD,Fh,lc,Um,$m),VD=gk(PD,Lb,Bb,Ub,Wb,Kb,Xb,Jb,tD,DD,rD,oD,aD,hD,fD,mD,_D,ED,SD,CD),MD=lP(DT),OD=Ok(Nr,bo),FD=db(zm,Gr,Bm,MD,qm,Fh,Um,$m),jD=ZP(VD,Gr,er,OD,FD),d0=(r,e,t)=>{const n=new jD(r.numberOfChannels,Math.round(t*r.sampleRate),r.sampleRate),o=n.createBiquadFilter(),a=n.createBufferSource();return o.frequency.value=240,o.type="lowpass",a.buffer=r,a.connect(o).connect(n.destination),a.start(0,e,t),n.startRendering().then(l=>{const u=l.getChannelData(0),d=l.sampleRate;return{channelData:u,sampleRate:d}})},LD=I2({analyze:({call:r})=>async(...e)=>{var t;const[n,o,a]=e,l=typeof o=="number"?o:0,u=typeof a=="number"?a:n.duration-l,{channelData:d,sampleRate:p}=await d0(n,l,u),g=typeof o=="object"?o:typeof a=="object"?a:(t=e[3])!==null&&t!==void 0?t:null;return r("analyze",{channelData:d,sampleRate:p,...g===null?g:{tempoSettings:g}},[d.buffer])},guess:({call:r})=>async(...e)=>{var t;const[n,o,a]=e,l=typeof o=="number"?o:0,u=typeof a=="number"?a:n.duration-l,{channelData:d,sampleRate:p}=await d0(n,l,u),g=typeof o=="object"?o:typeof a=="object"?a:(t=e[3])!==null&&t!==void 0?t:null;return r("guess",{channelData:d,sampleRate:p,...g===null?g:{tempoSettings:g}},[d.buffer])}}),BD=r=>{const e=new Worker(r);return LD(e)},zD=(r,e)=>{let t=null;return()=>{if(t!==null)return t;const n=new Blob([e],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(n);return t=r(o),setTimeout(()=>URL.revokeObjectURL(o)),t}},UD=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),u=a(c,i),l=t(u);e.addUniqueNumber=l,e.generateUniqueNumber=u}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:c}})=>{const u=r[i];try{if(void 0===u)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===c?u():u(c);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const c=new Map,u=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(c);return c.set(o,(()=>{n(),t.close(),c.delete(o)})),{result:o}},disconnect:({portId:e})=>{const r=c.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise((e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])}))){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=u(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},h=(e,t,r)=>{const n=e.length,o=[];let s=!1;for(let a=0;a<n;a+=1)e[a]>t?s=!0:s&&(s=!1,o.push(a-1),a+=r/4-1);return s&&o.push(n-1),o},d=(e,t,r)=>{const n=(e=>{let t=0;const r=e.length;for(let n=0;n<r;n+=1)e[n]>t&&(t=e[n]);return t})(e),o=.3*n;let s=[],a=n-.05*n;if(n>.25)for(;s.length<30&&a>=o;)s=h(e,a,t),a-=.05*n;const i=(e=>{const t=[];return e.forEach(((r,n)=>{const o=Math.min(e.length-n,10);for(let s=1;s<o;s+=1){const o=e[n+s]-r;t.some((e=>e.interval===o&&(e.peaks.push(r),!0)))||t.push({interval:o,peaks:[r]})}})),t})(s),c=((e,t,r={})=>{var n,o;const s=Math.max(0,null!==(n=r.maxTempo)&&void 0!==n?n:180),a=Math.max(0,null!==(o=r.minTempo)&&void 0!==o?o:90),i=[];return e.forEach((e=>{let r=60/(e.interval/t);for(;r<a;)r*=2;for(;r>s;)r/=2;if(r<a)return;let n=!1,o=e.peaks.length;i.forEach((t=>{if(t.tempo===r&&(t.score+=e.peaks.length,t.peaks=[...t.peaks,...e.peaks],n=!0),t.tempo>r-.5&&t.tempo<r+.5){const n=2*Math.abs(t.tempo-r);o+=(1-n)*t.peaks.length,t.score+=(1-n)*e.peaks.length}})),n||i.push({peaks:e.peaks,score:o,tempo:r})})),i})(i,t,r);return c.sort(((e,t)=>t.score-e.score)),c},p=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");return n[0].tempo},f=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");const{peaks:o,tempo:s}=n[0],a=Math.round(s),i=60/a;o.sort(((e,t)=>e-t));let c=o[0]/t;for(;c>i;)c-=i;return{bpm:a,offset:c,tempo:s}};l(self,{analyze:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:p(e,t,r)}),guess:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:f(e,t,r)})})})()})();`,$D=zD(BD,UD),jT=(...r)=>$D().analyze(...r),qD=[{id:"track1",title:"That's Cool",artist:"Fox & Hayes",bpm:120,genre:"Rap/House",streamUrl:"/music/FOX_HAYES_THAT'S COOL.mp3",coverArt:"/assets/FOX_HAYES_THAT'S COOL.jpg .jpg"},{id:"track2",title:"Bounce",artist:"Fox & Hayes",bpm:120,genre:"Rap/House",streamUrl:"/music/FOX_HAYES _BOUNCE.mp3",coverArt:"/assets/FOX_HAYES_BOUNCE.jpg"},{id:"track3",title:"Blueberry Merlot",artist:"Fox & Hayes",bpm:70,genre:"Hip-Hop",streamUrl:"/music/FOX_HAYES_ BLUEBERRY_MERLOT.mp3",coverArt:"/assets/FOX_HAYES_BLUEBERRY_MERLOT.jpg"},{id:"track4",title:"Raindrops",artist:"Fox & Hayes",bpm:90,genre:"Hip-Hop",streamUrl:"/music/FOX_HAYES_RAINDROPS.mp3",coverArt:"/assets/FOX _HAYES_RAINDROPS.jpg"}],WD={tracks:qD},GD=({onTrackSelect:r,onClose:e})=>{const[t,n]=ne.useState(WD.tracks),[o,a]=ne.useState(null),[l,u]=ne.useState({}),[d,p]=ne.useState(null),[g,v]=ne.useState(null),[T,S]=ne.useState({}),C=ne.useRef(new Audio);ne.useEffect(()=>()=>{C.current&&(C.current.pause(),C.current.src="")},[]);const D=L=>{if(C.current&&C.current.pause(),d===L){p(null);return}const U=t.find(X=>X.id===L);p(L),C.current.src=U.streamUrl,C.current.play()},V=async(L,U)=>{L.stopPropagation();const X=t.find(O=>O.id===U);if(X){v(U);try{const B=await(await fetch(X.streamUrl)).arrayBuffer(),A=new(window.AudioContext||window.webkitAudioContext),I=await A.decodeAudioData(B),N=await jT(I);let P=N;N>140&&(P=N/2);const b=Math.round(P);console.log(`Detected BPM for ${X.title}: ${b}`);const M=t.map(R=>R.id===U?{...R,bpm:b}:R);n(M),S(R=>({...R,[U]:b})),A.close()}catch(O){console.error(`Error detecting BPM for track ${U}:`,O)}finally{v(null)}}},q=async L=>{a(L.id),u({...l,[L.id]:0});try{const U=setInterval(()=>{u(I=>{const N=I[L.id]||0;return N<95?{...I,[L.id]:N+5}:I})},100),O=await(await fetch(L.streamUrl)).blob(),B=URL.createObjectURL(O);clearInterval(U),u({...l,[L.id]:100}),d===L.id&&(C.current.pause(),p(null));const A=T[L.id]||L.bpm||120;r({...L,streamUrl:B,bpm:A}),setTimeout(()=>e(),500)}catch(U){console.error("Error loading track:",U),u({...l,[L.id]:-1}),a(null)}};return w.jsxs("div",{className:"my-music-modal",style:{position:"fixed",top:"-340px",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e4,width:"calc(100% - 10px)",maxWidth:"800px",maxHeight:"80vh",backgroundColor:"#121212",borderRadius:"10px",boxShadow:"0 4px 20px rgba(0,0,0,0.4)",padding:"20px",overflowY:"auto",color:"#ffffff"},children:[w.jsxs("div",{className:"modal-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[w.jsx("h2",{style:{margin:0},children:"Current Track List"}),w.jsx("button",{onClick:()=>{C.current&&(C.current.pause(),C.current.src=""),p(null),e()},style:{backgroundColor:"rgba(255,255,255,0.1)",color:"white",border:"none",borderRadius:"50%",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:w.jsx(ur,{size:20})})]}),w.jsx("div",{className:"tracks-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px",paddingBottom:"10px"},children:t.map(L=>w.jsxs("div",{className:"track-card",style:{border:"2px solid rgba(72, 9, 111, 0.87)",borderRadius:"8px",padding:"8px",backgroundColor:"#1e1e1e",boxShadow:"0 4px 6px rgba(0,0,0,0.2)",transition:"transform 0.2s, box-shadow 0.2s"},children:[w.jsxs("div",{className:"track-artwork",style:{position:"relative",width:"100%",aspectRatio:"1/1",marginBottom:"8px",overflow:"hidden",borderRadius:"6px"},children:[w.jsx("img",{src:L.coverArt,alt:L.title,style:{width:"100%",height:"100%",objectFit:"cover"}}),w.jsxs("div",{style:{position:"absolute",bottom:"8px",right:"8px",display:"flex",gap:"6px"},children:[w.jsx("button",{className:"bpm-detect-button",onClick:U=>V(U,L.id),disabled:g===L.id,style:{width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"rgba(0,0,0,0.6)",border:"2px solid white",color:"white",display:"none",alignItems:"center",justifyContent:"center",cursor:g===L.id?"wait":"pointer"},children:g===L.id?w.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",border:"2px solid transparent",borderTopColor:"white",animation:"spin 1s linear infinite"}}):w.jsx(r1,{size:18})}),w.jsx("button",{className:"preview-button",onClick:U=>{U.stopPropagation(),D(L.id)},style:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"rgba(0,0,0,0.6)",border:"2px solid white",color:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:d===L.id?w.jsx(Hp,{size:18}):w.jsx(Kp,{size:18})})]})]}),w.jsxs("div",{className:"track-details",style:{marginBottom:"8px"},children:[w.jsx("h3",{style:{margin:"0 0 4px 0",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:L.title}),w.jsxs("p",{style:{margin:"0 0 4px 0",color:"#aaa",fontSize:"12px"},children:["By ",L.artist]}),w.jsxs("div",{style:{display:"flex",gap:"6px",marginBottom:"4px"},children:[w.jsxs("span",{style:{display:"inline-block",backgroundColor:T[L.id]?"#ff8800":"#6c0d9c",padding:"2px 6px",borderRadius:"12px",fontSize:"10px",color:"white"},children:[T[L.id]||L.bpm||120," BPM",T[L.id]&&" (Detected)"]}),w.jsx("span",{style:{display:"inline-block",backgroundColor:"#2c8dc4",padding:"2px 6px",borderRadius:"12px",fontSize:"10px",color:"white"},children:L.genre})]})]}),w.jsx("div",{className:"track-actions",children:l[L.id]>0?w.jsxs("div",{className:"download-progress",style:{width:"100%",height:"25px",backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"4px",position:"relative",overflow:"hidden"},children:[w.jsx("div",{className:"progress-bar",style:{height:"100%",width:`${l[L.id]}%`,backgroundColor:"#6c0d9c",transition:"width 0.2s"}}),w.jsxs("span",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px"},children:[l[L.id],"%"]})]}):w.jsxs("button",{className:"add-track-button",onClick:()=>q(L),disabled:o===L.id,style:{width:"100%",padding:"6px 10px",backgroundColor:o===L.id?"#4a0b69":"#6c0d9c",color:"white",border:"none",borderRadius:"4px",cursor:o===L.id?"default":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontSize:"12px"},children:[o===L.id?w.jsx(v0,{size:14}):w.jsx(Gp,{size:14}),o===L.id?"Added":"Add to Project"]})})]},L.id))}),w.jsx("div",{className:"modal-footer",style:{padding:"15px",textAlign:"center",opacity:"0.7",fontSize:"0.9rem",marginTop:"20px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:w.jsx("p",{style:{margin:0},children:"Original music by Your Name/Studio"})}),w.jsx("style",{children:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `})]})},f0={enableAudiusStreaming:!1},yn=new $I({log:!0}),p0=async()=>{try{return console.log("Starting FFmpeg load..."),await yn.load({corePath:"/ffmpeg/ffmpeg-core.js",wasmPath:"/ffmpeg/ffmpeg-core.wasm"}),console.log("FFmpeg loaded successfully"),yn}catch(r){throw console.error("FFmpeg load error:",r),r instanceof Error&&console.error({message:r.message,name:r.name,stack:r.stack,cause:r.cause}),alert("Failed to load FFmpeg. Please check your internet connection."),r}},HD=({onCreateSlideshow:r,onLoadSession:e,onClose:t})=>{const[n,o]=ne.useState(!0),[a,l]=ne.useState(!1);return w.jsx("div",{className:"landing-wrapper",children:w.jsxs("div",{className:"landing-container",children:[w.jsxs("div",{className:"landing-header",children:[w.jsx("button",{className:"info-button",onClick:()=>l(!0),children:w.jsx("span",{style:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"left"},children:w.jsx(X1,{})})}),w.jsx("h1",{className:"app-title",children:"Groove Slider v1.0.5"}),w.jsx("button",{className:"close-landing-button",onClick:t,children:w.jsx(ur,{size:24})})]}),w.jsxs("div",{className:"retro-background",children:[w.jsx("div",{className:"wave-pattern top"}),w.jsx("div",{className:"wave-pattern bottom"}),w.jsxs("div",{className:"project-management",children:[w.jsx("button",{className:"create-button",onClick:r,children:"Create Slideshow"}),w.jsx("button",{className:"sessions-toggle-button",onClick:()=>o(!n),children:n?"Hide Saved Projects":"Show Saved Projects"}),n&&w.jsx("div",{className:"landing-sessions-container",children:w.jsx(d2,{visible:!0,onLoadSession:e})})]})]}),w.jsx("div",{className:"featured-section",children:w.jsxs("button",{className:"use-style-button",children:[w.jsx(ih,{size:18}),w.jsx("span",{children:"Follow Us "})]})}),a&&w.jsx(JD,{isOpen:a,onClose:()=>l(!1)})]})})},KD=({onUpload:r,onBPMChange:e,currentBPM:t,onStartPointChange:n,audioRef:o,musicUrl:a,musicStartPoint:l,onClose:u})=>{const[d,p]=ne.useState(0),[g,v]=ne.useState(!1),[T,S]=ne.useState(!1),[C,D]=ne.useState(1),[V,q]=ne.useState(0),L=ne.useRef(null),[U,X]=ne.useState(""),[O,B]=ne.useState(!1),[A,I]=ne.useState(null),N=ne.useRef(null),[P,b]=ne.useState(""),[M,R]=ne.useState(!1),ue=ne.useRef(null);ne.useRef(null),ne.useEffect(()=>{if(!A){const Z=new(window.AudioContext||window.webkitAudioContext);I(Z)}return()=>{A&&A.close()}},[]);const ye=async Z=>{try{if(console.log("Starting BPM detection process for:",Z),Z.includes("lingering-surf-27dd.benhayze.workers.dev"))return console.log("Streaming track detected, using pre-defined BPM"),bpm;const K=await a2(Z);if(K!==null)return console.log(`Using cached BPM: ${K}`),K;console.log("No cached BPM found, analyzing audio..."),B(!0);const j=new(window.AudioContext||window.webkitAudioContext);let Q;try{Q=await(await fetch(Z)).arrayBuffer()}catch(Le){return console.error("Failed to fetch audio for BPM detection:",Le),120}console.log("Audio data fetched, decoding...");let ve;try{ve=await j.decodeAudioData(Q)}catch(Le){return console.error("Failed to decode audio for BPM detection:",Le),120}console.log("Audio decoded, analyzing tempo...");const De=await jT(ve);console.log(`Raw detected tempo: ${De}`);let ge=De;De>140&&(ge=De/2);const Fe=Math.round(ge);return console.log(`Final detected BPM: ${Fe}`),await i2(Z,Fe),console.log(`BPM value ${Fe} cached for future use`),Fe}catch(ee){return console.error("BPM detection failed:",ee),120}finally{B(!1)}},pe=()=>{if(!L.current)return;const Z=L.current.currentTime;if(p(Z),T&&ue.current!==null){const ee=Math.abs(Z-ue.current);ee>.1&&Z<ue.current+.5?(console.log(`Detected drift of ${ee.toFixed(6)}s - correcting smoothly`),o.current&&(o.current.dataset.pendingCorrection=ue.current)):Z>ue.current+.5&&(ue.current=null)}};ne.useEffect(()=>{if(L.current&&o.current){L.current.addEventListener("timeupdate",pe);let Z=0;const ee=()=>{const K=L.current.currentTime;(Date.now()-Z>500||Math.abs(o.current.currentTime-K)>.5)&&o.current.paused&&L.current.paused&&(o.current.currentTime=K,Z=Date.now())};return L.current.addEventListener("seeked",ee),L.current.addEventListener("pause",ee),L.current.addEventListener("seeking",()=>{N.current&&clearInterval(N.current),N.current=setInterval(()=>{pe()},10)}),L.current.addEventListener("seeked",()=>{N.current&&(clearInterval(N.current),N.current=null)}),L.current.addEventListener("loadedmetadata",()=>{q(L.current.duration)}),()=>{L.current&&(L.current.removeEventListener("timeupdate",pe),L.current.removeEventListener("seeked",ee),L.current.removeEventListener("pause",ee),L.current.removeEventListener("seeking",()=>{}),L.current.removeEventListener("seeked",()=>{})),N.current&&clearInterval(N.current)}}},[o,L,T]);const ce=()=>{if(T){if(console.log("Stopping playback"),intervalRef.current&&(clearInterval(intervalRef.current),intervalRef.current=null),o.current)try{if(window.AudioContext||window.webkitAudioContext){const K=new(window.AudioContext||window.webkitAudioContext),j=K.createMediaElementSource(o.current),Q=K.createGain();j.connect(Q),Q.connect(K.destination);const ve=K.currentTime;Q.gain.setValueAtTime(1,ve),Q.gain.linearRampToValueAtTime(0,ve+.03),setTimeout(()=>{o.current.pause(),j.disconnect(),Q.disconnect()},35)}else o.current.pause()}catch(K){console.error("Error pausing audio:",K),o.current.pause()}S(!1);return}if(currentIndex===stories.length-1&&setCurrentIndex(0),a)try{if(!o.current||o.current.src!==a){const K=new Audio;K.preload="auto",K.src=a,K.currentTime=l,o.current=K,B(!0),ensureAudioBuffering(K).then(()=>{console.log("Audio sufficiently buffered, starting playback"),B(!1),Z(K)}).catch(j=>{console.warn("Audio buffer warning:",j),B(!1),setTimeout(()=>{Z(K)},100)})}else o.current.currentTime=l,B(!0),ensureAudioBuffering(o.current).then(()=>{B(!1),Z(o.current)}).catch(()=>{B(!1),Z(o.current)})}catch(K){console.error("Error setting up audio:",K),B(!1),ee()}else console.log("No music URL, running slideshow without audio"),ee();function Z(K){const j=V*1e3;console.log(`Setting up interval with duration: ${j}ms`),intervalRef.current&&clearInterval(intervalRef.current),intervalRef.current=setInterval(()=>{setCurrentIndex(Q=>!isLoopingEnabled&&Q>=stories.length-1?(intervalRef.current&&(clearInterval(intervalRef.current),intervalRef.current=null),o.current&&o.current.pause(),S(!1),Q):(Q+1)%stories.length)},j),setTimeout(()=>{K.play().catch(Q=>{console.error("Audio playback failed:",Q),console.log("Continuing with slideshow without audio")}),S(!0)},50)}function ee(){const K=V*1e3;console.log(`Setting up interval with duration: ${K}ms`),intervalRef.current&&clearInterval(intervalRef.current),intervalRef.current=setInterval(()=>{setCurrentIndex(j=>!isLoopingEnabled&&j>=stories.length-1?(intervalRef.current&&(clearInterval(intervalRef.current),intervalRef.current=null),S(!1),j):(j+1)%stories.length)},K),S(!0)}};return w.jsxs("div",{className:"music-panel",children:[u&&w.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:1e4},children:w.jsx("button",{onClick:u,style:{background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:w.jsx(ur,{size:24})})}),w.jsxs("div",{className:"music-controls",children:[w.jsxs("div",{className:"bpm-control",children:[O&&w.jsxs("div",{className:"bpm-analyzer",children:[w.jsx(V1,{className:"spinner",size:18}),w.jsx("span",{children:"Analyzing beat..."})]}),w.jsxs("div",{className:"manual-bpm",children:[w.jsxs("label",{children:[w.jsx("span",{children:"AUTO-BPM"}),w.jsx("span",{children:"DETECTION:"})]}),w.jsx("input",{type:"number",min:"60",max:"180",value:t,onChange:Z=>e(parseInt(Z.target.value)),className:"bpm-input"})]}),w.jsxs("label",{className:"upload-button",children:[w.jsx(ih,{className:"icon"}),w.jsx("span",{children:"Upload Music"}),w.jsx("input",{type:"file",accept:".mp3,.aac,.m4a,.wav,.aiff",onChange:async Z=>{const ee=Z.target.files[0];if(ee){const K=URL.createObjectURL(ee);X(ee.name),B(!0);try{const j=await ye(K);console.log(`Final detected BPM: ${j}`),e(j)}catch(j){console.error("BPM detection failed:",j),e(120)}finally{B(!1)}r(K),n(0),L.current&&(L.current.src=K,L.current.currentTime=0)}},className:"hidden-input"})]}),w.jsxs("button",{onClick:()=>R(!0),style:{background:"#6c0d9c",color:"white",border:"solid 2px #fbf8cd",padding:"10px",borderRadius:"5px",display:"flex",alignItems:"center",textAlign:"left",gap:"10px",marginTop:"40px"},children:[w.jsx(ih,{size:24}),"Add Music"]}),f0.enableAudiusStreaming,M&&w.jsx(GD,{onTrackSelect:Z=>{try{r(Z.streamUrl),e(Z.bpm||120),n(0),L.current&&(L.current.src=Z.streamUrl,L.current.currentTime=0),R(!1)}catch(ee){console.error("Error selecting track:",ee),alert("Unable to load this track. Please try another one.")}},onClose:()=>R(!1)}),g&&f0.enableAudiusStreaming]}),w.jsxs("div",{className:"music-player",children:[w.jsx("audio",{ref:L,src:a,onTimeUpdate:pe,preload:"auto"}),a&&w.jsx("div",{className:"music-info",children:w.jsx("span",{children:U&&U.length>35?`${U.slice(0,35)}...`:a&&a.includes("https://lingering-surf-27dd.benhayze.workers.dev/")?`${P||"Audius Track"}`:U||"Track Title"})}),w.jsx("button",{className:"audio-control-button",onClick:ce,children:T?w.jsx(Hp,{size:32}):w.jsx(Kp,{size:32})}),a&&w.jsx(p2,{audioUrl:a,audioRef:o,onStartPointChange:Z=>{const ee=Math.round(Z*1e3)/1e3;ue.current=ee,n(ee),L.current&&(L.current.currentTime=ee)},musicStartPoint:l})]})]})]})},QD=({currentIndex:r,totalSlides:e,onProgressClick:t})=>(console.log("Rendering ProgressBar",{currentIndex:r,totalSlides:e,bars:[...Array(e)].map((n,o)=>({index:o,isActive:o===r}))}),w.jsx("div",{className:"progress-container",children:[...Array(e)].map((n,o)=>w.jsx("div",{className:`progress-bar ${o===r?"active":""}`,style:{backgroundColor:o===r?"white":"rgba(255,255,255,0.3)"},onClick:()=>t(o)},o))})),XD=({onPrevious:r,onNext:e,isFirstSlide:t,isLastSlide:n})=>w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:r,className:"nav-button prev",disabled:t,children:w.jsx(ei,{})}),w.jsx("button",{onClick:e,className:"nav-button next",disabled:n,children:w.jsx(mo,{})})]}),YD=({onFileUpload:r})=>w.jsx("div",{className:"empty-state",children:w.jsxs("label",{htmlFor:"file-upload",className:"file-upload-label",children:[w.jsx(g1,{size:48}),w.jsx("span",{children:"Add Images"}),w.jsx("input",{type:"file",id:"file-upload",accept:"image/*",multiple:!0,onChange:r,className:"hidden-input"})]})}),ZD=({isOpen:r,progress:e,message:t,onCancel:n})=>r?w.jsx("div",{className:"modal-overlay",children:w.jsxs("div",{className:"modal-content export-progress",children:[w.jsx("button",{className:"close-button",onClick:n,style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",color:"white",cursor:"pointer",zIndex:1e3},children:w.jsx(ur,{size:24})}),w.jsxs("div",{className:"loading-container",children:[w.jsx("h3",{className:"progress-title",children:t}),w.jsx("div",{className:"progress-bar-container",children:w.jsx("div",{className:"progress-bar-fill",style:{width:`${e||0}%`,transition:"width 0.3s ease-in-out"}})}),w.jsxs("div",{className:"progress-percentage",children:[Math.round(e||0),"%"]})]})]})}):null,JD=({isOpen:r,onClose:e})=>{const[t,n]=ne.useState(null),[o,a]=ne.useState(""),[l,u]=ne.useState(!0);ne.useEffect(()=>{r&&(async()=>{try{if(console.group("🔍 License Fetch Debugging"),console.log("Firestore DB:",rp),console.log("Modal Open:",r),!rp){console.error("❌ Firestore DB not initialized");return}const T=rR(rp,"content","license");console.log("📄 Document Reference:",T);try{const S=await mR(T);if(console.log("📋 Document Exists:",S.exists()),S.exists()){const C=S.data();console.log("📝 License Data:",C),C&&C.text?(console.log("✅ License Text Found"),a(C.text)):(console.warn("❗ No text field in license document"),a("No license text found."))}else console.warn("❌ No such document in Firestore"),a("License document does not exist.")}catch(S){if(console.error("❌ Snapshot Error:",S),S.code==="unavailable"){console.log("🌐 Offline mode: Attempting to use cached data");const C=await getDocFromCache(T);if(C.exists()){const D=C.data();a(D.text||"Cached license text")}else a("License unavailable offline")}else a(`Error loading license: ${S.message}`)}}catch(T){console.error("❌ Detailed Firebase Error:",T),a(`Error loading license: ${T.message}`)}finally{console.groupEnd(),u(!1)}})()},[r]);const d=v=>{n(v)},p=()=>{n(null)},g=()=>{switch(t){case"credits":return w.jsxs("div",{className:"section-content",children:[w.jsxs("header",{className:"section-header",children:[w.jsx("button",{className:"back-button",onClick:p,children:w.jsx(ei,{size:24})}),w.jsx("h2",{children:"Credits"})]}),w.jsx("div",{className:"section-body",children:w.jsxs("div",{className:"credits-content",children:[w.jsxs("div",{className:"developer-profile",children:[w.jsx("div",{className:"developer-avatar",children:w.jsx(a1,{size:64})}),w.jsx("h3",{children:"Ben Hayes"}),w.jsx("p",{className:"developer-title",children:"Creator & Developer"})]}),w.jsxs("div",{className:"company-info",children:[w.jsx("h4",{children:"Hayzer Apps"}),w.jsx("p",{children:"Groove Slider was designed, developed, and maintained by Ben Hayes as the sole developer."})]}),w.jsxs("div",{className:"developer-note",children:[w.jsx("p",{children:"From concept to implementation, every aspect of this app was crafted to provide an elegant way to create musical slideshows of your favorite moments."}),w.jsx("p",{children:"I hope you enjoy using Groove Slider as much as I enjoyed creating it."})]}),w.jsxs("div",{className:"contact-section",children:[w.jsx("h4",{children:"Connect"}),w.jsx("p",{children:"Have feedback or suggestions? I'd love to hear from you!"}),w.jsx("p",{children:"Email: contact@hayzerapps.com"})]})]})})]});case"feedback":return w.jsxs("div",{className:"section-content",children:[w.jsxs("header",{className:"section-header",children:[w.jsx("button",{className:"back-button",onClick:p,children:w.jsx(ei,{size:24})}),w.jsx("h2",{children:"Feedback"})]}),w.jsx("div",{className:"section-body",children:w.jsxs("div",{className:"feedback-form",children:[w.jsx("p",{children:"We'd love to hear your thoughts on Groove Slider!"}),w.jsx("textarea",{placeholder:"Share your feedback here...",className:"feedback-textarea",rows:6}),w.jsx("button",{className:"submit-button",children:"Submit Feedback"})]})})]});case"restore":return w.jsxs("div",{className:"section-content",children:[w.jsxs("header",{className:"section-header",children:[w.jsx("button",{className:"back-button",onClick:p,children:w.jsx(ei,{size:24})}),w.jsx("h2",{children:"Restore Purchase"})]}),w.jsxs("div",{className:"section-body",children:[w.jsx("p",{children:"Tap the button below to restore your previous purchases."}),w.jsx("button",{className:"restore-button",children:"Restore Purchases"})]})]});case"unsubscribe":return w.jsxs("div",{className:"section-content",children:[w.jsxs("header",{className:"section-header",children:[w.jsx("button",{className:"back-button",onClick:p,children:w.jsx(ei,{size:24})}),w.jsx("h2",{children:"How to Unsubscribe"})]}),w.jsx("div",{className:"section-body",children:w.jsxs("div",{className:"unsubscribe-info",children:[w.jsx("p",{children:"For information on how to manage or cancel your subscription, please visit Google's official support page:"}),w.jsx("button",{className:"external-link-button",onClick:()=>window.open("https://support.google.com/googleplay/answer/7018481?hl=en&co=GENIE.Platform%3DAndroid","_blank"),children:"Google Play Subscription Help"})]})})]});case"privacy":return w.jsxs("div",{className:"section-content",children:[w.jsxs("header",{className:"section-header",children:[w.jsx("button",{className:"back-button",onClick:p,children:w.jsx(ei,{size:24})}),w.jsx("h2",{children:"Privacy Policy"})]}),w.jsx("div",{className:"section-body",children:w.jsxs("div",{className:"privacy-content",children:[w.jsx("h3",{children:"Privacy Policy for Groove Slider"}),w.jsx("p",{children:"Last Updated: March 2, 2025"}),w.jsx("h4",{children:"Introduction"}),w.jsx("p",{children:"Welcome to Groove Slider. We respect your privacy and are committed to protecting your personal data. This privacy policy will inform you about how we handle your data when you use our application and tell you about your privacy rights."}),w.jsx("h4",{children:"What Data We Collect"}),w.jsx("p",{children:"Groove Slider requires access to the following on your device:"}),w.jsxs("ul",{children:[w.jsx("li",{children:"Image files (photos, pictures) that you select to include in your slideshows"}),w.jsx("li",{children:"Audio files (music, sounds) that you select to add to your slideshows"})]}),w.jsx("h4",{children:"How We Use Your Data"}),w.jsx("p",{children:"We use your data for the following purposes:"}),w.jsxs("ul",{children:[w.jsx("li",{children:"To create slideshows with your selected images"}),w.jsx("li",{children:"To add your selected music to your slideshows"}),w.jsx("li",{children:"To export these slideshows as MP4 video files to your device"})]}),w.jsx("h4",{children:"Data Processing"}),w.jsx("p",{children:"All data processing happens locally on your device. Your images and music:"}),w.jsxs("ul",{children:[w.jsx("li",{children:"Are not uploaded to our servers"}),w.jsx("li",{children:"Are not shared with third parties"}),w.jsx("li",{children:"Are only accessed when you explicitly grant permission"}),w.jsx("li",{children:"Are only used for the purpose of creating and exporting your slideshows"})]}),w.jsx("h4",{children:"Storage"}),w.jsx("p",{children:"The app stores:"}),w.jsxs("ul",{children:[w.jsx("li",{children:"Temporary copies of your selected images and music while processing"}),w.jsx("li",{children:"Your slideshow settings and preferences"}),w.jsx("li",{children:"Completed MP4 video files that are saved to your device storage"})]}),w.jsx("h4",{children:"Third-Party Services"}),w.jsx("p",{children:"Our app does not integrate with third-party analytics or advertising services."}),w.jsx("h4",{children:"Your Rights"}),w.jsx("p",{children:"You have the right to:"}),w.jsxs("ul",{children:[w.jsx("li",{children:"Delete your saved slideshows and preferences by uninstalling the app"}),w.jsx("li",{children:"Control what files you share with the app through your device permissions"})]}),w.jsx("h4",{children:"Children's Privacy"}),w.jsx("p",{children:"Our service is not directed to anyone under the age of 13. We do not knowingly collect personal information from children."}),w.jsx("h4",{children:"Changes to This Privacy Policy"}),w.jsx("p",{children:'We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date.'}),w.jsx("h4",{children:"Contact Us"}),w.jsx("p",{children:"If you have any questions about this Privacy Policy, please contact us at: contact@grooveslider.app"})]})})]});case"license":return w.jsxs("div",{className:"section-content",children:[w.jsxs("header",{className:"section-header",children:[w.jsx("button",{className:"back-button",onClick:p,children:w.jsx(ei,{size:24})}),w.jsx("h2",{children:"License Agreement"})]}),w.jsx("div",{className:"section-body",children:w.jsx("div",{className:"license-content",children:l?w.jsx("p",{children:"Loading license..."}):w.jsxs(w.Fragment,{children:[w.jsx("h3",{children:"End User License Agreement"}),w.jsx("p",{children:"Last Updated: March 2, 2025"}),w.jsx("div",{className:"license-text",children:o||"No license text available."})]})})})]});default:return null}};return w.jsx("div",{className:"modal-overlay",children:w.jsx("div",{className:"info-modal",children:t?g():w.jsxs(w.Fragment,{children:[w.jsxs("header",{className:"info-header",children:[w.jsx("h2",{children:"Settings"}),w.jsx("button",{className:"close-button",onClick:e,children:w.jsx(ur,{size:24})})]}),w.jsxs("div",{className:"info-content",children:[w.jsxs("div",{className:"pro-banner",children:[w.jsxs("div",{className:"pro-text",children:[w.jsxs("h3",{children:["Groove Slider ",w.jsx("span",{className:"pro-badge",children:"Pro"})]}),w.jsx("p",{children:"Unlock All Features"})]}),w.jsx("div",{className:"pro-image",children:w.jsx("div",{style:{width:80,height:80,background:"rgba(255,255,255,0.2)",borderRadius:"8px"}})})]}),w.jsxs("div",{className:"info-item-group",children:[w.jsxs("div",{className:"info-item",onClick:()=>d("credits"),children:[w.jsx(C1,{className:"info-icon"}),w.jsxs("div",{className:"info-text",children:[w.jsx("h4",{children:"Credits"}),w.jsx("p",{children:"About"})]}),w.jsx(mo,{})]}),w.jsxs("div",{className:"info-item",onClick:()=>d("feedback"),children:[w.jsx(j1,{className:"info-icon"}),w.jsx("div",{className:"info-text",children:w.jsx("h4",{children:"Feedback"})}),w.jsx(mo,{})]}),w.jsxs("div",{className:"info-item",onClick:()=>d("restore"),children:[w.jsx(Z1,{className:"info-icon"}),w.jsx("div",{className:"info-text",children:w.jsx("h4",{children:"Restore Purchase"})}),w.jsx(mo,{})]})]}),w.jsxs("div",{className:"info-item-group",children:[w.jsxs("div",{className:"info-item",onClick:()=>d("unsubscribe"),children:[w.jsx(v1,{className:"info-icon"}),w.jsx("div",{className:"info-text",children:w.jsx("h4",{children:"How to unsubscribe"})}),w.jsx(mo,{})]}),w.jsxs("div",{className:"info-item",onClick:()=>d("privacy"),children:[w.jsx(O1,{className:"info-icon"}),w.jsx("div",{className:"info-text",children:w.jsx("h4",{children:"Privacy Policy"})}),w.jsx(mo,{})]}),w.jsxs("div",{className:"info-item",onClick:()=>d("license"),children:[w.jsx(T1,{className:"info-icon"}),w.jsx("div",{className:"info-text",children:w.jsx("h4",{children:"License"})}),w.jsx(mo,{})]}),w.jsxs("div",{className:"info-item",children:[w.jsx(S1,{className:"info-icon"}),w.jsxs("div",{className:"info-text",children:[w.jsx("h4",{children:"Version"}),w.jsx("p",{children:"Version 0.9.0 (Beta)"})]})]})]})]})]})})})},eV=({isVisible:r,onClose:e})=>r?w.jsx("div",{className:"share-notification",children:w.jsxs("div",{className:"share-content",children:[w.jsx("h3",{children:"Export Complete! 🎉"}),w.jsx("p",{children:"Share your creation:"}),w.jsxs("div",{className:"share-buttons",children:[w.jsx("button",{onClick:()=>window.open("https://instagram.com","_blank"),className:"share-button instagram",children:"Share to Instagram"}),w.jsx("button",{onClick:()=>window.open("https://tiktok.com","_blank"),className:"share-button tiktok",children:"Share to TikTok"})]}),w.jsx("button",{onClick:e,className:"close-notification",children:w.jsx(ur,{size:20})})]})}):null,LT=({stories:r,onClose:e,onReorder:t,onDelete:n,saveStateOnEditPanelToggle:o})=>{const[a,l]=ne.useState("view"),[u,d]=ne.useState([]),[p,g]=ne.useState([]),[v,T]=ne.useState([]);ne.useEffect(()=>{a==="reorder"?(g([...r]),d([])):a==="delete"&&T([])},[a,r]);const S=()=>{l("reorder")},C=()=>{l("delete")},D=()=>{l("view")},V=O=>{if(a!=="reorder")return;const B=u.indexOf(O);if(B!==-1){const A=[...u];A.splice(B,1),d(A)}else d([...u,O]);console.log("Updated selection:",{selectedIndices:[...u,O].join(", "),index:O})},q=O=>{if(a!=="delete")return;const B=v.includes(O);T(B?v.filter(A=>A!==O):[...v,O])},L=()=>{if(u.length===0){l("view");return}let O=[];for(let B=0;B<u.length;B++){const A=u[B];O.push(r[A])}for(let B=0;B<r.length;B++)u.includes(B)||O.push(r[B]);console.log("Reordering stories:",{originalOrder:r.map(B=>B.url),newOrder:O.map(B=>B.url),selectedIndices:u}),t(O),d([]),l("view")},U=()=>{if(v.length===0){l("view");return}const O=[...v].sort((A,I)=>I-A);let B=[...r];for(const A of O)B.splice(A,1);t(B),l("view"),T([])},X=()=>{a==="reorder"?d([]):a==="delete"&&T([]),l("view")};return w.jsxs("div",{className:"edit-panel",children:[e&&w.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:1e4},children:w.jsx("button",{onClick:e,style:{background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:w.jsx(ur,{size:24})})}),w.jsx("div",{className:"edit-panel-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 15px",backgroundColor:"#1a1a1a",borderBottom:"1px solid rgba(255,255,255,0.1)",marginTop:"40px"},children:a==="view"?w.jsxs(w.Fragment,{children:[w.jsx("h3",{style:{margin:0},children:"Edit Photos"}),w.jsxs("div",{style:{display:"flex",gap:"15px"},children:[w.jsxs("button",{className:"mode-button",onClick:S,style:{background:"none",border:"none",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px",padding:"5px 10px",borderRadius:"5px",transition:"background-color 0.2s"},onMouseOver:O=>O.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",onMouseOut:O=>O.currentTarget.style.backgroundColor="transparent",children:[w.jsx(eS,{size:18}),w.jsx("span",{children:"Reorder"})]}),w.jsxs("button",{className:"mode-button",onClick:C,style:{background:"none",border:"none",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px",padding:"5px 10px",borderRadius:"5px",transition:"background-color 0.2s"},onMouseOver:O=>O.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",onMouseOut:O=>O.currentTarget.style.backgroundColor="transparent",children:[w.jsx(E0,{size:18}),w.jsx("span",{children:"Delete"})]})]})]}):a==="reorder"?w.jsxs(w.Fragment,{children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[w.jsx("button",{onClick:D,style:{background:"none",border:"none",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"30px",height:"30px",borderRadius:"50%"},onMouseOver:O=>O.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",onMouseOut:O=>O.currentTarget.style.backgroundColor="transparent",children:w.jsx(ur,{size:20})}),w.jsx("h3",{style:{margin:0},children:"Reorder Photos"})]}),w.jsxs("div",{style:{display:"flex",gap:"10px"},children:[w.jsx("button",{onClick:X,style:{background:"none",border:"1px solid rgba(255,255,255,0.3)",color:"white",cursor:"pointer",padding:"5px 15px",borderRadius:"5px"},children:"Cancel"}),w.jsx("button",{onClick:L,style:{backgroundColor:"#6c0d9c",border:"none",color:"white",cursor:"pointer",padding:"5px 15px",borderRadius:"5px",opacity:u.length>0?1:.5},disabled:u.length===0,children:"Apply"})]})]}):a==="delete"?w.jsxs(w.Fragment,{children:[w.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[w.jsx("button",{onClick:D,style:{background:"none",border:"none",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"30px",height:"30px",borderRadius:"50%"},onMouseOver:O=>O.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",onMouseOut:O=>O.currentTarget.style.backgroundColor="transparent",children:w.jsx(ur,{size:20})}),w.jsx("h3",{style:{margin:0},children:v.length===0?"Select Photos to Delete":`${v.length} Selected`})]}),w.jsxs("div",{style:{display:"flex",gap:"10px"},children:[w.jsx("button",{onClick:X,style:{background:"none",border:"1px solid rgba(255,255,255,0.3)",color:"white",cursor:"pointer",padding:"5px 15px",borderRadius:"5px"},children:"Cancel"}),w.jsx("button",{onClick:U,style:{backgroundColor:"#e74c3c",border:"none",color:"white",cursor:"pointer",padding:"5px 15px",borderRadius:"5px",opacity:v.length>0?1:.5},disabled:v.length===0,children:"Delete"})]})]}):null}),a==="reorder"&&w.jsx("div",{style:{padding:"10px 15px",backgroundColor:"rgba(108, 13, 156, 0.2)",borderBottom:"1px solid rgba(255,255,255,0.1)",fontSize:"14px",textAlign:"center"},children:"Select photos in the order you want them to appear"}),a==="delete"&&w.jsx("div",{style:{padding:"10px 15px",backgroundColor:"rgba(231, 76, 60, 0.2)",borderBottom:"1px solid rgba(255,255,255,0.1)",fontSize:"14px",textAlign:"center"},children:"Select photos you want to delete"}),w.jsx("div",{className:"thumbnails-container",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"10px",padding:"15px",overflowY:"auto",maxHeight:"70vh",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:r.map((O,B)=>{const A=u.includes(B),I=A?u.indexOf(B)+1:null;return w.jsx("div",{onClick:()=>{a==="reorder"?V(B):a==="delete"&&q(B)},style:{position:"relative",cursor:"pointer",borderRadius:"8px",overflow:"hidden",border:A?"2px solid #6c0d9c":"2px solid transparent",transition:"transform 0.2s, box-shadow 0.2s, border 0.2s",aspectRatio:"1/1",width:"100%",height:"100%",padding:"2px",backgroundColor:"white"},children:w.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},children:[w.jsx("img",{src:O.thumbnailData||O.url,alt:`Slide ${B+1}`,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"6px"}}),a==="reorder"&&w.jsx("div",{style:{position:"absolute",top:"5px",right:"5px",width:"25px",height:"25px",borderRadius:"50%",backgroundColor:A?"#6c0d9c":"rgba(255,255,255,0.5)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"14px",border:"1px solid white"},children:A?I:""}),a==="delete"&&v.includes(B)&&w.jsx("div",{style:{position:"absolute",top:"5px",right:"5px",width:"25px",height:"25px",borderRadius:"50%",backgroundColor:"#e74c3c",display:"flex",alignItems:"center",justifyContent:"center",color:"white",border:"1px solid white"},children:w.jsx(v0,{size:16})})]})},B)})})]})},tV=({onFileUpload:r,onSaveSession:e,onExportSession:t,onPlayPause:n,isPlaying:o,duration:a,onDurationChange:l,onEdit:u,onMusicUpload:d,onBPMChange:p,musicUrl:g,bpm:v,onStartPointChange:T,musicStartPoint:S,audioRef:C,isLoopingEnabled:D,setIsLoopingEnabled:V,showEditPanel:q,setShowEditPanel:L,stories:U,setStories:X,handleDelete:O,handleReorder:B,saveStateOnEditPanelToggle:A})=>{const[I,N]=ne.useState(!1),[P,b]=ne.useState(!1),[M,R]=ne.useState(1);ne.useEffect(()=>{const ee=[.125,.25,.5,1,2,4].find(K=>Math.abs(a*v/(4*60)-K)<.01);R(ee||1)},[a,v]);const ue=(Z,ee)=>Z*4*60/ee,ye=()=>{N(!I),P&&b(!1),q&&L(!1)},pe=()=>{b(!P),I&&N(!1),q&&L(!1)},ce=()=>{const Z=!q;L(Z),I&&N(!1),P&&b(!1),A(Z)};return w.jsxs("div",{className:"bottom-menu w-full flex flex-col items-stretch",children:[I&&w.jsxs("div",{className:"duration-panel",children:[w.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:1e4},children:w.jsx("button",{onClick:()=>N(!1),style:{background:"rgba(0,0,0,0.7)",color:"white",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:w.jsx(ur,{size:24})})}),w.jsxs("div",{className:"duration-controls",children:[w.jsx("h3",{children:"Bar-Based Slide Transitions"}),w.jsx("div",{className:"bar-options",children:[{value:.125,label:"⅛ Bar"},{value:.25,label:"¼ Bar"},{value:.5,label:"½ Bar"},{value:1,label:"1 Bar"},{value:2,label:"2 Bars"},{value:4,label:"4 Bars"}].map(Z=>w.jsx("button",{className:`bar-option ${M===Z.value?"selected":""}`,onClick:()=>{o&&n();const ee=ue(Z.value,v);R(Z.value),l(ee)},children:Z.label},Z.value))}),w.jsxs("div",{className:"duration-info",children:[w.jsx("span",{children:"Slide Change Speed:"}),w.jsxs("span",{className:"time-info",children:[a.toFixed(2),"s /",v," BPM"]})]})]})]}),P&&w.jsx(KD,{audioRef:C,onUpload:d,onBPMChange:p,currentBPM:v,onStartPointChange:T,musicStartPoint:S,musicUrl:g,onClose:()=>b(!1)}),q&&w.jsx(LT,{stories:U,onClose:()=>{L(!1),A(!1)},onReorder:B,onDelete:O}),w.jsxs("div",{className:"bottom-menu-buttons",children:[w.jsxs("button",{className:`bottom-menu-button ${D?"active":""}`,onClick:()=>V(!D),"data-loop":"true",children:[w.jsx(H1,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:"Loop"})]}),w.jsxs("button",{className:`bottom-menu-button ${I?"active":""}`,onClick:ye,children:[w.jsx(_0,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:"Speed"})]}),w.jsxs("button",{className:`bottom-menu-button ${P?"active":""}`,onClick:pe,children:[w.jsx(ih,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:"Music"})]}),w.jsxs("button",{className:`bottom-menu-button ${o?"active":""}`,onClick:n,children:[o?w.jsx(Hp,{className:"bottom-menu-icon"}):w.jsx(Kp,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:o?"Pause":"Play"})]}),w.jsxs("div",{className:"bottom-menu-right-group",children:[w.jsxs("button",{className:`bottom-menu-button ${q?"active":""}`,onClick:ce,children:[w.jsx(nS,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:"Edit"})]}),w.jsxs("label",{className:"bottom-menu-button",children:[w.jsx(N1,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:"Add"}),w.jsx("input",{type:"file",id:"file-upload-bottom",accept:"image/*",multiple:!0,onChange:r,className:"hidden-input"})]}),w.jsxs("button",{className:"bottom-menu-button",onClick:e,children:[w.jsx(w0,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:"Save"})]}),w.jsxs("button",{className:"bottom-menu-button",onClick:t,children:[w.jsx(Gp,{className:"bottom-menu-icon"}),w.jsx("span",{className:"bottom-menu-text",children:"Export"})]})]})]})]})},qp=(r,e={})=>{const{maxWidth:t=1080,maxHeight:n=1920,fit:o="cover",format:a="jpeg",quality:l=.9}=e;return new Promise((u,d)=>{const p=new Image,g=r instanceof Blob?URL.createObjectURL(r):null;p.onload=()=>{let v,T;const S=p.width/p.height,C=t/n;o==="cover"?S>C?(T=n,v=T*S):(v=t,T=v/S):S>C?(v=t,T=v/S):(T=n,v=T*S);const D=document.createElement("canvas");D.width=o==="cover"?t:v,D.height=o==="cover"?n:T;const V=D.getContext("2d");let q=0,L=0;o==="cover"&&(q=(t-v)/2,L=(n-T)/2),V.drawImage(p,q,L,v,T);const U=D.toDataURL(`image/${a}`,l);g&&URL.revokeObjectURL(g),u({dataUrl:U,width:D.width,height:D.height})},p.onerror=v=>{g&&URL.revokeObjectURL(g),d(new Error("Failed to load image"))},p.src=g||r})},nV=r=>qp(r,{maxWidth:150,maxHeight:150,fit:"cover",quality:.8}).then(e=>e.dataUrl),rV=()=>{const[r,e]=ne.useState(!0),[t,n]=ne.useState(0),[o,a]=ne.useState([]),[l,u]=ne.useState(!1),[d,p]=ne.useState(2),[g,v]=ne.useState(!1),[T,S]=ne.useState(!1),[C,D]=ne.useState(!1),[V,q]=ne.useState(null),[L,U]=ne.useState(!1),[X,O]=ne.useState(!1),[B,A]=ne.useState(!1),[I,N]=ne.useState("contain"),[P,b]=ne.useState(!1),[M,R]=ne.useState(!1),[ue,ye]=ne.useState(null),[pe,ce]=ne.useState(""),[Z,ee]=ne.useState(!1),[K,j]=ne.useState(null),[Q,ve]=ne.useState(120),[De,ge]=ne.useState(0),[Fe,Le]=ne.useState(!1),[fe,Xe]=ne.useState({}),[dt,Wt]=ne.useState(null),[bn,_n]=ne.useState(null),re=ne.useRef(new Audio),se=ne.useRef(null),we=ne.useRef(!1),[Ie,Be]=ne.useState(!1),$e=()=>{window.confirm("Are you sure you want to cancel the export? The process will stop immediately.")&&(we.current=!0,R(!1),ee(!1),b(!1),alert("Export has been canceled."))},nt=()=>{l&&(Kt(),u(!1)),re.current&&re.current.pause()},ot=async Te=>{try{await $n(`auto_save_edit_panel_${Date.now()}`,!0),console.log(`Session saved on edit panel ${Te?"open":"close"}`)}catch(Ne){console.error("Error saving state on edit panel toggle:",Ne)}},Mt=()=>{o.length>0?window.confirm("Start a new project? Any unsaved changes will be lost.")&&(Dn(),e(!1)):e(!1)},Dn=()=>{a([]),n(0),j(null),re.current&&(re.current.pause(),re.current.src=""),u(!1),ve(120),ge(0),p(2),Le(!1)},Gt=Te=>new Promise((Ne,Ue)=>{const Ze=new Image;Ze.onload=()=>Ne(Te),Ze.onerror=Ue,Ze.src=Te});ne.useEffect(()=>{window.currentImageFitMode=I},[I]),ne.useEffect(()=>{const Te=async()=>{const Ne=[t-1,t,t+1].filter(Ue=>Ue>=0&&Ue<o.length);for(const Ue of Ne)if(!fe[o[Ue].url])try{await Gt(o[Ue].url),Xe(Ze=>({...Ze,[o[Ue].url]:!0}))}catch(Ze){console.error("Failed to preload image:",Ze)}};o.length>0&&Te()},[t,o]),ne.useEffect(()=>{p0().catch(console.error)},[]);const Ht=async Te=>{console.log("File Upload Started",{musicUrlPresent:!!K,currentStoriesCount:o.length,isCurrentlyPlaying:l});const Ne=l;l&&(console.log("Pausing playback before adding images to prevent rendering issues"),Kt(),re.current&&re.current.pause(),u(!1));const Ue=Array.from(Te.target.files).filter(At=>At.type.startsWith("image/"));if(Ue.length===0){alert("Please select image files only.");return}const pt=25-o.length;if(pt<=0){alert("Maximum limit of 25 photos reached. Please remove some photos before adding more.");return}let ct;Ue.length>pt?(alert(`Only ${pt} photos can be added. Maximum limit of 25 photos reached.`),ct=Ue.slice(0,pt)):ct=Ue,Ue.length>3&&(ee(!0),ce("Processing images..."),ye(0));const tn="1920x1080",[ut,kr]=tn.split("x").map(Number),Qt=[];for(let At=0;At<ct.length;At++){const nn=ct[At];ce(`Processing image ${At+1}/${ct.length}`);try{ct.length>3&&(ye(At/ct.length*100),ce(`Processing image ${At+1} of ${ct.length}...`));const mr=await qp(nn,{maxWidth:1080,maxHeight:1920,fit:"contain",quality:.9}),En=await qp(nn,{maxWidth:1080,maxHeight:1920,fit:"contain",quality:.9}),We=await nV(nn),Tt=await fetch(mr.dataUrl).then(Qr=>Qr.blob()),zt=URL.createObjectURL(Tt);Qt.push({type:"image",url:zt,originalName:nn.name,exportData:En.dataUrl,thumbnailData:We,dateAdded:new Date().toISOString()})}catch(mr){console.error(`Error processing image ${nn.name}:`,mr)}}if(a(At=>{const nn=[...At,...Qt];return console.log("Stories Update",{prevStoriesCount:At.length,newStoriesCount:Qt.length,totalStoriesCount:nn.length}),nn}),Ue.length>3&&ee(!1),n(0),Te.target.value="",Qt.length>0)try{await $n("auto_save_"+Date.now(),!0),console.log(`Auto-save completed with ${Qt.length} total new images`)}catch(At){console.error("Auto-save failed:",At)}Ne&&K&&(console.log("Resuming playback after adding images"),setTimeout(()=>{it()},500))},Ye=Te=>{const Ne=Te.split(";base64,"),Ue=Ne[0].split(":")[1],Ze=window.atob(Ne[1]),pt=Ze.length,ct=new Uint8Array(pt);for(let tn=0;tn<pt;++tn)ct[tn]=Ze.charCodeAt(tn);return new Blob([ct],{type:Ue})},ft=Te=>{j(Te),ge(0),re.current&&(re.current.src=Te,re.current.currentTime=0)},Vn=Te=>{ve(Te);const Ze=([.125,.25,.5,1,2,4].find(pt=>Math.abs(d*Te/(4*60)-pt)<.01)||1)*4*60/Te;p(Ze)},ps=()=>{se.current!==null&&(clearInterval(se.current),console.log("Cleared existing interval before starting new one")),console.log("Starting auto rotation with duration:",d*1e3,"ms"),se.current=setInterval(()=>{n(Te=>!Fe&&Te>=o.length-1?(Kt(),re.current&&re.current.pause(),Te):(Te+1)%o.length)},d*1e3)},Kt=()=>{console.log("Stopping auto rotation, current interval ref:",se.current),se.current!==null?(clearInterval(se.current),se.current=null,console.log("Interval cleared successfully")):console.warn("No interval to clear - this might indicate a syncing issue"),u(!1)},it=async()=>{if(l)Kt(),re.current&&re.current.pause(),u(!1);else{t>=o.length-1&&n(0);try{if(K&&re.current){re.current.src!==K&&(re.current.src=K),re.current.currentTime=De;try{await re.current.play()}catch(Te){console.error("Play error:",Te),alert("Unable to play audio. The slideshow will continue without music.")}}ps(),u(!0)}catch(Te){console.error("Playback error:",Te),alert("Unable to start slideshow. Please try again.")}}};ne.useEffect(()=>{console.log("Stories State Changed",{storiesCount:o.length,currentIndex:t,musicUrlPresent:!!K})},[o,t,K]),ne.useEffect(()=>{const Te=window.setTimeout,Ne=window.setInterval;let Ue=0,Ze=0;return window.setTimeout=function(...pt){return Ue++,console.log(`setTimeout #${Ue} called with delay ${pt[1]}ms`),Te.apply(this,pt)},window.setInterval=function(...pt){return Ze++,console.log(`setInterval #${Ze} called with delay ${pt[1]}ms`),Ne.apply(this,pt)},()=>{window.setTimeout=Te,window.setInterval=Ne,console.log(`Final counts: ${Ue} timeouts, ${Ze} intervals`)}},[]),ne.useEffect(()=>()=>Kt(),[]);const en=()=>{t<o.length-1&&n(t+1)},wn=()=>{t>0&&n(t-1)},Un=Te=>Wt(Te.touches[0].clientX),Hr=Te=>_n(Te.touches[0].clientX),ms=()=>{if(!dt||!bn)return;const Te=dt-bn,Ne=Te>50,Ue=Te<-50;Ne&&t<o.length-1&&en(),Ue&&t>0&&wn(),Wt(null),_n(null)},Kr=Te=>{l&&(Kt(),u(!1),re.current&&re.current.pause()),n(0),a(Te)},fr=Te=>{const Ne=o.filter((Ue,Ze)=>Ze!==Te);a(Ne),t>=Te&&n(Math.max(0,t-1))},pr=(Te,Ne,Ue)=>`scale=${Te}:${Ne}:force_original_aspect_ratio=1,pad=${Te}:${Ne}:(ow-iw)/2:(oh-ih)/2:black`,Rr=async Te=>{try{l&&(Kt(),re.current&&re.current.pause(),u(!1));const Ne=await c2(Te);a(Ne.stories),ve(Ne.bpm),p(Ne.duration),Le(Ne.isLoopingEnabled),n(Ne.currentIndex),N(Ne.imageFitMode||"cover"),Ne.musicUrl&&(j(Ne.musicUrl),ge(Ne.musicStartPoint),re.current&&(re.current.src=Ne.musicUrl,re.current.currentTime=Ne.musicStartPoint)),r&&e(!1),alert("Session loaded successfully!")}catch(Ne){console.error("Error loading session:",Ne),alert("Failed to load session: "+Ne.message)}},hn=async Te=>{const Ne={...Te,imageFitMode:I},{resolution:Ue="1080x1920",isExportLoopEnabled:Ze=!1,exportLoopDuration:pt=0}=Ne;try{let ct,tn=Te.fileName||"untitled.mp4";if("showSaveFilePicker"in window)ct=await window.showSaveFilePicker({suggestedName:tn,types:[{description:"MP4 Video",accept:{"video/mp4":[".mp4"]}}]});else{const We=document.createElement("a");We.download=tn,ct={createWritable:async()=>({write:async Tt=>{const zt=URL.createObjectURL(new Blob([Tt],{type:"video/mp4"}));We.href=zt,We.click(),URL.revokeObjectURL(zt)},close:async()=>{}})}}R(!0),ee(!0),ce("Preparing to export video..."),ye(0),yn.loaded||await p0();let ut=[];const kr=[],[Qt,At]=Ue.split("x").map(Number),nn=o.length*d,mr=Ze&&pt>0?Math.ceil(pt/nn):1;for(let We=0;We<o.length;We++){const Tt=o[We];ce(`Processing image ${We+1}/${o.length}`);let zt;try{if(Tt.exportData){const dn=Ye(Tt.exportData);zt=new Uint8Array(await dn.arrayBuffer())}else if(Tt.base64Data){const dn=Ye(Tt.base64Data);zt=new Uint8Array(await dn.arrayBuffer())}else zt=await Yy(Tt.url)}catch(dn){throw console.error(`Error fetching image ${We+1}:`,dn),new Error(`Failed to process image ${We+1}. Please check if all images are valid.`)}const Qr=`input_${We}.png`,Mn=`processed_${We}.mp4`;await yn.writeFile(Qr,zt),ut.push(Qr),console.log("Export settings:",Ne),console.log("Current image fit mode:",Ne.imageFitMode);const gs=pr(Qt,At,Ne.imageFitMode);await yn.exec(["-loop","1","-i",Qr,"-c:v","libx264","-t",`${d}`,"-pix_fmt","yuv420p","-vf",gs,"-r","30","-preset","ultrafast",Mn]),ut.push(Mn),kr.push({name:Mn}),ye((We+1)/o.length*60)}ce("Preparing video segments..."),ye(65);let En="";for(let We=0;We<mr;We++)for(let Tt=0;Tt<kr.length;Tt++)En+=`file '${kr[Tt].name}'
`;if(await yn.writeFile("loop_list.txt",En),ut.push("loop_list.txt"),ce("Creating final video..."),ye(70),await yn.exec(["-f","concat","-safe","0","-i","loop_list.txt","-c:v","copy","temp_output.mp4"]),ut.push("temp_output.mp4"),K){ce("Adding background music..."),ye(80);try{let We;try{if(We=await Yy(K),console.log("Music data fetched, size:",We.byteLength),!We||We.byteLength<1e3)throw new Error("Music file appears to be invalid or too small")}catch(Tt){throw console.error("Music fetch error:",Tt),new Error("Could not access music file")}await yn.writeFile("background.mp3",We),await yn.exec(["-i","temp_output.mp4","-ss",String(De),"-i","background.mp3","-shortest","-map","0:v","-map","1:a","-c:v","copy","-c:a","aac","-b:a","192k","final_output.mp4"]);try{await yn.deleteFile("background.mp3"),await yn.deleteFile("temp_output.mp4")}catch(Tt){console.warn("Non-critical cleanup error:",Tt)}}catch(We){console.error("Music processing failed:",We),ce("Music processing failed, creating video without audio..."),await yn.exec(["-i","temp_output.mp4","-c","copy","final_output.mp4"])}}else await yn.exec(["-i","temp_output.mp4","-c","copy","final_output.mp4"]);ce("Preparing download..."),ye(95);try{const We=await yn.readFile("final_output.mp4");ye(100);const Tt=await ct.createWritable();await Tt.write(new Blob([We.buffer],{type:"video/mp4"})),await Tt.close(),ee(!1),R(!1),b(!0);try{for(const zt of ut)await yn.deleteFile(zt);await yn.deleteFile("final_output.mp4")}catch(zt){console.warn("Final cleanup error (non-critical):",zt)}}catch(We){throw console.error("Final output error:",We),new Error(`Failed to save video: ${We.message}`)}}catch(ct){console.error("Export error:",ct),ee(!1),R(!1),alert(`Export failed: ${ct.message}`);try{for(const tn of tempFiles||[])await yn.deleteFile(tn).catch(()=>{})}catch{}}},$n=async(Te,Ne=!1)=>{try{console.log("Saving session to IndexedDB:",{sessionName:Te,storiesCount:o.length,hasBase64Data:o.map(Ze=>!!Ze.base64Data),firstImagePreview:o.length>0?o[0].base64Data?o[0].base64Data.substring(0,50)+"...":"Missing base64 data":"No images"}),Ne||(ee(!0),ce("Saving session..."),ye(10));const Ue={name:Te,stories:o,musicUrl:K,bpm:Q,musicStartPoint:De,imageFitMode:I,duration:d,isLoopingEnabled:Fe,currentIndex:t};Ne||ye(40),await l2(Ue),console.log(`Session "${Te}" saved successfully!`,{timestamp:new Date().toISOString(),imageCount:o.length}),Ne||(ye(100),ce("Session saved successfully!"),setTimeout(()=>{ee(!1),Te.startsWith("auto_save_")||alert("Session saved successfully!")},1e3))}catch(Ue){console.error("Error saving session to database:",Ue,{sessionName:Te,storiesCount:o.length}),Ne||(ee(!1),alert(`Failed to save session: ${Ue.message}`))}};return w.jsx(w.Fragment,{children:r?w.jsx(HD,{onCreateSlideshow:Mt,onLoadSession:Rr,onClose:()=>e(!1)}):w.jsx("div",{className:"app-container",children:w.jsx("div",{className:"app-content",children:w.jsxs("div",{className:"slider-container",children:[w.jsxs("div",{className:"title-bar",children:[w.jsx("h1",{className:"slider-title",children:"Groove Slider"}),w.jsx("div",{className:"photo-counter",children:w.jsxs("span",{className:o.length>=25?"max-reached":"",children:[o.length," / 25 ",w.jsx(k1,{size:25})]})}),w.jsx("button",{onClick:()=>e(!0),className:"projects-button",children:w.jsx(o1,{size:28})})]}),w.jsx("audio",{ref:re,src:K,loop:!0}),o.length===0?w.jsx(YD,{onFileUpload:Ht}):w.jsxs("div",{className:"story-container",onTouchStart:Un,onTouchMove:Hr,onTouchEnd:ms,children:[w.jsx("div",{className:"story-slide",children:w.jsx("div",{className:"media-wrapper",children:w.jsx("div",{className:"image-container",style:{position:"relative",width:"100%",height:"100%"},children:o[t]&&o[t].url?w.jsx("img",{src:o[t].url,alt:`Slide ${t+1}`,className:"media-content",style:{objectFit:I,width:"100%",height:"100%",display:"block"},loading:"eager",onError:Te=>{console.log("Image failed to load, attempting recovery");const Ne=o[t];if(Ne&&Ne.base64Data){const Ue=Ye(Ne.base64Data),Ze=URL.createObjectURL(Ue),pt=[...o];pt[t]={...Ne,url:Ze},a(pt),Te.target.src=Ze}}}):w.jsx("div",{className:"empty-image-placeholder",style:{backgroundColor:"#f5f5f5",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#333"},children:"Select an image to display"})})})}),w.jsx(XD,{onPrevious:wn,onNext:en,isFirstSlide:t===0,isLastSlide:t===o.length-1}),w.jsx(QD,{currentIndex:t,totalSlides:o.length,onProgressClick:Te=>{console.log("Current Index:",t),console.log("Clicked Index:",Te),console.log("Total Stories:",o.length),n(Te)}})]}),w.jsx(tV,{audioRef:re,onFileUpload:Ht,onSaveSession:()=>U(!0),onExportSession:()=>D(!0),onPlayPause:it,isPlaying:l,duration:d,onDurationChange:p,onEdit:()=>S(!T),onMusicUpload:ft,onBPMChange:Vn,musicUrl:K,bpm:Q,onStartPointChange:ge,musicStartPoint:De,onMusicPanelToggle:()=>setShowMusicPanel(!showMusicPanel),isLoopingEnabled:Fe,setIsLoopingEnabled:Le,showEditPanel:T,setShowEditPanel:S,stories:o,setStories:a,handleDelete:fr,handleReorder:Kr,saveStateOnEditPanelToggle:ot}),T&&w.jsx(LT,{stories:o,onClose:()=>{S(!1),ot(!1)},onReorder:Kr,onDelete:fr}),w.jsx(r2,{isOpen:C,onClose:()=>D(!1),onExport:hn,isExporting:M,progress:ue,message:pe,stories:o,duration:d,stopPlayback:nt,cancelExport:()=>{R(!1),D(!1)},currentImageFitMode:I}),w.jsx(s2,{isOpen:L,onClose:()=>U(!1),onSave:$n}),w.jsx(ZD,{isOpen:Z,progress:ue,message:pe,onCancel:$e}),w.jsx(eV,{isVisible:P,onClose:()=>b(!1)})]})})})})};function sV({installPrompt:r,onInstallClick:e}){return w.jsxs("div",{className:"app-container",children:[r&&w.jsx("button",{onClick:e,style:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,padding:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Install App"}),w.jsx(rV,{})]})}const oV="modulepreload",iV=function(r){return"/"+r},m0={},aV=function(e,t,n){let o=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(t.map(d=>{if(d=iV(d),d in m0)return;m0[d]=!0;const p=d.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":oV,p||(v.as="script"),v.crossOrigin="",v.href=d,u&&v.setAttribute("nonce",u),document.head.appendChild(v),p)return new Promise((T,S)=>{v.addEventListener("load",T),v.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return o.then(l=>{for(const u of l||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})};function lV(r={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:o,onRegisteredSW:a,onRegisterError:l}=r;let u,d;const p=async(v=!0)=>{await d};async function g(){if("serviceWorker"in navigator){if(u=await aV(async()=>{const{Workbox:v}=await import("./workbox-window.prod.es5.B9K5rw8f.js");return{Workbox:v}},[]).then(({Workbox:v})=>new v("/sw.js",{scope:"/",type:"classic"})).catch(v=>{l==null||l(v)}),!u)return;u.addEventListener("activated",v=>{(v.isUpdate||v.isExternal)&&window.location.reload()}),u.addEventListener("installed",v=>{v.isUpdate||n==null||n()}),u.register({immediate:e}).then(v=>{a?a("/sw.js",v):o==null||o(v)}).catch(v=>{l==null||l(v)})}}return d=g(),p}async function g0(){try{if("caches"in window){const r=await caches.open("groove-gallery-cache-v1"),e=["/ffmpeg/ffmpeg-core.js","/ffmpeg/ffmpeg-core.wasm"];(await Promise.all(e.map(async n=>!!await r.match(n)))).every(Boolean)?console.log("FFmpeg files already cached"):(console.log("Preloading FFmpeg files..."),await Promise.all(e.map(n=>fetch(n).then(o=>r.put(n,o)))),console.log("FFmpeg files preloaded successfully"))}}catch(r){console.error("Error preloading FFmpeg:",r)}}function cV(){const[r,e]=ne.useState(null),[t,n]=ne.useState(!1);ne.useEffect(()=>{lV({onNeedRefresh(){n(!0)},onOfflineReady(){console.log("App ready for offline use"),g0()}});const l=d=>{d.preventDefault(),e(d)},u=d=>{console.log("App was successfully installed")};return window.addEventListener("beforeinstallprompt",l),window.addEventListener("appinstalled",u),g0(),()=>{window.removeEventListener("beforeinstallprompt",l),window.removeEventListener("appinstalled",u)}},[]);const o=async()=>{if(r){r.prompt();const{outcome:l}=await r.userChoice;console.log(l==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),e(null)}},a=()=>{window.location.reload()};return w.jsx(ne.StrictMode,{children:w.jsx(sV,{installPrompt:r,onInstallClick:o,updateAvailable:t,onUpdateClick:a})})}ZI.createRoot(document.getElementById("root")).render(w.jsx(cV,{}));
